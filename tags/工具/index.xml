<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>工具 on 清水池塘</title><link>https://anlyjiang.github.io/tags/%E5%B7%A5%E5%85%B7/</link><description>Recent content in 工具 on 清水池塘</description><generator>Hugo -- 0.152.2</generator><language>zh-cn</language><lastBuildDate>Tue, 01 Jun 2021 10:26:00 +0000</lastBuildDate><atom:link href="https://anlyjiang.github.io/tags/%E5%B7%A5%E5%85%B7/index.xml" rel="self" type="application/rss+xml"/><item><title>简化Android库上传到Maven仓库的gradle配置</title><link>https://anlyjiang.github.io/posts/jian-hua-android-ku-shang-chuan-dao-maven-cang-ku-de-gradle-pei-zhi/</link><pubDate>Tue, 01 Jun 2021 10:26:00 +0000</pubDate><guid>https://anlyjiang.github.io/posts/jian-hua-android-ku-shang-chuan-dao-maven-cang-ku-de-gradle-pei-zhi/</guid><description>&lt;p&gt;配置 android 上传到 maven 中心仓库，发现配置的代码有点多，而且如果有多个库模块需要上传，则需要复制粘贴不少重复的配置代码，于是编写了一个 gradle 插件用于简化提取这个配置过程；&lt;/p&gt;
&lt;h2 id="插件用途及效果"&gt;插件用途及效果&lt;/h2&gt;
&lt;p&gt;本插件用于简化Android库上传到Maven中心仓库的配置，避免每个project的gradle中都放置一份重复较多的配置；&lt;/p&gt;
&lt;p&gt;插件有如下功能：&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;简化 maven-publish 插件的配置流程；&lt;/li&gt;
&lt;li&gt;添加上传到Maven中心仓库的 publish 任务；&lt;/li&gt;
&lt;li&gt;支持配置上传时是否包含 javadoc 及源码；&lt;/li&gt;
&lt;/ol&gt;
&lt;h3 id="直接使用maven-publish插件的配置"&gt;直接使用maven-publish插件的配置：&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-kotlin" data-lang="kotlin"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;import&lt;/span&gt; org.gradle.api.publish.maven.MavenPom
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;plugins {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id(&lt;span style="color:#e6db74"&gt;&amp;#34;com.android.library&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id(&lt;span style="color:#e6db74"&gt;&amp;#34;signing&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;`&lt;/span&gt;maven-publish&lt;span style="color:#960050;background-color:#1e0010"&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;android {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; defaultConfig {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; versionName(&lt;span style="color:#e6db74"&gt;&amp;#34;1.0.0-SNAPSHOT&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;dependencies {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;//
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tasks.register(&lt;span style="color:#e6db74"&gt;&amp;#34;javadoc&amp;#34;&lt;/span&gt;, Javadoc&lt;span style="color:#f92672"&gt;::&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt;.java) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; group = &lt;span style="color:#e6db74"&gt;&amp;#34;publishing&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; dependsOn(&lt;span style="color:#e6db74"&gt;&amp;#34;assemble&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; source = android.sourceSets[&lt;span style="color:#e6db74"&gt;&amp;#34;main&amp;#34;&lt;/span&gt;].java.getSourceFiles()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; classpath &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; project.files(android.bootClasspath + &lt;span style="color:#a6e22e"&gt;File&lt;/span&gt;.pathSeparator)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (&lt;span style="color:#a6e22e"&gt;JavaVersion&lt;/span&gt;.current().isJava9Compatible) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; (options &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; StandardJavadocDocletOptions).addBooleanOption(&lt;span style="color:#e6db74"&gt;&amp;#34;html5&amp;#34;&lt;/span&gt;, &lt;span style="color:#66d9ef"&gt;true&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; android.libraryVariants.forEach { libraryVariant &lt;span style="color:#f92672"&gt;-&amp;gt;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; classpath &lt;span style="color:#f92672"&gt;+=&lt;/span&gt; libraryVariant.javaCompileProvider.&lt;span style="color:#66d9ef"&gt;get&lt;/span&gt;().classpath
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; options.apply {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; encoding(&lt;span style="color:#e6db74"&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; charset(&lt;span style="color:#e6db74"&gt;&amp;#34;UTF-8&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; isFailOnError = &lt;span style="color:#66d9ef"&gt;false&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; (&lt;span style="color:#66d9ef"&gt;this&lt;/span&gt; &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; StandardJavadocDocletOptions).apply {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;// addStringOption(&amp;#34;Xdoclint:none&amp;#34;)
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; links&lt;span style="color:#f92672"&gt;?.&lt;/span&gt;add(&lt;span style="color:#e6db74"&gt;&amp;#34;https://developer.android.google.cn/reference/&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; links&lt;span style="color:#f92672"&gt;?.&lt;/span&gt;add(&lt;span style="color:#e6db74"&gt;&amp;#34;http://docs.oracle.com/javase/8/docs/api/&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tasks.register(&lt;span style="color:#e6db74"&gt;&amp;#34;jarSource&amp;#34;&lt;/span&gt;, Jar&lt;span style="color:#f92672"&gt;::&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt;.java) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; group = &lt;span style="color:#e6db74"&gt;&amp;#34;publishing&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; from(android.sourceSets[&lt;span style="color:#e6db74"&gt;&amp;#34;main&amp;#34;&lt;/span&gt;].java.srcDirs)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; archiveClassifier.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;sources&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;tasks.register(&lt;span style="color:#e6db74"&gt;&amp;#34;jarJavadoc&amp;#34;&lt;/span&gt;, Jar&lt;span style="color:#f92672"&gt;::&lt;/span&gt;&lt;span style="color:#66d9ef"&gt;class&lt;/span&gt;.java) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; group = &lt;span style="color:#e6db74"&gt;&amp;#34;publishing&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; dependsOn(&lt;span style="color:#e6db74"&gt;&amp;#34;javadoc&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;val&lt;/span&gt; javadoc: Javadoc = tasks.getByName(&lt;span style="color:#e6db74"&gt;&amp;#34;javadoc&amp;#34;&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; Javadoc
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; from(javadoc.destinationDir)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; archiveClassifier.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;javadoc&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;fun&lt;/span&gt; &lt;span style="color:#a6e22e"&gt;getMyPom&lt;/span&gt;(): Action&amp;lt;&lt;span style="color:#66d9ef"&gt;in&lt;/span&gt; MavenPom&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;return&lt;/span&gt; Action&amp;lt;MavenPom&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Android Common Utils Lib&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; description.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Android Common Utils Library For HJ&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;https://github.com/hanlyjiang/lib_common_utils&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; licenses {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; license {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;The Apache License, Version 2.0&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;http://www.apache.org/licenses/LICENSE-2.0.txt&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; developers {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; developer {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;hanlyjiang&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Hanly Jiang&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; email.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;hanlyjiang@outlook.com&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; scm {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; connection.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;scm:git:git://github.com/hanlyjiang/lib_common_utils.git&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; developerConnection.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;scm:git:ssh://github.com/hanlyjiang/lib_common_utils.git&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;https://github.com/hanlyjiang/lib_common_utils&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;afterEvaluate {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; publishing {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; publications {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; create&amp;lt;MavenPublication&amp;gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;release&amp;#34;&lt;/span&gt;) {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; from(components.getByName(&lt;span style="color:#e6db74"&gt;&amp;#34;release&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; groupId = &lt;span style="color:#e6db74"&gt;&amp;#34;com.github.hanlyjiang&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; artifactId = &lt;span style="color:#e6db74"&gt;&amp;#34;android_common_utils&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; version = android.defaultConfig.versionName
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; pom(getMyPom())
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// 添加javadoc
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; artifact(tasks.getByName(&lt;span style="color:#e6db74"&gt;&amp;#34;jarJavadoc&amp;#34;&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; Jar)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// 添加source
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; artifact(tasks.getByName(&lt;span style="color:#e6db74"&gt;&amp;#34;jarSource&amp;#34;&lt;/span&gt;) &lt;span style="color:#66d9ef"&gt;as&lt;/span&gt; Jar)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; repositories {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;val&lt;/span&gt; ossrhCredentials = Action&amp;lt;PasswordCredentials&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; username = properties[&lt;span style="color:#e6db74"&gt;&amp;#34;ossrhUsername&amp;#34;&lt;/span&gt;].toString()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; password = properties[&lt;span style="color:#e6db74"&gt;&amp;#34;ossrhPassword&amp;#34;&lt;/span&gt;].toString()
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// sonar的仓库，地址根据项目的版本号来确定是snapshot还是正式仓库
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; maven {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name = &lt;span style="color:#e6db74"&gt;&amp;#34;Sonartype&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;val&lt;/span&gt; releasesRepoUrl = uri(&lt;span style="color:#e6db74"&gt;&amp;#34;https://oss.sonatype.org/service/local/staging/deploy/maven2&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;val&lt;/span&gt; snapshotsRepoUrl = uri(&lt;span style="color:#e6db74"&gt;&amp;#34;https://oss.sonatype.org/content/repositories/snapshots/&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url = &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (android.defaultConfig.versionName.toString().endsWith(&lt;span style="color:#e6db74"&gt;&amp;#34;SNAPSHOT&amp;#34;&lt;/span&gt;)) snapshotsRepoUrl &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; releasesRepoUrl
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; credentials(ossrhCredentials)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// snapshot的地址：
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; &lt;span style="color:#75715e"&gt;// https://oss.sonatype.org/content/repositories/snapshots/com/github/hanlyjiang/android_common_utils/
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// 项目本地的仓库
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; maven {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name = &lt;span style="color:#e6db74"&gt;&amp;#34;ProjectLocal&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;val&lt;/span&gt; releasesRepoUrl = uri(layout.buildDirectory.dir(&lt;span style="color:#e6db74"&gt;&amp;#34;repos/releases&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#66d9ef"&gt;val&lt;/span&gt; snapshotsRepoUrl = uri(layout.buildDirectory.dir(&lt;span style="color:#e6db74"&gt;&amp;#34;repos/snapshots&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url = &lt;span style="color:#66d9ef"&gt;if&lt;/span&gt; (android.defaultConfig.versionName.toString().endsWith(&lt;span style="color:#e6db74"&gt;&amp;#34;SNAPSHOT&amp;#34;&lt;/span&gt;)) snapshotsRepoUrl &lt;span style="color:#66d9ef"&gt;else&lt;/span&gt; releasesRepoUrl
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; signing {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; sign(publishing.publications.getByName(&lt;span style="color:#e6db74"&gt;&amp;#34;release&amp;#34;&lt;/span&gt;))
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="使用androidmavenpubplugin简化后的配置"&gt;使用AndroidMavenPubPlugin简化后的配置：&lt;/h3&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-kotlin" data-lang="kotlin"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#66d9ef"&gt;import&lt;/span&gt; org.gradle.api.publish.maven.MavenPom
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;plugins {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id(&lt;span style="color:#e6db74"&gt;&amp;#34;com.android.library&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id(&lt;span style="color:#e6db74"&gt;&amp;#34;signing&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#960050;background-color:#1e0010"&gt;`&lt;/span&gt;maven-publish&lt;span style="color:#960050;background-color:#1e0010"&gt;`&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;// 引入我们本地仓库中的gradle插件
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt; id(&lt;span style="color:#e6db74"&gt;&amp;#34;com.github.hanlyjiang.android_maven_pub&amp;#34;&lt;/span&gt;) version (&lt;span style="color:#e6db74"&gt;&amp;#34;0.0.5&amp;#34;&lt;/span&gt;) apply (&lt;span style="color:#66d9ef"&gt;false&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;android {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; defaultConfig {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; versionName(&lt;span style="color:#e6db74"&gt;&amp;#34;1.0.1-SNAPSHOT&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;dependencies {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#75715e"&gt;//
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;&lt;/span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;apply(plugin = &lt;span style="color:#e6db74"&gt;&amp;#34;com.github.hanlyjiang.android_maven_pub&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;configure&amp;lt;io.hanlyjiang.gradle.android.AndroidMavenPubPluginExtension&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; groupId.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;com.github.hanlyjiang&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; artifactId.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;android-common-utils&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; projectLocalRepoPath.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;local-maven-repo&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mavenPomAction.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(Action&amp;lt;MavenPom&amp;gt; {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Android Common Utils Lib&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; description.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Android Common Utils Library For HJ&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;https://github.com/hanlyjiang/lib_common_utils&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; properties.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; mapOf(
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;myProp&amp;#34;&lt;/span&gt; to &lt;span style="color:#e6db74"&gt;&amp;#34;value&amp;#34;&lt;/span&gt;,
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; &lt;span style="color:#e6db74"&gt;&amp;#34;prop.with.dots&amp;#34;&lt;/span&gt; to &lt;span style="color:#e6db74"&gt;&amp;#34;anotherValue&amp;#34;&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; )
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; licenses {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; license {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;The Apache License, Version 2.0&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;http://www.apache.org/licenses/LICENSE-2.0.txt&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; developers {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; developer {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; id.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;hanlyjiang&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; name.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;Hanly Jiang&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; email.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;hanlyjiang@outlook.com&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; scm {
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; connection.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;scm:git:git://github.com/hanlyjiang/lib_common_utils.git&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; developerConnection.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;scm:git:ssh://github.com/hanlyjiang/lib_common_utils.git&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; url.&lt;span style="color:#66d9ef"&gt;set&lt;/span&gt;(&lt;span style="color:#e6db74"&gt;&amp;#34;https://github.com/hanlyjiang/lib_common_utils&amp;#34;&lt;/span&gt;)
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; }
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt; })
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;}
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h2 id="使用步骤"&gt;使用步骤&lt;/h2&gt;
&lt;h3 id="引入插件"&gt;引入插件&lt;/h3&gt;
&lt;p&gt;在需要使用的模块的build脚本中，引入我们的插件，同时引入 &lt;code&gt;maven-publish&lt;/code&gt; 插件和&lt;code&gt; signing&lt;/code&gt; 插件。&lt;/p&gt;</description></item><item><title>IDEA使用技巧之导航</title><link>https://anlyjiang.github.io/posts/idea-shi-yong-ji-qiao-zhi-dao-hang/</link><pubDate>Wed, 21 Apr 2021 14:12:14 +0000</pubDate><guid>https://anlyjiang.github.io/posts/idea-shi-yong-ji-qiao-zhi-dao-hang/</guid><description>&lt;p&gt;介绍IDEA及AndroidStudio中的导航技巧，包括文件导航，代码元素（类，方法）导航，文本导航等，还有书签等的使用方法；提高编写代码及阅读代码的效率；&lt;/p&gt;
&lt;h2 id="插入符导航"&gt;插入符导航&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;后退：==⌘[==&lt;/li&gt;
&lt;li&gt;前进：==⌘]==&lt;/li&gt;
&lt;li&gt;最后编辑点： ==⇧⌘⌫==&lt;/li&gt;
&lt;li&gt;定位到当前的结束括号： ==Ctrl+M== 或者 ==↑== , ==↓==&lt;/li&gt;
&lt;li&gt;查看光标所在位置所属的元素：==⌃⇧Q== （注意看下图的左上角显示了当前的类）
&lt;ul&gt;
&lt;li&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;/li&gt;
&lt;li&gt;移动到当前开始括号对应的闭合括号： ==Ctrl + M==&lt;/li&gt;
&lt;li&gt;在代码块之间导航： ==⌥⇧⌘[== ==⌥⇧⌘]==&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="移动插入符"&gt;移动插入符&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;移动到下一个或者上一个单词： ==⌥→==，==⌥←==&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;移动到下个段落：（下个方法）&lt;/p&gt;
&lt;ol&gt;
&lt;li&gt;使用 ==Shift+Command+A== 调出Action搜索弹框；&lt;/li&gt;
&lt;li&gt;搜索 &lt;strong&gt;Move Caret Forward a Paragraph&lt;/strong&gt; 或 &lt;strong&gt;Move Caret Backward a Paragraph&lt;/strong&gt;&lt;/li&gt;
&lt;/ol&gt;
&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="查找最近的位置"&gt;查找最近的位置&lt;/h2&gt;
&lt;ul&gt;
&lt;li&gt;
&lt;p&gt;使用 ==⇧⌘E== 可以打开&lt;strong&gt;最近位置&lt;/strong&gt;的弹窗，使用上下健进行导航&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;在打开此弹窗时，再次使用 ==⇧⌘E== 可以选中 &lt;strong&gt;Show Changed Only&lt;/strong&gt;&lt;/p&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;可直接输入以搜索代码片段&lt;/p&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;/li&gt;
&lt;li&gt;
&lt;p&gt;删除记录： 按 ==Delete== 或者 ==⌫==&lt;/p&gt;</description></item><item><title>Gridea使用小记</title><link>https://anlyjiang.github.io/posts/gridea%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%B0/</link><pubDate>Mon, 05 Apr 2021 11:58:07 +0000</pubDate><guid>https://anlyjiang.github.io/posts/gridea%E4%BD%BF%E7%94%A8%E5%B0%8F%E8%AE%B0/</guid><description>&lt;p&gt;仅记录使用Gridea过程中解决的问题及解决方式&lt;/p&gt;
&lt;h2 id="下载安装并使用"&gt;下载安装并使用&lt;/h2&gt;
&lt;p&gt;访问这里（https://gridea.dev/）下载安装并使用，不赘述。&lt;/p&gt;
&lt;h2 id="远程同步github配置"&gt;远程同步github配置&lt;/h2&gt;
&lt;p&gt;关于建立仓库，获取token，配置pages赘述，仅记录额外的配置。&lt;/p&gt;
&lt;p&gt;在Gridea的工作目录的根目录中新建一个 &lt;code&gt;.gitignore&lt;/code&gt; 文件，输入如下内容：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-txt" data-lang="txt"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;.DS_Store
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;*/.DS_Store
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;# 自己的本地草稿
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;typora
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;p&gt;远程同步时，会将此文件放入到output目录下，然后将output目录推送到github上，为了避免将其中的某些文件推入到远程仓库，故可以通过此方式定义gitignore&lt;/p&gt;
&lt;/blockquote&gt;</description></item><item><title>Gitlab-Runner安装并注册</title><link>https://anlyjiang.github.io/posts/gitlab-%E5%AE%89%E8%A3%85%E5%B9%B6%E6%B3%A8%E5%86%8Cgitlab-runner/</link><pubDate>Thu, 11 Jun 2020 16:11:58 +0000</pubDate><guid>https://anlyjiang.github.io/posts/gitlab-%E5%AE%89%E8%A3%85%E5%B9%B6%E6%B3%A8%E5%86%8Cgitlab-runner/</guid><description>&lt;p&gt;本文介绍Gitlab-Runner的安装运行（包括docker方式安装运行及二进制直接运行），并介绍如何将Gitlab注册到Gitlab。同时还介绍了gitlab-runner的一些常用操作命令。&lt;/p&gt;
&lt;h2 id="安装gitlab-runner"&gt;安装Gitlab-Runner&lt;/h2&gt;
&lt;p&gt;gitlab-runner可以使用docker方式运行，也可以在主机上运行其二进制可执行文件，可按如下方式进行选择：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;执行通用的构建测试任务及与不需要直接访问主机目录的，以docker方式安装；&lt;/li&gt;
&lt;li&gt;执行部署类任务或需要直接访问主机目录的，以二进制方式安装；&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;以下分别介绍上述两种安装方式。&lt;/p&gt;
&lt;h3 id="使用docker安装gitlab-runner"&gt;使用docker安装gitlab-runner&lt;/h3&gt;
&lt;p&gt;使用docker方式安装的，需先在主机上安装docker环境，可参考 Docker 官方安装文档。以下操作假设主机上已正确安装并配置了docker运行环境；&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;提示：可以使用基于alpine的镜像来减小大小&lt;/p&gt;
&lt;/blockquote&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 建立配置挂载目录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir -p /data/gitlab-runner/config
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 建立构建目录挂载目录&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir -p /data/gitlab-runner/home
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 注意，这里我们使用了基于alpine的镜像来减小大小；使用 --restart 标识来自动重启&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker run -d --name gitlab-runner --restart always &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; -v /data/gitlab-runner/config:/etc/gitlab-runner &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; -v /data/gitlab-runner/home:/home/gitlab-runner &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; -v /var/run/docker.sock:/var/run/docker.sock &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; gitlab/gitlab-runner:alpine
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 通过以下命令设置docker开机自启&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;sudo systemctl enable docker
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="docker安装的gitlab-runner常用操作"&gt;docker安装的gitlab-runner常用操作&lt;/h3&gt;
&lt;h4 id="运行命令"&gt;运行命令&lt;/h4&gt;
&lt;p&gt;使用已有容器&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 容器已经运行的情况下&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 1. 交互式执行，执行以下命令，然后输入命令&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker exec -it gitlab-runner /bin/bash
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 然后执行命令&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;gitlab-runer --help
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 2. 单次执行&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker exec gitlab-runner gitlab-runner --help
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;p&gt;使用临时的：&lt;/p&gt;</description></item><item><title>Gitlab安装配置</title><link>https://anlyjiang.github.io/posts/gitlab-%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AEgitlab/</link><pubDate>Mon, 06 Apr 2020 11:54:06 +0000</pubDate><guid>https://anlyjiang.github.io/posts/gitlab-%E5%AE%89%E8%A3%85%E5%B9%B6%E9%85%8D%E7%BD%AEgitlab/</guid><description>&lt;p&gt;主要内容：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;使用docker运行 gitlab；&lt;/li&gt;
&lt;li&gt;配置LDAP及邮箱；&lt;/li&gt;
&lt;li&gt;配置管理员账号；&lt;/li&gt;
&lt;li&gt;配置邮箱通知；&lt;/li&gt;
&lt;li&gt;关闭用户注册；&lt;/li&gt;
&lt;/ul&gt;
&lt;h2 id="安装"&gt;安装&lt;/h2&gt;
&lt;p&gt;我们使用docker来安装Gitlab，执行如下命令即可安装运行，完成后使用&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;export GITLAB_DATA&lt;span style="color:#f92672"&gt;=&lt;/span&gt;/data/gitlab
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 设置主机的ip域名&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;export HOST_IP&lt;span style="color:#f92672"&gt;=&lt;/span&gt;192.168.43.62
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;mkdir $GITLAB_DATA/config $GITLAB_DATA/logs $GITLAB_DATA/data
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker run --detach &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --hostname $HOST_IP &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --publish 443:443 --publish 80:80 --publish 22:22 &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --name gitlab &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --restart always &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --volume $GITLAB_DATA/config:/etc/gitlab &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --volume $GITLAB_DATA/logs:/var/log/gitlab &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; --volume $GITLAB_DATA/data:/var/opt/gitlab &lt;span style="color:#ae81ff"&gt;\
&lt;/span&gt;&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#ae81ff"&gt;&lt;/span&gt; gitlab/gitlab-ce:13.9.1-ce.0
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;blockquote&gt;
&lt;ul&gt;
&lt;li&gt;数据全部挂载在外部目录 GITLAB_DATA 中&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--hostname 192.168.43.62&lt;/code&gt; : 指定当前服务的IP或者域名，后续将会显示为gitlab代码仓库的克隆地址&lt;/li&gt;
&lt;li&gt;&lt;code&gt;--restart always&lt;/code&gt; : 设置服务自动重启&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;blockquote&gt;
&lt;p&gt;查看gitlab的可用版本：&lt;/p&gt;
&lt;ul&gt;
&lt;li&gt;&lt;a href="dockerhub/gitlab-ce"&gt;dockerhub/gitlab-ce&lt;/a&gt;&lt;/li&gt;
&lt;li&gt;&lt;a href="https://about.gitlab.com/releases/categories/releases/"&gt;gitlab release page&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;h3 id="查看启动状态"&gt;&lt;strong&gt;查看启动状态&lt;/strong&gt;&lt;/h3&gt;
&lt;p&gt;启动期间可以使用 &lt;code&gt;docker ps&lt;/code&gt; 查看状态，如STATUS中显示为&lt;code&gt;starting&lt;/code&gt;则表示服务还在启动中，如显示为&lt;code&gt;healthy&lt;/code&gt;则表示服务已正常启动，即可访问 http://192.168.43.62 访问Gitlab的web地址。&lt;/p&gt;</description></item></channel></rss>