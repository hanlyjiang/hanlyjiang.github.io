<?xml version="1.0" encoding="utf-8" standalone="yes"?><rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/"><channel><title>工作 on 清水池塘</title><link>https://anlyjiang.github.io/tags/%E5%B7%A5%E4%BD%9C/</link><description>Recent content in 工作 on 清水池塘</description><generator>Hugo -- 0.152.2</generator><language>zh-cn</language><lastBuildDate>Thu, 08 Apr 2021 16:48:23 +0000</lastBuildDate><atom:link href="https://anlyjiang.github.io/tags/%E5%B7%A5%E4%BD%9C/index.xml" rel="self" type="application/rss+xml"/><item><title>工作交接-Gitlab相关</title><link>https://anlyjiang.github.io/posts/%E5%B7%A5%E4%BD%9C%E4%BA%A4%E6%8E%A5-gitlab%E7%9B%B8%E5%85%B3/</link><pubDate>Thu, 08 Apr 2021 16:48:23 +0000</pubDate><guid>https://anlyjiang.github.io/posts/%E5%B7%A5%E4%BD%9C%E4%BA%A4%E6%8E%A5-gitlab%E7%9B%B8%E5%85%B3/</guid><description>&lt;h1 id="gitlab持续集成效率工具"&gt;Gitlab&amp;amp;持续集成&amp;amp;效率工具&lt;/h1&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;graph
Gitlab[Gitlab&amp;amp;持续集成&amp;amp;效率工具]
Gitlab --&amp;gt; 服务维护
Gitlab --&amp;gt; Gitlab&amp;amp;Sonar使用问题解答与解决
Gitlab --&amp;gt; CI[基于Gitlab CI的自动化流程]
&lt;/code&gt;&lt;/pre&gt;&lt;h2 id="服务维护"&gt;服务维护&lt;/h2&gt;
&lt;p&gt;目前有3个服务器需要维护，上面有部署若干服务：&lt;/p&gt;
&lt;pre tabindex="0"&gt;&lt;code class="language-mermaid" data-lang="mermaid"&gt;graph
205[172.17.0.205]
206[172.17.0.206]
208[172.17.0.208]
205 --&amp;gt; gitlab
206 --&amp;gt; sonarqube
206 --&amp;gt; mattermost
208 --&amp;gt; yapi
208 --&amp;gt; confluence
208 --&amp;gt; gitlab-runner
208 --&amp;gt; 移动中心H5站点
&lt;/code&gt;&lt;/pre&gt;&lt;p&gt;服务的连接方式及部署的服务可以参考文档： &lt;a href="https://shimo.im/docs/REkKVZppmPcjFQqx/"&gt;《Gitlab-SonarQube服务信息汇总》&lt;/a&gt;， 该文档记录了服务器的ssh远程的方式，各服务的部署启动方式，部署的目录；&lt;/p&gt;
&lt;p&gt;以下简要说明各个服务的维护方式及可能遇到的问题。&lt;/p&gt;
&lt;h3 id="gitlab205"&gt;gitlab（205）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;部署目录： &lt;code&gt;/data/gitlab/&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;teambition的thoughts上记录了部分使用过程中可能遇到的问题，可以访问&lt;a href="https://thoughts.teambition.com/workspaces/5e8da16aaf7af5001a4c7222/folders/5ee970c5b7ad5400012b51ac"&gt;tb的此文档目录&lt;/a&gt; 进行查阅；&lt;/p&gt;
&lt;p&gt;这里我们重点强调下gitlab的重启可能遇到的问题，&lt;strong&gt;使用过程中发现，在gitlab重启时，如果有gitlab-runner不停的向gitlab服务器发送请求，则有可能导致gitlab无法启动，故我们采取gitlab启动过程中不连接网络，启动完成后再连接网络的方式启动gitlab&lt;/strong&gt;详细可参考&lt;a href="https://thoughts.teambition.com/workspaces/5e8da16aaf7af5001a4c7222/docs/5f4c5eaf77f66f00010659ae"&gt;tb上的此文章&lt;/a&gt;。&lt;/p&gt;
&lt;h3 id="sonarqube-206"&gt;sonarqube （206）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;部署目录：&lt;code&gt;/data/_data/sonarqube&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;p&gt;一般只需要启动及重启，可参考 &lt;a href="https://shimo.im/docs/REkKVZppmPcjFQqx/"&gt;《Gitlab-SonarQube服务信息汇总》&lt;/a&gt; 的相关小节，主要命令如下：&lt;/p&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 部署 &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker stack deploy -c docker-compose.yml sonarqube
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 停止 &lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker stack down sonarqube
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 重新启动&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker stack up sonarqube -c docker-compose.yml
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="yapi208"&gt;yapi（208）&lt;/h3&gt;
&lt;ul&gt;
&lt;li&gt;部署目录： &lt;code&gt;/data/yapi-docker-deploy&lt;/code&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;div class="highlight"&gt;&lt;pre tabindex="0" style="color:#f8f8f2;background-color:#272822;-moz-tab-size:4;-o-tab-size:4;tab-size:4;"&gt;&lt;code class="language-shell" data-lang="shell"&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 启动命令&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;docker stack deploy -c docker-compose.yml yapi
&lt;/span&gt;&lt;/span&gt;&lt;span style="display:flex;"&gt;&lt;span&gt;&lt;span style="color:#75715e"&gt;# 其他维护命令基于yapi的stack执行即可&lt;/span&gt;
&lt;/span&gt;&lt;/span&gt;&lt;/code&gt;&lt;/pre&gt;&lt;/div&gt;&lt;h3 id="mattermost相关206"&gt;mattermost相关（206）&lt;/h3&gt;
&lt;p&gt;mattermost相关请联系段春先&lt;/p&gt;</description></item><item><title>移动中心交接</title><link>https://anlyjiang.github.io/posts/%E7%A7%BB%E5%8A%A8%E4%B8%AD%E5%BF%83%E4%BA%A4%E6%8E%A5/</link><pubDate>Thu, 08 Apr 2021 16:46:15 +0000</pubDate><guid>https://anlyjiang.github.io/posts/%E7%A7%BB%E5%8A%A8%E4%B8%AD%E5%BF%83%E4%BA%A4%E6%8E%A5/</guid><description>&lt;h1 id="geopanel-移动中心-代码同步"&gt;GeoPanel-移动中心-代码同步&lt;/h1&gt;
&lt;h2 id="一般步骤"&gt;一般步骤&lt;/h2&gt;
&lt;ol&gt;
&lt;li&gt;克隆gitlab代码到本地&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ol start="2"&gt;
&lt;li&gt;
&lt;p&gt;添加github远程仓库到本地仓库（下面取名为github）&lt;/p&gt;
&lt;p&gt;可使用 &lt;code&gt;git remote -v show&lt;/code&gt; 命令确认当前说注册的远程仓库列表&lt;/p&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ol start="3"&gt;
&lt;li&gt;
&lt;p&gt;使用 &lt;code&gt;fetch&lt;/code&gt; 命令获取github远程仓库代码到本地&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;通过 &lt;code&gt;git fetch github&lt;/code&gt; 获取github远程仓库上的所有分支及tag&lt;/p&gt;
&lt;p&gt;如我们需要获取指定分支（如：alpha分支），也可以通过 &lt;code&gt;git fetch github alpha:refs/remotes/github/alpha&lt;/code&gt; 只拉取指定分支；&lt;/p&gt;
&lt;p&gt;如果我们需要获取指定tag（如 v1.3.3），可通过 &lt;code&gt;git fetch github v1.3.3:refs/tagg/v1.3.3&lt;/code&gt; 只拉取指定tag；&lt;/p&gt;
&lt;/blockquote&gt;
&lt;/li&gt;
&lt;/ol&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;!-- raw HTML omitted --&gt;
&lt;ol start="4"&gt;
&lt;li&gt;
&lt;p&gt;将上一步拉取的github远程仓库上的分支/tag推送到gitlab远程仓库的指定分支；&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;推送分支到gitlab：&lt;code&gt;git push origin refs/remotes/github/alpha:alpha&lt;/code&gt;&lt;/p&gt;
&lt;p&gt;推送tag到github：&lt;code&gt;git push origin refs/tags/v1.3.3:v1.3.3&lt;/code&gt;&lt;/p&gt;</description></item></channel></rss>