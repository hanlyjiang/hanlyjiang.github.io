!function e(t,n,i){var o="function"==typeof hypothesisRequire&&hypothesisRequire;function r(s,a){if(!n[s]){if(!t[s]){var l="function"==typeof hypothesisRequire&&hypothesisRequire;if(!a&&l)return l(s,!0);if(o)return o(s,!0);var c=new Error("Cannot find module '"+s+"'");throw c.code="MODULE_NOT_FOUND",c}var u=n[s]={exports:{}};t[s][0].call(u.exports,(function(e){var n=t[s][1][e];return r(n||e)}),u,u.exports,e,t,n,i)}return n[s].exports}for(var s=0;s<i.length;s++)r(i[s]);return r}({1:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeKeyName=function(e){const t={Left:"ArrowLeft",Up:"ArrowUp",Down:"ArrowDown",Right:"ArrowRight",Spacebar:" ",Del:"Delete"};return t[e]?t[e]:e}},{}],2:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SvgIcon=h,n.registerIcons=function(e,{reset:t=!1}={}){t&&(u={}),Object.assign(u,e)},n.availableIcons=function(){return u};var i=a(e("classnames")),o=e("preact/hooks"),r=a(e("prop-types")),s=e("preact/compat/jsx-dev-runtime");function a(e){return e&&e.__esModule?e:{default:e}}function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let u={};function h({name:e,className:t="",inline:n=!1,title:r=""}){if(!u[e])throw new Error(`Icon name "${e}" is not registered`);const a=u[e],h=(0,o.useRef)();(0,o.useLayoutEffect)((()=>{const e=h.current.querySelector("svg");e&&e.setAttribute("class",t)}),[t,a]);const d={};return r&&(d.title=r),(0,s.jsxDEV)("span",function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({className:(0,i.default)("SvgIcon",{"SvgIcon--inline":n}),dangerouslySetInnerHTML:{__html:a},ref:h},d),void 0,!1,{fileName:"/Users/kyle/Documents/client/frontend-shared/src/components/SvgIcon.js",lineNumber:70,columnNumber:5},this)}h.propTypes={name:r.default.string.isRequired,className:r.default.string,inline:r.default.bool,title:r.default.string}},{classnames:6,"preact/compat/jsx-dev-runtime":10,"preact/hooks":12,"prop-types":15}],3:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.useElementShouldClose=function(e,t,n){(0,i.useEffect)((()=>{if(!t)return()=>{};const i=r(document.body,["keydown"],(e=>{const t=e;"Escape"===(0,o.normalizeKeyName)(t.key)&&n()})),s=r(document.body,["focus"],(t=>{e.current.contains(t.target)||n()}),{useCapture:!0}),a=r(document.body,["mousedown","click"],(t=>{e.current.contains(t.target)||n()}),{useCapture:!0});return()=>{i(),a(),s()}}),[e,t,n])};var i=e("preact/hooks"),o=e("../browser-compatibility-utils");function r(e,t,n,{useCapture:i=!1}={}){return t.forEach((t=>e.addEventListener(t,n,i))),()=>{t.forEach((t=>e.removeEventListener(t,n,i)))}}},{"../browser-compatibility-utils":1,"preact/hooks":12}],4:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),Object.defineProperty(n,"SvgIcon",{enumerable:!0,get:function(){return i.SvgIcon}}),Object.defineProperty(n,"registerIcons",{enumerable:!0,get:function(){return i.registerIcons}}),Object.defineProperty(n,"useElementShouldClose",{enumerable:!0,get:function(){return o.useElementShouldClose}}),Object.defineProperty(n,"normalizeKeyName",{enumerable:!0,get:function(){return r.normalizeKeyName}});var i=e("./components/SvgIcon"),o=e("./hooks/use-element-should-close"),r=e("./browser-compatibility-utils")},{"./browser-compatibility-utils":1,"./components/SvgIcon":2,"./hooks/use-element-should-close":3}],5:[function(e,t,n){"use strict";function i(e){return e.split("").reverse().join("")}function o(e){return(e|-e)>>31&1}function r(e,t,n,i){var r=e.P[n],s=e.M[n],a=i>>>31,l=t[n]|a,c=l|s,u=(l&r)+r^r|l,h=s|~(u|r),d=r&u,f=o(h&e.lastRowMask[n])-o(d&e.lastRowMask[n]);return h<<=1,d<<=1,r=(d|=a)|~(c|(h|=o(i)-a)),s=h&c,e.P[n]=r,e.M[n]=s,f}function s(e,t,n){if(0===t.length)return[];n=Math.min(n,t.length);var i=[],o=32,s=Math.ceil(t.length/o)-1,a={P:new Uint32Array(s+1),M:new Uint32Array(s+1),lastRowMask:new Uint32Array(s+1)};a.lastRowMask.fill(1<<31),a.lastRowMask[s]=1<<(t.length-1)%o;for(var l=new Uint32Array(s+1),c=new Map,u=[],h=0;h<256;h++)u.push(l);for(var d=0;d<t.length;d+=1){var f=t.charCodeAt(d);if(!c.has(f)){var p=new Uint32Array(s+1);c.set(f,p),f<u.length&&(u[f]=p);for(var g=0;g<=s;g+=1){p[g]=0;for(var m=0;m<o;m+=1){var _=g*o+m;_>=t.length||t.charCodeAt(_)===f&&(p[g]|=1<<m)}}}}var v=Math.max(0,Math.ceil(n/o)-1),y=new Uint32Array(s+1);for(g=0;g<=v;g+=1)y[g]=(g+1)*o;for(y[s]=t.length,g=0;g<=v;g+=1)a.P[g]=-1,a.M[g]=0;for(var b=0;b<e.length;b+=1){var w=e.charCodeAt(b);p=void 0,w<u.length?p=u[w]:void 0===(p=c.get(w))&&(p=l);var E=0;for(g=0;g<=v;g+=1)E=r(a,p,g,E),y[g]+=E;if(y[v]-E<=n&&v<s&&(1&p[v+1]||E<0)){v+=1,a.P[v]=-1,a.M[v]=0;var O=v===s?t.length%o:o;y[v]=y[v-1]+O-E+r(a,p,v,E)}else for(;v>0&&y[v]>=n+o;)v-=1;v===s&&y[v]<=n&&(y[v]<n&&i.splice(0,i.length),i.push({start:-1,end:b+1,errors:y[v]}),n=y[v])}return i}Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t,n){return function(e,t,n){var o=i(t);return n.map((function(n){var r=Math.max(0,n.end-t.length-n.errors);return{start:s(i(e.slice(r,n.end)),o,n.errors).reduce((function(e,t){return n.end-t.end<e?n.end-t.end:e}),n.end),end:n.end,errors:n.errors}}))}(e,t,s(e,t,n))}},{}],6:[function(e,t,n){(function(e){(function(){
/*!
  Copyright (c) 2017 Jed Watson.
  Licensed under the MIT License (MIT), see
  http://jedwatson.github.io/classnames
*/
!function(){"use strict";var n={}.hasOwnProperty;function i(){for(var e=[],t=0;t<arguments.length;t++){var o=arguments[t];if(o){var r=typeof o;if("string"===r||"number"===r)e.push(o);else if(Array.isArray(o)&&o.length){var s=i.apply(null,o);s&&e.push(s)}else if("object"===r)for(var a in o)n.call(o,a)&&o[a]&&e.push(a)}}return e.join(" ")}void 0!==t&&t.exports?(i.default=i,t.exports=i):"function"==typeof e&&"object"==typeof e.amd&&e.amd?e("classnames",[],(function(){return i})):window.classNames=i}()}).call(this)}).call(this,void 0)},{}],7:[function(e,t,n){(function(e){(function(){var i;i=function(){"use strict";function e(e){var t=!0,n=!1,i=null,o={text:!0,search:!0,url:!0,tel:!0,email:!0,password:!0,number:!0,date:!0,month:!0,week:!0,time:!0,datetime:!0,"datetime-local":!0};function r(e){return!!(e&&e!==document&&"HTML"!==e.nodeName&&"BODY"!==e.nodeName&&"classList"in e&&"contains"in e.classList)}function s(e){e.classList.contains("focus-visible")||(e.classList.add("focus-visible"),e.setAttribute("data-focus-visible-added",""))}function a(e){t=!1}function l(){document.addEventListener("mousemove",c),document.addEventListener("mousedown",c),document.addEventListener("mouseup",c),document.addEventListener("pointermove",c),document.addEventListener("pointerdown",c),document.addEventListener("pointerup",c),document.addEventListener("touchmove",c),document.addEventListener("touchstart",c),document.addEventListener("touchend",c)}function c(e){e.target.nodeName&&"html"===e.target.nodeName.toLowerCase()||(t=!1,document.removeEventListener("mousemove",c),document.removeEventListener("mousedown",c),document.removeEventListener("mouseup",c),document.removeEventListener("pointermove",c),document.removeEventListener("pointerdown",c),document.removeEventListener("pointerup",c),document.removeEventListener("touchmove",c),document.removeEventListener("touchstart",c),document.removeEventListener("touchend",c))}document.addEventListener("keydown",(function(n){n.metaKey||n.altKey||n.ctrlKey||(r(e.activeElement)&&s(e.activeElement),t=!0)}),!0),document.addEventListener("mousedown",a,!0),document.addEventListener("pointerdown",a,!0),document.addEventListener("touchstart",a,!0),document.addEventListener("visibilitychange",(function(e){"hidden"===document.visibilityState&&(n&&(t=!0),l())}),!0),l(),e.addEventListener("focus",(function(e){var n,i,a;r(e.target)&&(t||(i=(n=e.target).type,"INPUT"===(a=n.tagName)&&o[i]&&!n.readOnly||"TEXTAREA"===a&&!n.readOnly||n.isContentEditable))&&s(e.target)}),!0),e.addEventListener("blur",(function(e){var t;r(e.target)&&(e.target.classList.contains("focus-visible")||e.target.hasAttribute("data-focus-visible-added"))&&(n=!0,window.clearTimeout(i),i=window.setTimeout((function(){n=!1}),100),(t=e.target).hasAttribute("data-focus-visible-added")&&(t.classList.remove("focus-visible"),t.removeAttribute("data-focus-visible-added")))}),!0),e.nodeType===Node.DOCUMENT_FRAGMENT_NODE&&e.host?e.host.setAttribute("data-js-focus-visible",""):e.nodeType===Node.DOCUMENT_NODE&&(document.documentElement.classList.add("js-focus-visible"),document.documentElement.setAttribute("data-js-focus-visible",""))}if("undefined"!=typeof window&&"undefined"!=typeof document){var t;window.applyFocusVisiblePolyfill=e;try{t=new CustomEvent("focus-visible-polyfill-ready")}catch(n){(t=document.createEvent("CustomEvent")).initCustomEvent("focus-visible-polyfill-ready",!1,!1,{})}window.dispatchEvent(t)}"undefined"!=typeof document&&e(document)},"object"==typeof n&&void 0!==t?i():"function"==typeof e&&e.amd?e(i):i()}).call(this)}).call(this,void 0)},{}],8:[function(e,t,n){(function(e){(function(){
/*! Hammer.JS - v2.0.7 - 2016-04-22
 * http://hammerjs.github.io/
 *
 * Copyright (c) 2016 Jorik Tangelder;
 * Licensed under the MIT license */
!function(n,i,o,r){"use strict";var s,a=["","webkit","Moz","MS","ms","o"],l=i.createElement("div"),c=Math.round,u=Math.abs,h=Date.now;function d(e,t,n){return setTimeout(y(e,n),t)}function f(e,t,n){return!!Array.isArray(e)&&(p(e,n[t],n),!0)}function p(e,t,n){var i;if(e)if(e.forEach)e.forEach(t,n);else if(e.length!==r)for(i=0;i<e.length;)t.call(n,e[i],i,e),i++;else for(i in e)e.hasOwnProperty(i)&&t.call(n,e[i],i,e)}function g(e,t,i){var o="DEPRECATED METHOD: "+t+"\n"+i+" AT \n";return function(){var t=new Error("get-stack-trace"),i=t&&t.stack?t.stack.replace(/^[^\(]+?[\n$]/gm,"").replace(/^\s+at\s+/gm,"").replace(/^Object.<anonymous>\s*\(/gm,"{anonymous}()@"):"Unknown Stack Trace",r=n.console&&(n.console.warn||n.console.log);return r&&r.call(n.console,o,i),e.apply(this,arguments)}}s="function"!=typeof Object.assign?function(e){if(e===r||null===e)throw new TypeError("Cannot convert undefined or null to object");for(var t=Object(e),n=1;n<arguments.length;n++){var i=arguments[n];if(i!==r&&null!==i)for(var o in i)i.hasOwnProperty(o)&&(t[o]=i[o])}return t}:Object.assign;var m=g((function(e,t,n){for(var i=Object.keys(t),o=0;o<i.length;)(!n||n&&e[i[o]]===r)&&(e[i[o]]=t[i[o]]),o++;return e}),"extend","Use `assign`."),_=g((function(e,t){return m(e,t,!0)}),"merge","Use `assign`.");function v(e,t,n){var i,o=t.prototype;(i=e.prototype=Object.create(o)).constructor=e,i._super=o,n&&s(i,n)}function y(e,t){return function(){return e.apply(t,arguments)}}function b(e,t){return"function"==typeof e?e.apply(t&&t[0]||r,t):e}function w(e,t){return e===r?t:e}function E(e,t,n){p(T(t),(function(t){e.addEventListener(t,n,!1)}))}function O(e,t,n){p(T(t),(function(t){e.removeEventListener(t,n,!1)}))}function S(e,t){for(;e;){if(e==t)return!0;e=e.parentNode}return!1}function x(e,t){return e.indexOf(t)>-1}function T(e){return e.trim().split(/\s+/g)}function C(e,t,n){if(e.indexOf&&!n)return e.indexOf(t);for(var i=0;i<e.length;){if(n&&e[i][n]==t||!n&&e[i]===t)return i;i++}return-1}function P(e){return Array.prototype.slice.call(e,0)}function j(e,t,n){for(var i=[],o=[],r=0;r<e.length;){var s=t?e[r][t]:e[r];C(o,s)<0&&i.push(e[r]),o[r]=s,r++}return n&&(i=t?i.sort((function(e,n){return e[t]>n[t]})):i.sort()),i}function k(e,t){for(var n,i,o=t[0].toUpperCase()+t.slice(1),s=0;s<a.length;){if((i=(n=a[s])?n+o:t)in e)return i;s++}return r}var A=1;function R(e){var t=e.ownerDocument||e;return t.defaultView||t.parentWindow||n}var M="ontouchstart"in n,N=k(n,"PointerEvent")!==r,L=M&&/mobile|tablet|ip(ad|hone|od)|android/i.test(navigator.userAgent),D="touch",I="mouse",F=["x","y"],H=["clientX","clientY"];function q(e,t){var n=this;this.manager=e,this.callback=t,this.element=e.element,this.target=e.options.inputTarget,this.domHandler=function(t){b(e.options.enable,[e])&&n.handler(t)},this.init()}function B(e,t,n){var i=n.pointers.length,o=n.changedPointers.length,s=1&t&&i-o==0,a=12&t&&i-o==0;n.isFirst=!!s,n.isFinal=!!a,s&&(e.session={}),n.eventType=t,function(e,t){var n=e.session,i=t.pointers,o=i.length;n.firstInput||(n.firstInput=U(t)),o>1&&!n.firstMultiple?n.firstMultiple=U(t):1===o&&(n.firstMultiple=!1);var s=n.firstInput,a=n.firstMultiple,l=a?a.center:s.center,c=t.center=V(i);t.timeStamp=h(),t.deltaTime=t.timeStamp-s.timeStamp,t.angle=X(l,c),t.distance=$(l,c),function(e,t){var n=t.center,i=e.offsetDelta||{},o=e.prevDelta||{},r=e.prevInput||{};1!==t.eventType&&4!==r.eventType||(o=e.prevDelta={x:r.deltaX||0,y:r.deltaY||0},i=e.offsetDelta={x:n.x,y:n.y}),t.deltaX=o.x+(n.x-i.x),t.deltaY=o.y+(n.y-i.y)}(n,t),t.offsetDirection=z(t.deltaX,t.deltaY);var d,f,p=W(t.deltaTime,t.deltaX,t.deltaY);t.overallVelocityX=p.x,t.overallVelocityY=p.y,t.overallVelocity=u(p.x)>u(p.y)?p.x:p.y,t.scale=a?(d=a.pointers,$((f=i)[0],f[1],H)/$(d[0],d[1],H)):1,t.rotation=a?function(e,t){return X(t[1],t[0],H)+X(e[1],e[0],H)}(a.pointers,i):0,t.maxPointers=n.prevInput?t.pointers.length>n.prevInput.maxPointers?t.pointers.length:n.prevInput.maxPointers:t.pointers.length,function(e,t){var n,i,o,s,a=e.lastInterval||t,l=t.timeStamp-a.timeStamp;if(8!=t.eventType&&(l>25||a.velocity===r)){var c=t.deltaX-a.deltaX,h=t.deltaY-a.deltaY,d=W(l,c,h);i=d.x,o=d.y,n=u(d.x)>u(d.y)?d.x:d.y,s=z(c,h),e.lastInterval=t}else n=a.velocity,i=a.velocityX,o=a.velocityY,s=a.direction;t.velocity=n,t.velocityX=i,t.velocityY=o,t.direction=s}(n,t);var g=e.element;S(t.srcEvent.target,g)&&(g=t.srcEvent.target),t.target=g}(e,n),e.emit("hammer.input",n),e.recognize(n),e.session.prevInput=n}function U(e){for(var t=[],n=0;n<e.pointers.length;)t[n]={clientX:c(e.pointers[n].clientX),clientY:c(e.pointers[n].clientY)},n++;return{timeStamp:h(),pointers:t,center:V(t),deltaX:e.deltaX,deltaY:e.deltaY}}function V(e){var t=e.length;if(1===t)return{x:c(e[0].clientX),y:c(e[0].clientY)};for(var n=0,i=0,o=0;o<t;)n+=e[o].clientX,i+=e[o].clientY,o++;return{x:c(n/t),y:c(i/t)}}function W(e,t,n){return{x:t/e||0,y:n/e||0}}function z(e,t){return e===t?1:u(e)>=u(t)?e<0?2:4:t<0?8:16}function $(e,t,n){n||(n=F);var i=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return Math.sqrt(i*i+o*o)}function X(e,t,n){n||(n=F);var i=t[n[0]]-e[n[0]],o=t[n[1]]-e[n[1]];return 180*Math.atan2(o,i)/Math.PI}q.prototype={handler:function(){},init:function(){this.evEl&&E(this.element,this.evEl,this.domHandler),this.evTarget&&E(this.target,this.evTarget,this.domHandler),this.evWin&&E(R(this.element),this.evWin,this.domHandler)},destroy:function(){this.evEl&&O(this.element,this.evEl,this.domHandler),this.evTarget&&O(this.target,this.evTarget,this.domHandler),this.evWin&&O(R(this.element),this.evWin,this.domHandler)}};var Y={mousedown:1,mousemove:2,mouseup:4},G="mousedown",Q="mousemove mouseup";function K(){this.evEl=G,this.evWin=Q,this.pressed=!1,q.apply(this,arguments)}v(K,q,{handler:function(e){var t=Y[e.type];1&t&&0===e.button&&(this.pressed=!0),2&t&&1!==e.which&&(t=4),this.pressed&&(4&t&&(this.pressed=!1),this.callback(this.manager,t,{pointers:[e],changedPointers:[e],pointerType:I,srcEvent:e}))}});var Z={pointerdown:1,pointermove:2,pointerup:4,pointercancel:8,pointerout:8},J={2:D,3:"pen",4:I,5:"kinect"},ee="pointerdown",te="pointermove pointerup pointercancel";function ne(){this.evEl=ee,this.evWin=te,q.apply(this,arguments),this.store=this.manager.session.pointerEvents=[]}n.MSPointerEvent&&!n.PointerEvent&&(ee="MSPointerDown",te="MSPointerMove MSPointerUp MSPointerCancel"),v(ne,q,{handler:function(e){var t=this.store,n=!1,i=e.type.toLowerCase().replace("ms",""),o=Z[i],r=J[e.pointerType]||e.pointerType,s=r==D,a=C(t,e.pointerId,"pointerId");1&o&&(0===e.button||s)?a<0&&(t.push(e),a=t.length-1):12&o&&(n=!0),a<0||(t[a]=e,this.callback(this.manager,o,{pointers:t,changedPointers:[e],pointerType:r,srcEvent:e}),n&&t.splice(a,1))}});var ie={touchstart:1,touchmove:2,touchend:4,touchcancel:8},oe="touchstart",re="touchstart touchmove touchend touchcancel";function se(){this.evTarget=oe,this.evWin=re,this.started=!1,q.apply(this,arguments)}function ae(e,t){var n=P(e.touches),i=P(e.changedTouches);return 12&t&&(n=j(n.concat(i),"identifier",!0)),[n,i]}v(se,q,{handler:function(e){var t=ie[e.type];if(1===t&&(this.started=!0),this.started){var n=ae.call(this,e,t);12&t&&n[0].length-n[1].length==0&&(this.started=!1),this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:D,srcEvent:e})}}});var le={touchstart:1,touchmove:2,touchend:4,touchcancel:8},ce="touchstart touchmove touchend touchcancel";function ue(){this.evTarget=ce,this.targetIds={},q.apply(this,arguments)}function he(e,t){var n=P(e.touches),i=this.targetIds;if(3&t&&1===n.length)return i[n[0].identifier]=!0,[n,n];var o,r,s=P(e.changedTouches),a=[],l=this.target;if(r=n.filter((function(e){return S(e.target,l)})),1===t)for(o=0;o<r.length;)i[r[o].identifier]=!0,o++;for(o=0;o<s.length;)i[s[o].identifier]&&a.push(s[o]),12&t&&delete i[s[o].identifier],o++;return a.length?[j(r.concat(a),"identifier",!0),a]:void 0}function de(){q.apply(this,arguments);var e=y(this.handler,this);this.touch=new ue(this.manager,e),this.mouse=new K(this.manager,e),this.primaryTouch=null,this.lastTouches=[]}function fe(e,t){1&e?(this.primaryTouch=t.changedPointers[0].identifier,pe.call(this,t)):12&e&&pe.call(this,t)}function pe(e){var t=e.changedPointers[0];if(t.identifier===this.primaryTouch){var n={x:t.clientX,y:t.clientY};this.lastTouches.push(n);var i=this.lastTouches;setTimeout((function(){var e=i.indexOf(n);e>-1&&i.splice(e,1)}),2500)}}function ge(e){for(var t=e.srcEvent.clientX,n=e.srcEvent.clientY,i=0;i<this.lastTouches.length;i++){var o=this.lastTouches[i],r=Math.abs(t-o.x),s=Math.abs(n-o.y);if(r<=25&&s<=25)return!0}return!1}v(ue,q,{handler:function(e){var t=le[e.type],n=he.call(this,e,t);n&&this.callback(this.manager,t,{pointers:n[0],changedPointers:n[1],pointerType:D,srcEvent:e})}}),v(de,q,{handler:function(e,t,n){var i=n.pointerType==D,o=n.pointerType==I;if(!(o&&n.sourceCapabilities&&n.sourceCapabilities.firesTouchEvents)){if(i)fe.call(this,t,n);else if(o&&ge.call(this,n))return;this.callback(e,t,n)}},destroy:function(){this.touch.destroy(),this.mouse.destroy()}});var me=k(l.style,"touchAction"),_e=me!==r,ve="compute",ye="auto",be="manipulation",we="none",Ee="pan-x",Oe="pan-y",Se=function(){if(!_e)return!1;var e={},t=n.CSS&&n.CSS.supports;return["auto","manipulation","pan-y","pan-x","pan-x pan-y","none"].forEach((function(i){e[i]=!t||n.CSS.supports("touch-action",i)})),e}();function xe(e,t){this.manager=e,this.set(t)}xe.prototype={set:function(e){e==ve&&(e=this.compute()),_e&&this.manager.element.style&&Se[e]&&(this.manager.element.style[me]=e),this.actions=e.toLowerCase().trim()},update:function(){this.set(this.manager.options.touchAction)},compute:function(){var e=[];return p(this.manager.recognizers,(function(t){b(t.options.enable,[t])&&(e=e.concat(t.getTouchAction()))})),function(e){if(x(e,we))return we;var t=x(e,Ee),n=x(e,Oe);return t&&n?we:t||n?t?Ee:Oe:x(e,be)?be:ye}(e.join(" "))},preventDefaults:function(e){var t=e.srcEvent,n=e.offsetDirection;if(this.manager.session.prevented)t.preventDefault();else{var i=this.actions,o=x(i,we)&&!Se.none,r=x(i,Oe)&&!Se["pan-y"],s=x(i,Ee)&&!Se["pan-x"];if(o){var a=1===e.pointers.length,l=e.distance<2,c=e.deltaTime<250;if(a&&l&&c)return}if(!s||!r)return o||r&&6&n||s&&24&n?this.preventSrc(t):void 0}},preventSrc:function(e){this.manager.session.prevented=!0,e.preventDefault()}};var Te=32;function Ce(e){this.options=s({},this.defaults,e||{}),this.id=A++,this.manager=null,this.options.enable=w(this.options.enable,!0),this.state=1,this.simultaneous={},this.requireFail=[]}function Pe(e){return 16&e?"cancel":8&e?"end":4&e?"move":2&e?"start":""}function je(e){return 16==e?"down":8==e?"up":2==e?"left":4==e?"right":""}function ke(e,t){var n=t.manager;return n?n.get(e):e}function Ae(){Ce.apply(this,arguments)}function Re(){Ae.apply(this,arguments),this.pX=null,this.pY=null}function Me(){Ae.apply(this,arguments)}function Ne(){Ce.apply(this,arguments),this._timer=null,this._input=null}function Le(){Ae.apply(this,arguments)}function De(){Ae.apply(this,arguments)}function Ie(){Ce.apply(this,arguments),this.pTime=!1,this.pCenter=!1,this._timer=null,this._input=null,this.count=0}function Fe(e,t){return(t=t||{}).recognizers=w(t.recognizers,Fe.defaults.preset),new He(e,t)}function He(e,t){this.options=s({},Fe.defaults,t||{}),this.options.inputTarget=this.options.inputTarget||e,this.handlers={},this.session={},this.recognizers=[],this.oldCssProps={},this.element=e,this.input=new(this.options.inputClass||(N?ne:L?ue:M?de:K))(this,B),this.touchAction=new xe(this,this.options.touchAction),qe(this,!0),p(this.options.recognizers,(function(e){var t=this.add(new e[0](e[1]));e[2]&&t.recognizeWith(e[2]),e[3]&&t.requireFailure(e[3])}),this)}function qe(e,t){var n,i=e.element;i.style&&(p(e.options.cssProps,(function(o,r){n=k(i.style,r),t?(e.oldCssProps[n]=i.style[n],i.style[n]=o):i.style[n]=e.oldCssProps[n]||""})),t||(e.oldCssProps={}))}Ce.prototype={defaults:{},set:function(e){return s(this.options,e),this.manager&&this.manager.touchAction.update(),this},recognizeWith:function(e){if(f(e,"recognizeWith",this))return this;var t=this.simultaneous;return t[(e=ke(e,this)).id]||(t[e.id]=e,e.recognizeWith(this)),this},dropRecognizeWith:function(e){return f(e,"dropRecognizeWith",this)||(e=ke(e,this),delete this.simultaneous[e.id]),this},requireFailure:function(e){if(f(e,"requireFailure",this))return this;var t=this.requireFail;return-1===C(t,e=ke(e,this))&&(t.push(e),e.requireFailure(this)),this},dropRequireFailure:function(e){if(f(e,"dropRequireFailure",this))return this;e=ke(e,this);var t=C(this.requireFail,e);return t>-1&&this.requireFail.splice(t,1),this},hasRequireFailures:function(){return this.requireFail.length>0},canRecognizeWith:function(e){return!!this.simultaneous[e.id]},emit:function(e){var t=this,n=this.state;function i(n){t.manager.emit(n,e)}n<8&&i(t.options.event+Pe(n)),i(t.options.event),e.additionalEvent&&i(e.additionalEvent),n>=8&&i(t.options.event+Pe(n))},tryEmit:function(e){if(this.canEmit())return this.emit(e);this.state=Te},canEmit:function(){for(var e=0;e<this.requireFail.length;){if(!(33&this.requireFail[e].state))return!1;e++}return!0},recognize:function(e){var t=s({},e);if(!b(this.options.enable,[this,t]))return this.reset(),void(this.state=Te);56&this.state&&(this.state=1),this.state=this.process(t),30&this.state&&this.tryEmit(t)},process:function(e){},getTouchAction:function(){},reset:function(){}},v(Ae,Ce,{defaults:{pointers:1},attrTest:function(e){var t=this.options.pointers;return 0===t||e.pointers.length===t},process:function(e){var t=this.state,n=e.eventType,i=6&t,o=this.attrTest(e);return i&&(8&n||!o)?16|t:i||o?4&n?8|t:2&t?4|t:2:Te}}),v(Re,Ae,{defaults:{event:"pan",threshold:10,pointers:1,direction:30},getTouchAction:function(){var e=this.options.direction,t=[];return 6&e&&t.push(Oe),24&e&&t.push(Ee),t},directionTest:function(e){var t=this.options,n=!0,i=e.distance,o=e.direction,r=e.deltaX,s=e.deltaY;return o&t.direction||(6&t.direction?(o=0===r?1:r<0?2:4,n=r!=this.pX,i=Math.abs(e.deltaX)):(o=0===s?1:s<0?8:16,n=s!=this.pY,i=Math.abs(e.deltaY))),e.direction=o,n&&i>t.threshold&&o&t.direction},attrTest:function(e){return Ae.prototype.attrTest.call(this,e)&&(2&this.state||!(2&this.state)&&this.directionTest(e))},emit:function(e){this.pX=e.deltaX,this.pY=e.deltaY;var t=je(e.direction);t&&(e.additionalEvent=this.options.event+t),this._super.emit.call(this,e)}}),v(Me,Ae,{defaults:{event:"pinch",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.scale-1)>this.options.threshold||2&this.state)},emit:function(e){if(1!==e.scale){var t=e.scale<1?"in":"out";e.additionalEvent=this.options.event+t}this._super.emit.call(this,e)}}),v(Ne,Ce,{defaults:{event:"press",pointers:1,time:251,threshold:9},getTouchAction:function(){return[ye]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,o=e.deltaTime>t.time;if(this._input=e,!i||!n||12&e.eventType&&!o)this.reset();else if(1&e.eventType)this.reset(),this._timer=d((function(){this.state=8,this.tryEmit()}),t.time,this);else if(4&e.eventType)return 8;return Te},reset:function(){clearTimeout(this._timer)},emit:function(e){8===this.state&&(e&&4&e.eventType?this.manager.emit(this.options.event+"up",e):(this._input.timeStamp=h(),this.manager.emit(this.options.event,this._input)))}}),v(Le,Ae,{defaults:{event:"rotate",threshold:0,pointers:2},getTouchAction:function(){return[we]},attrTest:function(e){return this._super.attrTest.call(this,e)&&(Math.abs(e.rotation)>this.options.threshold||2&this.state)}}),v(De,Ae,{defaults:{event:"swipe",threshold:10,velocity:.3,direction:30,pointers:1},getTouchAction:function(){return Re.prototype.getTouchAction.call(this)},attrTest:function(e){var t,n=this.options.direction;return 30&n?t=e.overallVelocity:6&n?t=e.overallVelocityX:24&n&&(t=e.overallVelocityY),this._super.attrTest.call(this,e)&&n&e.offsetDirection&&e.distance>this.options.threshold&&e.maxPointers==this.options.pointers&&u(t)>this.options.velocity&&4&e.eventType},emit:function(e){var t=je(e.offsetDirection);t&&this.manager.emit(this.options.event+t,e),this.manager.emit(this.options.event,e)}}),v(Ie,Ce,{defaults:{event:"tap",pointers:1,taps:1,interval:300,time:250,threshold:9,posThreshold:10},getTouchAction:function(){return[be]},process:function(e){var t=this.options,n=e.pointers.length===t.pointers,i=e.distance<t.threshold,o=e.deltaTime<t.time;if(this.reset(),1&e.eventType&&0===this.count)return this.failTimeout();if(i&&o&&n){if(4!=e.eventType)return this.failTimeout();var r=!this.pTime||e.timeStamp-this.pTime<t.interval,s=!this.pCenter||$(this.pCenter,e.center)<t.posThreshold;if(this.pTime=e.timeStamp,this.pCenter=e.center,s&&r?this.count+=1:this.count=1,this._input=e,0==this.count%t.taps)return this.hasRequireFailures()?(this._timer=d((function(){this.state=8,this.tryEmit()}),t.interval,this),2):8}return Te},failTimeout:function(){return this._timer=d((function(){this.state=Te}),this.options.interval,this),Te},reset:function(){clearTimeout(this._timer)},emit:function(){8==this.state&&(this._input.tapCount=this.count,this.manager.emit(this.options.event,this._input))}}),Fe.VERSION="2.0.7",Fe.defaults={domEvents:!1,touchAction:ve,enable:!0,inputTarget:null,inputClass:null,preset:[[Le,{enable:!1}],[Me,{enable:!1},["rotate"]],[De,{direction:6}],[Re,{direction:6},["swipe"]],[Ie],[Ie,{event:"doubletap",taps:2},["tap"]],[Ne]],cssProps:{userSelect:"none",touchSelect:"none",touchCallout:"none",contentZooming:"none",userDrag:"none",tapHighlightColor:"rgba(0,0,0,0)"}},He.prototype={set:function(e){return s(this.options,e),e.touchAction&&this.touchAction.update(),e.inputTarget&&(this.input.destroy(),this.input.target=e.inputTarget,this.input.init()),this},stop:function(e){this.session.stopped=e?2:1},recognize:function(e){var t=this.session;if(!t.stopped){var n;this.touchAction.preventDefaults(e);var i=this.recognizers,o=t.curRecognizer;(!o||o&&8&o.state)&&(o=t.curRecognizer=null);for(var r=0;r<i.length;)n=i[r],2===t.stopped||o&&n!=o&&!n.canRecognizeWith(o)?n.reset():n.recognize(e),!o&&14&n.state&&(o=t.curRecognizer=n),r++}},get:function(e){if(e instanceof Ce)return e;for(var t=this.recognizers,n=0;n<t.length;n++)if(t[n].options.event==e)return t[n];return null},add:function(e){if(f(e,"add",this))return this;var t=this.get(e.options.event);return t&&this.remove(t),this.recognizers.push(e),e.manager=this,this.touchAction.update(),e},remove:function(e){if(f(e,"remove",this))return this;if(e=this.get(e)){var t=this.recognizers,n=C(t,e);-1!==n&&(t.splice(n,1),this.touchAction.update())}return this},on:function(e,t){if(e!==r&&t!==r){var n=this.handlers;return p(T(e),(function(e){n[e]=n[e]||[],n[e].push(t)})),this}},off:function(e,t){if(e!==r){var n=this.handlers;return p(T(e),(function(e){t?n[e]&&n[e].splice(C(n[e],t),1):delete n[e]})),this}},emit:function(e,t){this.options.domEvents&&function(e,t){var n=i.createEvent("Event");n.initEvent(e,!0,!0),n.gesture=t,t.target.dispatchEvent(n)}(e,t);var n=this.handlers[e]&&this.handlers[e].slice();if(n&&n.length){t.type=e,t.preventDefault=function(){t.srcEvent.preventDefault()};for(var o=0;o<n.length;)n[o](t),o++}},destroy:function(){this.element&&qe(this,!1),this.handlers={},this.session={},this.input.destroy(),this.element=null}},s(Fe,{INPUT_START:1,INPUT_MOVE:2,INPUT_END:4,INPUT_CANCEL:8,STATE_POSSIBLE:1,STATE_BEGAN:2,STATE_CHANGED:4,STATE_ENDED:8,STATE_RECOGNIZED:8,STATE_CANCELLED:16,STATE_FAILED:Te,DIRECTION_NONE:1,DIRECTION_LEFT:2,DIRECTION_RIGHT:4,DIRECTION_UP:8,DIRECTION_DOWN:16,DIRECTION_HORIZONTAL:6,DIRECTION_VERTICAL:24,DIRECTION_ALL:30,Manager:He,Input:q,TouchAction:xe,TouchInput:ue,MouseInput:K,PointerEventInput:ne,TouchMouseInput:de,SingleTouchInput:se,Recognizer:Ce,AttrRecognizer:Ae,Tap:Ie,Pan:Re,Swipe:De,Pinch:Me,Rotate:Le,Press:Ne,on:E,off:O,each:p,merge:_,extend:m,assign:s,inherit:v,bindFn:y,prefixed:k}),(void 0!==n?n:"undefined"!=typeof self?self:{}).Hammer=Fe,"function"==typeof e&&e.amd?e((function(){return Fe})):void 0!==t&&t.exports?t.exports=Fe:n.Hammer=Fe}(window,document)}).call(this)}).call(this,void 0)},{}],9:[function(e,t,n){(function(e){(function(){var n=/^\s+|\s+$/g,i=/^[-+]0x[0-9a-f]+$/i,o=/^0b[01]+$/i,r=/^0o[0-7]+$/i,s=parseInt,a="object"==typeof e&&e&&e.Object===Object&&e,l="object"==typeof self&&self&&self.Object===Object&&self,c=a||l||Function("return this")(),u=Object.prototype.toString,h=Math.max,d=Math.min,f=function(){return c.Date.now()};function p(e){var t=typeof e;return!!e&&("object"==t||"function"==t)}function g(e){if("number"==typeof e)return e;if(function(e){return"symbol"==typeof e||function(e){return!!e&&"object"==typeof e}(e)&&"[object Symbol]"==u.call(e)}(e))return NaN;if(p(e)){var t="function"==typeof e.valueOf?e.valueOf():e;e=p(t)?t+"":t}if("string"!=typeof e)return 0===e?e:+e;e=e.replace(n,"");var a=o.test(e);return a||r.test(e)?s(e.slice(2),a?2:8):i.test(e)?NaN:+e}t.exports=function(e,t,n){var i,o,r,s,a,l,c=0,u=!1,m=!1,_=!0;if("function"!=typeof e)throw new TypeError("Expected a function");function v(t){var n=i,r=o;return i=o=void 0,c=t,s=e.apply(r,n)}function y(e){return c=e,a=setTimeout(w,t),u?v(e):s}function b(e){var n=e-l;return void 0===l||n>=t||n<0||m&&e-c>=r}function w(){var e=f();if(b(e))return E(e);a=setTimeout(w,function(e){var n=t-(e-l);return m?d(n,r-(e-c)):n}(e))}function E(e){return a=void 0,_&&i?v(e):(i=o=void 0,s)}function O(){var e=f(),n=b(e);if(i=arguments,o=this,l=e,n){if(void 0===a)return y(l);if(m)return a=setTimeout(w,t),v(l)}return void 0===a&&(a=setTimeout(w,t)),s}return t=g(t)||0,p(n)&&(u=!!n.leading,r=(m="maxWait"in n)?h(g(n.maxWait)||0,t):r,_="trailing"in n?!!n.trailing:_),O.cancel=function(){void 0!==a&&clearTimeout(a),c=0,i=l=o=a=void 0},O.flush=function(){return void 0===a?s:E(f())},O}}).call(this)}).call(this,window)},{}],10:[function(e,t,n){t.exports=e("preact/jsx-runtime")},{"preact/jsx-runtime":13}],11:[function(e,t,n){var i,o,r,s,a,l,c={},u=[],h=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function d(e,t){for(var n in t)e[n]=t[n];return e}function f(e){var t=e.parentNode;t&&t.removeChild(e)}function p(e,t,n){var i,o,r,s=arguments,a={};for(r in t)"key"==r?i=t[r]:"ref"==r?o=t[r]:a[r]=t[r];if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(s[r]);if(null!=n&&(a.children=n),"function"==typeof e&&null!=e.defaultProps)for(r in e.defaultProps)void 0===a[r]&&(a[r]=e.defaultProps[r]);return g(e,a,i,o,null)}function g(e,t,n,o,r){var s={type:e,props:t,key:n,ref:o,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:null==r?++i.__v:r};return null!=i.vnode&&i.vnode(s),s}function m(e){return e.children}function _(e,t){this.props=e,this.context=t}function v(e,t){if(null==t)return e.__?v(e.__,e.__.__k.indexOf(e)+1):null;for(var n;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e)return n.__e;return"function"==typeof e.type?v(e):null}function y(e){var t,n;if(null!=(e=e.__)&&null!=e.__c){for(e.__e=e.__c.base=null,t=0;t<e.__k.length;t++)if(null!=(n=e.__k[t])&&null!=n.__e){e.__e=e.__c.base=n.__e;break}return y(e)}}function b(e){(!e.__d&&(e.__d=!0)&&r.push(e)&&!w.__r++||a!==i.debounceRendering)&&((a=i.debounceRendering)||s)(w)}function w(){for(var e;w.__r=r.length;)e=r.sort((function(e,t){return e.__v.__b-t.__v.__b})),r=[],e.some((function(e){var t,n,i,o,r,s;e.__d&&(r=(o=(t=e).__v).__e,(s=t.__P)&&(n=[],(i=d({},o)).__v=o.__v+1,j(s,o,i,t.__n,void 0!==s.ownerSVGElement,null!=o.__h?[r]:null,n,null==r?v(o):r,o.__h),k(n,o),o.__e!=r&&y(o)))}))}function E(e,t,n,i,o,r,s,a,l,h){var d,f,p,_,y,b,w,E=i&&i.__k||u,x=E.length;for(n.__k=[],d=0;d<t.length;d++)if(null!=(_=n.__k[d]=null==(_=t[d])||"boolean"==typeof _?null:"string"==typeof _||"number"==typeof _?g(null,_,null,null,_):Array.isArray(_)?g(m,{children:_},null,null,null):_.__b>0?g(_.type,_.props,_.key,null,_.__v):_)){if(_.__=n,_.__b=n.__b+1,null===(p=E[d])||p&&_.key==p.key&&_.type===p.type)E[d]=void 0;else for(f=0;f<x;f++){if((p=E[f])&&_.key==p.key&&_.type===p.type){E[f]=void 0;break}p=null}j(e,_,p=p||c,o,r,s,a,l,h),y=_.__e,(f=_.ref)&&p.ref!=f&&(w||(w=[]),p.ref&&w.push(p.ref,null,_),w.push(f,_.__c||y,_)),null!=y?(null==b&&(b=y),"function"==typeof _.type&&null!=_.__k&&_.__k===p.__k?_.__d=l=O(_,l,e):l=S(e,_,p,E,y,l),h||"option"!==n.type?"function"==typeof n.type&&(n.__d=l):e.value=""):l&&p.__e==l&&l.parentNode!=e&&(l=v(p))}for(n.__e=b,d=x;d--;)null!=E[d]&&("function"==typeof n.type&&null!=E[d].__e&&E[d].__e==n.__d&&(n.__d=v(i,d+1)),M(E[d],E[d]));if(w)for(d=0;d<w.length;d++)R(w[d],w[++d],w[++d])}function O(e,t,n){var i,o;for(i=0;i<e.__k.length;i++)(o=e.__k[i])&&(o.__=e,t="function"==typeof o.type?O(o,t,n):S(n,o,o,e.__k,o.__e,t));return t}function S(e,t,n,i,o,r){var s,a,l;if(void 0!==t.__d)s=t.__d,t.__d=void 0;else if(null==n||o!=r||null==o.parentNode)e:if(null==r||r.parentNode!==e)e.appendChild(o),s=null;else{for(a=r,l=0;(a=a.nextSibling)&&l<i.length;l+=2)if(a==o)break e;e.insertBefore(o,r),s=r}return void 0!==s?s:o.nextSibling}function x(e,t,n){"-"===t[0]?e.setProperty(t,n):e[t]=null==n?"":"number"!=typeof n||h.test(t)?n:n+"px"}function T(e,t,n,i,o){var r;e:if("style"===t)if("string"==typeof n)e.style.cssText=n;else{if("string"==typeof i&&(e.style.cssText=i=""),i)for(t in i)n&&t in n||x(e.style,t,"");if(n)for(t in n)i&&n[t]===i[t]||x(e.style,t,n[t])}else if("o"===t[0]&&"n"===t[1])r=t!==(t=t.replace(/Capture$/,"")),t=t.toLowerCase()in e?t.toLowerCase().slice(2):t.slice(2),e.l||(e.l={}),e.l[t+r]=n,n?i||e.addEventListener(t,r?P:C,r):e.removeEventListener(t,r?P:C,r);else if("dangerouslySetInnerHTML"!==t){if(o)t=t.replace(/xlink[H:h]/,"h").replace(/sName$/,"s");else if("href"!==t&&"list"!==t&&"form"!==t&&"download"!==t&&t in e)try{e[t]=null==n?"":n;break e}catch(e){}"function"==typeof n||(null!=n&&(!1!==n||"a"===t[0]&&"r"===t[1])?e.setAttribute(t,n):e.removeAttribute(t))}}function C(e){this.l[e.type+!1](i.event?i.event(e):e)}function P(e){this.l[e.type+!0](i.event?i.event(e):e)}function j(e,t,n,o,r,s,a,l,c){var u,h,f,p,g,v,y,b,w,O,S,x=t.type;if(void 0!==t.constructor)return null;null!=n.__h&&(c=n.__h,l=t.__e=n.__e,t.__h=null,s=[l]),(u=i.__b)&&u(t);try{e:if("function"==typeof x){if(b=t.props,w=(u=x.contextType)&&o[u.__c],O=u?w?w.props.value:u.__:o,n.__c?y=(h=t.__c=n.__c).__=h.__E:("prototype"in x&&x.prototype.render?t.__c=h=new x(b,O):(t.__c=h=new _(b,O),h.constructor=x,h.render=N),w&&w.sub(h),h.props=b,h.state||(h.state={}),h.context=O,h.__n=o,f=h.__d=!0,h.__h=[]),null==h.__s&&(h.__s=h.state),null!=x.getDerivedStateFromProps&&(h.__s==h.state&&(h.__s=d({},h.__s)),d(h.__s,x.getDerivedStateFromProps(b,h.__s))),p=h.props,g=h.state,f)null==x.getDerivedStateFromProps&&null!=h.componentWillMount&&h.componentWillMount(),null!=h.componentDidMount&&h.__h.push(h.componentDidMount);else{if(null==x.getDerivedStateFromProps&&b!==p&&null!=h.componentWillReceiveProps&&h.componentWillReceiveProps(b,O),!h.__e&&null!=h.shouldComponentUpdate&&!1===h.shouldComponentUpdate(b,h.__s,O)||t.__v===n.__v){h.props=b,h.state=h.__s,t.__v!==n.__v&&(h.__d=!1),h.__v=t,t.__e=n.__e,t.__k=n.__k,h.__h.length&&a.push(h);break e}null!=h.componentWillUpdate&&h.componentWillUpdate(b,h.__s,O),null!=h.componentDidUpdate&&h.__h.push((function(){h.componentDidUpdate(p,g,v)}))}h.context=O,h.props=b,h.state=h.__s,(u=i.__r)&&u(t),h.__d=!1,h.__v=t,h.__P=e,u=h.render(h.props,h.state,h.context),h.state=h.__s,null!=h.getChildContext&&(o=d(d({},o),h.getChildContext())),f||null==h.getSnapshotBeforeUpdate||(v=h.getSnapshotBeforeUpdate(p,g)),S=null!=u&&u.type===m&&null==u.key?u.props.children:u,E(e,Array.isArray(S)?S:[S],t,n,o,r,s,a,l,c),h.base=t.__e,t.__h=null,h.__h.length&&a.push(h),y&&(h.__E=h.__=null),h.__e=!1}else null==s&&t.__v===n.__v?(t.__k=n.__k,t.__e=n.__e):t.__e=A(n.__e,t,n,o,r,s,a,c);(u=i.diffed)&&u(t)}catch(e){t.__v=null,(c||null!=s)&&(t.__e=l,t.__h=!!c,s[s.indexOf(l)]=null),i.__e(e,t,n)}}function k(e,t){i.__c&&i.__c(t,e),e.some((function(t){try{e=t.__h,t.__h=[],e.some((function(e){e.call(t)}))}catch(e){i.__e(e,t.__v)}}))}function A(e,t,n,i,o,r,s,a){var l,h,d,p,g=n.props,m=t.props,_=t.type,v=0;if("svg"===_&&(o=!0),null!=r)for(;v<r.length;v++)if((l=r[v])&&(l===e||(_?l.localName==_:3==l.nodeType))){e=l,r[v]=null;break}if(null==e){if(null===_)return document.createTextNode(m);e=o?document.createElementNS("http://www.w3.org/2000/svg",_):document.createElement(_,m.is&&m),r=null,a=!1}if(null===_)g===m||a&&e.data===m||(e.data=m);else{if(r=r&&u.slice.call(e.childNodes),h=(g=n.props||c).dangerouslySetInnerHTML,d=m.dangerouslySetInnerHTML,!a){if(null!=r)for(g={},p=0;p<e.attributes.length;p++)g[e.attributes[p].name]=e.attributes[p].value;(d||h)&&(d&&(h&&d.__html==h.__html||d.__html===e.innerHTML)||(e.innerHTML=d&&d.__html||""))}if(function(e,t,n,i,o){var r;for(r in n)"children"===r||"key"===r||r in t||T(e,r,null,n[r],i);for(r in t)o&&"function"!=typeof t[r]||"children"===r||"key"===r||"value"===r||"checked"===r||n[r]===t[r]||T(e,r,t[r],n[r],i)}(e,m,g,o,a),d)t.__k=[];else if(v=t.props.children,E(e,Array.isArray(v)?v:[v],t,n,i,o&&"foreignObject"!==_,r,s,e.firstChild,a),null!=r)for(v=r.length;v--;)null!=r[v]&&f(r[v]);a||("value"in m&&void 0!==(v=m.value)&&(v!==e.value||"progress"===_&&!v)&&T(e,"value",v,g.value,!1),"checked"in m&&void 0!==(v=m.checked)&&v!==e.checked&&T(e,"checked",v,g.checked,!1))}return e}function R(e,t,n){try{"function"==typeof e?e(t):e.current=t}catch(e){i.__e(e,n)}}function M(e,t,n){var o,r,s;if(i.unmount&&i.unmount(e),(o=e.ref)&&(o.current&&o.current!==e.__e||R(o,null,t)),n||"function"==typeof e.type||(n=null!=(r=e.__e)),e.__e=e.__d=void 0,null!=(o=e.__c)){if(o.componentWillUnmount)try{o.componentWillUnmount()}catch(e){i.__e(e,t)}o.base=o.__P=null}if(o=e.__k)for(s=0;s<o.length;s++)o[s]&&M(o[s],t,n);null!=r&&f(r)}function N(e,t,n){return this.constructor(e,n)}function L(e,t,n){var o,r,s;i.__&&i.__(e,t),r=(o="function"==typeof n)?null:n&&n.__k||t.__k,s=[],j(t,e=(!o&&n||t).__k=p(m,null,[e]),r||c,c,void 0!==t.ownerSVGElement,!o&&n?[n]:r?null:t.firstChild?u.slice.call(t.childNodes):null,s,!o&&n?n:r?r.__e:t.firstChild,o),k(s,e)}i={__e:function(e,t){for(var n,i,o;t=t.__;)if((n=t.__c)&&!n.__)try{if((i=n.constructor)&&null!=i.getDerivedStateFromError&&(n.setState(i.getDerivedStateFromError(e)),o=n.__d),null!=n.componentDidCatch&&(n.componentDidCatch(e),o=n.__d),o)return n.__E=n}catch(t){e=t}throw e},__v:0},o=function(e){return null!=e&&void 0===e.constructor},_.prototype.setState=function(e,t){var n;n=null!=this.__s&&this.__s!==this.state?this.__s:this.__s=d({},this.state),"function"==typeof e&&(e=e(d({},n),this.props)),e&&d(n,e),null!=e&&this.__v&&(t&&this.__h.push(t),b(this))},_.prototype.forceUpdate=function(e){this.__v&&(this.__e=!0,e&&this.__h.push(e),b(this))},_.prototype.render=m,r=[],s="function"==typeof Promise?Promise.prototype.then.bind(Promise.resolve()):setTimeout,w.__r=0,l=0,n.render=L,n.hydrate=function e(t,n){L(t,n,e)},n.createElement=p,n.h=p,n.Fragment=m,n.createRef=function(){return{current:null}},n.isValidElement=o,n.Component=_,n.cloneElement=function(e,t,n){var i,o,r,s=arguments,a=d({},e.props);for(r in t)"key"==r?i=t[r]:"ref"==r?o=t[r]:a[r]=t[r];if(arguments.length>3)for(n=[n],r=3;r<arguments.length;r++)n.push(s[r]);return null!=n&&(a.children=n),g(e.type,a,i||e.key,o||e.ref,null)},n.createContext=function(e,t){var n={__c:t="__cC"+l++,__:e,Consumer:function(e,t){return e.children(t)},Provider:function(e){var n,i;return this.getChildContext||(n=[],(i={})[t]=this,this.getChildContext=function(){return i},this.shouldComponentUpdate=function(e){this.props.value!==e.value&&n.some(b)},this.sub=function(e){n.push(e);var t=e.componentWillUnmount;e.componentWillUnmount=function(){n.splice(n.indexOf(e),1),t&&t.call(e)}}),e.children}};return n.Provider.__=n.Consumer.contextType=n},n.toChildArray=function e(t,n){return n=n||[],null==t||"boolean"==typeof t||(Array.isArray(t)?t.some((function(t){e(t,n)})):n.push(t)),n},n.options=i},{}],12:[function(e,t,n){var i,o,r,s=e("preact"),a=0,l=[],c=s.options.__b,u=s.options.__r,h=s.options.diffed,d=s.options.__c,f=s.options.unmount;function p(e,t){s.options.__h&&s.options.__h(o,e,a||t),a=0;var n=o.__H||(o.__H={__:[],__h:[]});return e>=n.__.length&&n.__.push({}),n.__[e]}function g(e){return a=1,m(S,e)}function m(e,t,n){var r=p(i++,2);return r.t=e,r.__c||(r.__=[n?n(t):S(void 0,t),function(e){var t=r.t(r.__[0],e);r.__[0]!==t&&(r.__=[t,r.__[1]],r.__c.setState({}))}],r.__c=o),r.__}function _(e,t){var n=p(i++,4);!s.options.__s&&O(n.__H,t)&&(n.__=e,n.__H=t,o.__h.push(n))}function v(e,t){var n=p(i++,7);return O(n.__H,t)&&(n.__=e(),n.__H=t,n.__h=e),n.__}function y(){l.forEach((function(e){if(e.__P)try{e.__H.__h.forEach(w),e.__H.__h.forEach(E),e.__H.__h=[]}catch(o){e.__H.__h=[],s.options.__e(o,e.__v)}})),l=[]}s.options.__b=function(e){o=null,c&&c(e)},s.options.__r=function(e){u&&u(e),i=0;var t=(o=e.__c).__H;t&&(t.__h.forEach(w),t.__h.forEach(E),t.__h=[])},s.options.diffed=function(e){h&&h(e);var t=e.__c;t&&t.__H&&t.__H.__h.length&&(1!==l.push(t)&&r===s.options.requestAnimationFrame||((r=s.options.requestAnimationFrame)||function(e){var t,n=function(){clearTimeout(i),b&&cancelAnimationFrame(t),setTimeout(e)},i=setTimeout(n,100);b&&(t=requestAnimationFrame(n))})(y)),o=void 0},s.options.__c=function(e,t){t.some((function(e){try{e.__h.forEach(w),e.__h=e.__h.filter((function(e){return!e.__||E(e)}))}catch(r){t.some((function(e){e.__h&&(e.__h=[])})),t=[],s.options.__e(r,e.__v)}})),d&&d(e,t)},s.options.unmount=function(e){f&&f(e);var t=e.__c;if(t&&t.__H)try{t.__H.__.forEach(w)}catch(e){s.options.__e(e,t.__v)}};var b="function"==typeof requestAnimationFrame;function w(e){var t=o;"function"==typeof e.__c&&e.__c(),o=t}function E(e){var t=o;e.__c=e.__(),o=t}function O(e,t){return!e||e.length!==t.length||t.some((function(t,n){return t!==e[n]}))}function S(e,t){return"function"==typeof t?t(e):t}n.useState=g,n.useReducer=m,n.useEffect=function(e,t){var n=p(i++,3);!s.options.__s&&O(n.__H,t)&&(n.__=e,n.__H=t,o.__H.__h.push(n))},n.useLayoutEffect=_,n.useRef=function(e){return a=5,v((function(){return{current:e}}),[])},n.useImperativeHandle=function(e,t,n){a=6,_((function(){"function"==typeof e?e(t()):e&&(e.current=t())}),null==n?n:n.concat(e))},n.useMemo=v,n.useCallback=function(e,t){return a=8,v((function(){return e}),t)},n.useContext=function(e){var t=o.context[e.__c],n=p(i++,9);return n.__c=e,t?(null==n.__&&(n.__=!0,t.sub(o)),t.props.value):e.__},n.useDebugValue=function(e,t){s.options.useDebugValue&&s.options.useDebugValue(t?t(e):e)},n.useErrorBoundary=function(e){var t=p(i++,10),n=g();return t.__=e,o.componentDidCatch||(o.componentDidCatch=function(e){t.__&&t.__(e),n[1](e)}),[n[0],function(){n[1](void 0)}]}},{preact:11}],13:[function(e,t,n){var i=e("preact");function o(e,t,n,o,r){var s={};for(var a in t)"ref"!=a&&(s[a]=t[a]);var l,c,u={type:e,props:s,key:n,ref:t&&t.ref,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:++i.options.__v,__source:o,__self:r};if("function"==typeof e&&(l=e.defaultProps))for(c in l)void 0===s[c]&&(s[c]=l[c]);return i.options.vnode&&i.options.vnode(u),u}n.Fragment=i.Fragment,n.jsx=o,n.jsxs=o,n.jsxDEV=o},{preact:11}],14:[function(e,t,n){"use strict";var i=e("./lib/ReactPropTypesSecret");function o(){}function r(){}r.resetWarningCache=o,t.exports=function(){function e(e,t,n,o,r,s){if(s!==i){var a=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use PropTypes.checkPropTypes() to call them. Read more at http://fb.me/use-check-prop-types");throw a.name="Invariant Violation",a}}function t(){return e}e.isRequired=e;var n={array:e,bool:e,func:e,number:e,object:e,string:e,symbol:e,any:e,arrayOf:t,element:e,elementType:e,instanceOf:t,node:e,objectOf:t,oneOf:t,oneOfType:t,shape:t,exact:t,checkPropTypes:r,resetWarningCache:o};return n.PropTypes=n,n}},{"./lib/ReactPropTypesSecret":16}],15:[function(e,t,n){t.exports=e("./factoryWithThrowingShims")()},{"./factoryWithThrowingShims":14}],16:[function(e,t,n){"use strict";t.exports="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED"},{}],17:[function(e,t,n){var i="complete",o="canceled";function r(e,t,n){e.self===e?e.scrollTo(t,n):(e.scrollLeft=t,e.scrollTop=n)}function s(e){var t=e._scrollSettings;if(t){var n=t.maxSynchronousAlignments,o=function(e,t){var n,i,o,r,s,a,l,c=e.align,u=e.target.getBoundingClientRect(),h=c&&null!=c.left?c.left:.5,d=c&&null!=c.top?c.top:.5,f=c&&null!=c.leftOffset?c.leftOffset:0,p=c&&null!=c.topOffset?c.topOffset:0,g=h,m=d;if(e.isWindow(t))a=Math.min(u.width,t.innerWidth),l=Math.min(u.height,t.innerHeight),i=u.left+t.pageXOffset-t.innerWidth*g+a*g,o=u.top+t.pageYOffset-t.innerHeight*m+l*m,o-=p,r=(i-=f)-t.pageXOffset,s=o-t.pageYOffset;else{a=u.width,l=u.height,n=t.getBoundingClientRect();var _=u.left-(n.left-t.scrollLeft),v=u.top-(n.top-t.scrollTop);i=_+a*g-t.clientWidth*g,o=v+l*m-t.clientHeight*m,i-=f,o-=p,i=Math.max(Math.min(i,t.scrollWidth-t.clientWidth),0),o=Math.max(Math.min(o,t.scrollHeight-t.clientHeight),0),r=i-t.scrollLeft,s=o-t.scrollTop}return{x:i,y:o,differenceX:r,differenceY:s}}(t,e),a=Date.now()-t.startTime,l=Math.min(1/t.time*a,1);if(t.endIterations>=n)return r(e,o.x,o.y),e._scrollSettings=null,t.end(i);var c=1-t.ease(l);if(r(e,o.x-o.differenceX*c,o.y-o.differenceY*c),a>=t.time)return t.endIterations++,s(e);!function(e){if("requestAnimationFrame"in window)return window.requestAnimationFrame(e);setTimeout(e,16)}(s.bind(null,e))}}function a(e){return e.self===e}function l(e,t,n,i){var r,l=!t._scrollSettings,c=t._scrollSettings,u=Date.now(),h={passive:!0};function d(e){t._scrollSettings=null,t.parentElement&&t.parentElement._scrollSettings&&t.parentElement._scrollSettings.end(e),n.debug&&console.log("Scrolling ended with type",e,"for",t),i(e),r&&(t.removeEventListener("touchstart",r,h),t.removeEventListener("wheel",r,h))}c&&c.end(o);var f=n.maxSynchronousAlignments;return null==f&&(f=3),t._scrollSettings={startTime:u,endIterations:0,target:e,time:n.time,ease:n.ease,align:n.align,isWindow:n.isWindow||a,maxSynchronousAlignments:f,end:d},"cancellable"in n&&!n.cancellable||(r=d.bind(null,o),t.addEventListener("touchstart",r,h),t.addEventListener("wheel",r,h)),l&&s(t),r}function c(e){return"pageXOffset"in e||(e.scrollHeight!==e.clientHeight||e.scrollWidth!==e.clientWidth)&&"hidden"!==getComputedStyle(e).overflow}function u(){return!0}function h(e){if(e.assignedSlot)return h(e.assignedSlot);if(e.parentElement)return"BODY"===e.parentElement.tagName?e.parentElement.ownerDocument.defaultView||e.parentElement.ownerDocument.ownerWindow:e.parentElement;if(e.getRootNode){var t=e.getRootNode();if(11===t.nodeType)return t.host}}t.exports=function(e,t,n){if(e){"function"==typeof t&&(n=t,t=null),t||(t={}),t.time=isNaN(t.time)?1e3:t.time,t.ease=t.ease||function(e){return 1-Math.pow(1-e,e/2)};var o,r=h(e),s=1,a=t.validTarget||u,d=t.isScrollable;for(t.debug&&(console.log("About to scroll to",e),r||console.error("Target did not have a parent, is it mounted in the DOM?"));r;)if(t.debug&&console.log("Scrolling parent node",r),a(r,s)&&(d?d(r,c):c(r))&&(s++,o=l(e,r,t,f)),!(r=h(r))){f(i);break}return o}function f(e){--s||n&&n(e)}}},{}],18:[function(e,t,n){function i(){}i.prototype={on:function(e,t,n){var i=this.e||(this.e={});return(i[e]||(i[e]=[])).push({fn:t,ctx:n}),this},once:function(e,t,n){var i=this;function o(){i.off(e,o),t.apply(n,arguments)}return o._=t,this.on(e,o,n)},emit:function(e){for(var t=[].slice.call(arguments,1),n=((this.e||(this.e={}))[e]||[]).slice(),i=0,o=n.length;i<o;i++)n[i].fn.apply(n[i].ctx,t);return this},off:function(e,t){var n=this.e||(this.e={}),i=n[e],o=[];if(i&&t)for(var r=0,s=i.length;r<s;r++)i[r].fn!==t&&i[r].fn._!==t&&o.push(i[r]);return o.length?n[e]=o:delete n[e],this}},t.exports=i,t.exports.TinyEmitter=i},{}],19:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.Adder=n.ARROW_POINTING_UP=n.ARROW_POINTING_DOWN=void 0;var i,o=e("preact"),r=(i=e("./components/AdderToolbar"))&&i.__esModule?i:{default:i},s=e("../shared/user-agent"),a=e("./util/shadow-root"),l=e("preact/jsx-runtime");n.ARROW_POINTING_DOWN=1;function c(e){return e.toString()+"px"}n.ARROW_POINTING_UP=2;n.Adder=class{constructor(e,t){this._container=e,this._shadowRoot=(0,a.createShadowRoot)(e),Object.assign(e.style,{display:"block",position:"absolute",top:0}),this._view=e.ownerDocument.defaultView,this._width=()=>this._shadowRoot.firstChild.getBoundingClientRect().width,this._height=()=>this._shadowRoot.firstChild.getBoundingClientRect().height,this._isVisible=!1,this._arrowDirection="up",this._onAnnotate=t.onAnnotate,this._onHighlight=t.onHighlight,this._onShowAnnotations=t.onShowAnnotations,this.annotationsForSelection=[],this._render()}hide(){this._isVisible=!1,this._render()}show(e,t){const{left:n,top:i,arrowDirection:o}=this._calculateTarget(e,t);this._showAt(n,i),this._isVisible=!0,this._arrowDirection=2===o?"up":"down",this._render()}_calculateTarget(e,t){let n,i,o;n=t&&!(0,s.isTouchDevice)()?1:2;const r=Math.min(20,e.width),a=this._width(),l=(0,s.isTouchDevice)()?10:0,c=this._height();return o=t?e.left-a/2+r:e.left+e.width-a/2-r,e.top-c<0&&1===n?n=2:e.top+c>this._view.innerHeight&&(n=1),i=2===n?e.top+e.height+10+l:e.top-c-10,o=Math.max(o,0),o=Math.min(o,this._view.innerWidth-a),i=Math.max(i,0),i=Math.min(i,this._view.innerHeight-c),{top:i,left:o,arrowDirection:n}}_findZindex(e,t){if(void 0===document.elementsFromPoint)return 32768;const n=this._width(),i=this._height(),o=[...new Set([...document.elementsFromPoint(e,t),...document.elementsFromPoint(e,t+i),...document.elementsFromPoint(e+n/2,t+i/2),...document.elementsFromPoint(e+n,t),...document.elementsFromPoint(e+n,t+i)])].map((e=>+getComputedStyle(e).zIndex)).filter(Number.isInteger);return o.push(0),Math.max(...o)+1}_showAt(e,t){const n=function(e){let t=e.parentElement;for(;t.parentElement&&"static"===getComputedStyle(t).position;)t=t.parentElement;return t}(this._container).getBoundingClientRect(),i=this._findZindex(e,t);Object.assign(this._container.style,{left:c(e-n.left),top:c(t-n.top),zIndex:i})}_render(){(0,o.render)((0,l.jsx)(r.default,{isVisible:this._isVisible,arrowDirection:this._arrowDirection,onCommand:e=>{switch(e){case"annotate":this._onAnnotate(),this.hide();break;case"highlight":this._onHighlight(),this.hide();break;case"show":this._onShowAnnotations(this.annotationsForSelection)}},annotationCount:this.annotationsForSelection.length}),this._shadowRoot)}}},{"../shared/user-agent":77,"./components/AdderToolbar":29,"./util/shadow-root":58,preact:11,"preact/jsx-runtime":13}],20:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.anchor=function(e,t,n={}){let r=null,s=null,a=null;for(let i of t)switch(i.type){case"TextPositionSelector":r=i,n.hint=r.start;break;case"TextQuoteSelector":s=i;break;case"RangeSelector":a=i}const l=e=>{var t;if(null!==(t=s)&&void 0!==t&&t.exact&&e.toString()!==s.exact)throw new Error("quote mismatch");return e};let c=Promise.reject("unable to anchor");return a&&(c=c.catch((()=>o(i.RangeAnchor.fromSelector(e,a),n).then(l)))),r&&(c=c.catch((()=>o(i.TextPositionAnchor.fromSelector(e,r),n).then(l)))),s&&(c=c.catch((()=>o(i.TextQuoteAnchor.fromSelector(e,s),n)))),c},n.describe=function(e,t){const n=[i.RangeAnchor,i.TextPositionAnchor,i.TextQuoteAnchor],o=[];for(let i of n)try{const n=i.fromRange(e,t);o.push(n.toSelector())}catch(r){continue}return o};var i=e("./types");async function o(e,t={}){return e.toRange(t)}},{"./types":24}],21:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.matchQuote=function(e,t,n={}){if(0===t.length)return null;const i=Math.min(256,t.length/2),o=r(e,t,i);if(0===o.length)return null;const a=i=>{const o=1-i.errors/t.length,r=n.prefix?s(e.slice(i.start-n.prefix.length,i.start),n.prefix):1,a=n.suffix?s(e.slice(i.end,i.end+n.suffix.length),n.suffix):1;let l=1;return"number"==typeof n.hint&&(l=1-Math.abs(i.start-n.hint)/e.length),(50*o+20*r+20*a+2*l)/92},l=o.map((e=>({start:e.start,end:e.end,score:a(e)})));return l.sort(((e,t)=>t.score-e.score)),l[0]};var i,o=(i=e("approx-string-match"))&&i.__esModule?i:{default:i};function r(e,t,n){let i=0,r=[];for(;-1!==i;)i=e.indexOf(t,i),-1!==i&&(r.push({start:i,end:i+t.length,errors:0}),i+=1);return r.length>0?r:(0,o.default)(e,t,n)}function s(e,t){return 0===t.length?0:1-r(e,t,t.length)[0].errors/t.length}},{"approx-string-match":5}],22:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.documentHasText=async function(){const e=u();let t=!1;for(let n=0;n<e.pagesCount;n++)if((await d(n)).trim().length>0){t=!0;break}return t},n.anchor=function(e,t){const n=t.find((e=>"TextPositionSelector"===e.type)),i=t.find((e=>"TextQuoteSelector"===e.type));let o=Promise.reject("unable to anchor");return n&&(o=o.catch((()=>p(n.start).then((({index:e,offset:t,textContent:o})=>{const r=n.start-t,s=n.end-t,a=s-r;return(e=>{if(i&&i.exact!==e.toString())throw new Error("quote mismatch")})(o.substr(r,a)),g(e,r,s)}))))),i&&(o=o.catch((()=>{var e;if(n&&l[i.exact]&&l[i.exact][n.start]){const{pageIndex:e,anchor:t}=l[i.exact][n.start];return g(e,t.start,t.end)}return function(e){const t=u().pagesCount,n=Array(t).fill(0).map(((e,t)=>t));return e?p(e).then((({index:e})=>function(e){const t=n.slice(0,e),i=n.slice(e),o=[];for(;t.length>0||i.length>0;)i.length&&o.push(i.shift()),t.length&&o.push(t.pop());return o}(e))):Promise.resolve(n)}(null!==(e=null==n?void 0:n.start)&&void 0!==e?e:0).then((e=>m(e,i,n)))}))),o},n.describe=async function(e,t){try{t=r.TextRange.fromRange(t).toRange()}catch(h){throw new Error("Selection does not contain text")}const n=c(t.startContainer),i=c(t.endContainer);if(!n||!i)throw new Error("Selection is outside page text");if(n!==i)throw new Error("Selecting across page breaks is not supported");const o=r.TextPosition.fromPoint(t.startContainer,t.startOffset).relativeTo(n),a=r.TextPosition.fromPoint(t.endContainer,t.endOffset).relativeTo(i),l=function(e){let t=0;for(;e.previousSibling;)++t,e=e.previousSibling;return t}(n.parentNode),u=await f(l);return[{type:"TextPositionSelector",start:u+o.offset,end:u+a.offset},s.TextQuoteAnchor.fromRange(e,t).toSelector()]},n.purgeCache=function(){a={},l={}};var i,o=(i=e("../pdfjs-rendering-states"))&&i.__esModule?i:{default:i},r=e("./text-range"),s=e("./types");let a={},l={};function c(e){var t;const n="closest"in e?e:e.parentElement;return null!==(t=null==n?void 0:n.closest(".textLayer"))&&void 0!==t?t:null}function u(){return PDFViewerApplication.pdfViewer}async function h(e){const t=u();let n=t.getPageView(e);return n&&n.pdfPage||(n=await new Promise((n=>{const i=()=>{t.eventBus?t.eventBus.off("pagesloaded",i):document.removeEventListener("pagesloaded",i),n(t.getPageView(e))};t.eventBus?t.eventBus.on("pagesloaded",i):document.addEventListener("pagesloaded",i)}))),n}async function d(e){return a[e]||(a[e]=(async e=>{const t=await h(e);return(await t.pdfPage.getTextContent({normalizeWhitespace:!0})).items.filter((e=>/\S/.test(e.str))).map((e=>e.str)).join("")})(e)),a[e]}function f(e){let t=-1;const n=i=>(++t,t===e?Promise.resolve(i):d(t).then((e=>n(i+e.length))));return n(0)}function p(e){let t=0,n=0;const i=o=>{const r=u().pagesCount-1;return n+o.length>e||t===r?(e=n,Promise.resolve({index:t,offset:e,textContent:o})):(++t,n+=o.length,d(t).then(i))};return d(0).then(i)}async function g(e,t,n){const i=await h(e);if(i.renderingState===o.default.FINISHED&&i.textLayer&&i.textLayer.renderingDone){const e=i.textLayer.textLayerDiv,o=new r.TextPosition(e,t),s=new r.TextPosition(e,n);return new r.TextRange(o,s).toRange()}let s=i.div.querySelector(".annotator-placeholder");s||(s=document.createElement("span"),s.classList.add("annotator-placeholder"),s.textContent="Loading annotations",i.div.appendChild(s));const a=document.createRange();return a.setStartBefore(s),a.setEndAfter(s),a}function m(e,t,n){if(0===e.length)return Promise.reject(new Error("Quote not found"));const[i,...o]=e,r=d(i),a=f(i);return Promise.all([r,a]).then((([e,i])=>{const o=document.createElement("div");o.textContent=e;const r=s.TextQuoteAnchor.fromSelector(o,t);if(n){let t=n.start-i;return t=Math.max(0,t),t=Math.min(t,e.length),r.toPositionAnchor({hint:t})}return r.toPositionAnchor()})).then((e=>(n&&(l[t.exact]||(l[t.exact]={}),l[t.exact][n.start]={pageIndex:i,anchor:e}),g(i,e.start,e.end)))).catch((()=>m(o,t,n)))}},{"../pdfjs-rendering-states":46,"./text-range":23,"./types":24}],23:[function(e,t,n){"use strict";function i(e){switch(e.nodeType){case Node.ELEMENT_NODE:case Node.TEXT_NODE:return e.textContent.length;default:return 0}}function o(e){let t=e.previousSibling,n=0;for(;t;)n+=i(t),t=t.previousSibling;return n}function r(e,...t){let n=t.shift();const i=e.ownerDocument.createNodeIterator(e,NodeFilter.SHOW_TEXT),o=[];let r,s=i.nextNode(),a=0;for(;void 0!==n&&s;)r=s,a+r.data.length>n?(o.push({node:r,offset:n-a}),n=t.shift()):(s=i.nextNode(),a+=r.data.length);for(;void 0!==n&&r&&a===n;)o.push({node:r,offset:r.data.length}),n=t.shift();if(void 0!==n)throw new RangeError("Offset exceeds text length");return o}Object.defineProperty(n,"__esModule",{value:!0}),n.TextRange=n.TextPosition=n.RESOLVE_BACKWARDS=n.RESOLVE_FORWARDS=void 0;n.RESOLVE_FORWARDS=1;n.RESOLVE_BACKWARDS=2;class s{constructor(e,t){if(t<0)throw new Error("Offset is invalid");this.element=e,this.offset=t}relativeTo(e){if(!e.contains(this.element))throw new Error("Parent is not an ancestor of current element");let t=this.element,n=this.offset;for(;t!==e;)n+=o(t),t=t.parentElement;return new s(t,n)}resolve(e={}){try{return r(this.element,this.offset)[0]}catch(t){if(0===this.offset&&void 0!==e.direction){const n=document.createTreeWalker(this.element.getRootNode(),NodeFilter.SHOW_TEXT);n.currentNode=this.element;const i=1===e.direction,o=i?n.nextNode():n.previousNode();if(!o)throw t;return{node:o,offset:i?0:o.data.length}}throw t}}static fromCharOffset(e,t){switch(e.nodeType){case Node.TEXT_NODE:return s.fromPoint(e,t);case Node.ELEMENT_NODE:return new s(e,t);default:throw new Error("Node is not an element or text node")}}static fromPoint(e,t){switch(e.nodeType){case Node.TEXT_NODE:{if(t<0||t>e.data.length)throw new Error("Text node offset is out of range");if(!e.parentElement)throw new Error("Text node has no parent");const n=o(e)+t;return new s(e.parentElement,n)}case Node.ELEMENT_NODE:{if(t<0||t>e.childNodes.length)throw new Error("Child node offset is out of range");let n=0;for(let o=0;o<t;o++)n+=i(e.childNodes[o]);return new s(e,n)}default:throw new Error("Point is not in an element or text node")}}}n.TextPosition=s;class a{constructor(e,t){this.start=e,this.end=t}relativeTo(e){return new a(this.start.relativeTo(e),this.end.relativeTo(e))}toRange(){let e,t;this.start.element===this.end.element&&this.start.offset<=this.end.offset?[e,t]=r(this.start.element,this.start.offset,this.end.offset):(e=this.start.resolve({direction:1}),t=this.end.resolve({direction:2}));const n=new Range;return n.setStart(e.node,e.offset),n.setEnd(t.node,t.offset),n}static fromRange(e){const t=s.fromPoint(e.startContainer,e.startOffset),n=s.fromPoint(e.endContainer,e.endOffset);return new a(t,n)}static fromOffsets(e,t,n){return new a(new s(e,t),new s(e,n))}}n.TextRange=a},{}],24:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.TextQuoteAnchor=n.TextPositionAnchor=n.RangeAnchor=void 0;var i=e("./match-quote"),o=e("./text-range"),r=e("./xpath");function s(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function a(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?s(Object(n),!0).forEach((function(t){l(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):s(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class c{constructor(e,t){this.root=e,this.range=t}static fromRange(e,t){return new c(e,t)}static fromSelector(e,t){const n=(0,r.nodeFromXPath)(t.startContainer,e);if(!n)throw new Error("Failed to resolve startContainer XPath");const i=(0,r.nodeFromXPath)(t.endContainer,e);if(!i)throw new Error("Failed to resolve endContainer XPath");const s=o.TextPosition.fromCharOffset(n,t.startOffset),a=o.TextPosition.fromCharOffset(i,t.endOffset),l=new o.TextRange(s,a).toRange();return new c(e,l)}toRange(){return this.range}toSelector(){const e=o.TextRange.fromRange(this.range).toRange(),t=o.TextRange.fromRange(e),n=(0,r.xpathFromNode)(t.start.element,this.root),i=(0,r.xpathFromNode)(t.end.element,this.root);return{type:"RangeSelector",startContainer:n,startOffset:t.start.offset,endContainer:i,endOffset:t.end.offset}}}n.RangeAnchor=c;class u{constructor(e,t,n){this.root=e,this.start=t,this.end=n}static fromRange(e,t){const n=o.TextRange.fromRange(t).relativeTo(e);return new u(e,n.start.offset,n.end.offset)}static fromSelector(e,t){return new u(e,t.start,t.end)}toSelector(){return{type:"TextPositionSelector",start:this.start,end:this.end}}toRange(){return o.TextRange.fromOffsets(this.root,this.start,this.end).toRange()}}n.TextPositionAnchor=u;class h{constructor(e,t,n={}){this.root=e,this.exact=t,this.context=n}static fromRange(e,t){const n=e.textContent,i=o.TextRange.fromRange(t).relativeTo(e),r=i.start.offset,s=i.end.offset;return new h(e,n.slice(r,s),{prefix:n.slice(Math.max(0,r-32),r),suffix:n.slice(s,Math.min(n.length,s+32))})}static fromSelector(e,t){const{prefix:n,suffix:i}=t;return new h(e,t.exact,{prefix:n,suffix:i})}toSelector(){return{type:"TextQuoteSelector",exact:this.exact,prefix:this.context.prefix,suffix:this.context.suffix}}toRange(e={}){return this.toPositionAnchor(e).toRange()}toPositionAnchor(e={}){const t=this.root.textContent,n=(0,i.matchQuote)(t,this.exact,a(a({},this.context),{},{hint:e.hint}));if(!n)throw new Error("Quote not found");return new u(this.root,n.start,n.end)}}n.TextQuoteAnchor=h},{"./match-quote":21,"./text-range":23,"./xpath":25}],25:[function(e,t,n){"use strict";function i(e){return`${function(e){const t=e.nodeName.toLowerCase();let n=t;return"#text"===t&&(n="text()"),n}(e)}[${function(e){let t=0,n=e;for(;n;)n.nodeName===e.nodeName&&(t+=1),n=n.previousSibling;return t}(e)}]`}function o(e,t,n){t=t.toUpperCase();let i=-1;for(let o=0;o<e.children.length;o++){const r=e.children[o];if(r.nodeName.toUpperCase()===t&&(++i,i===n))return r}return null}Object.defineProperty(n,"__esModule",{value:!0}),n.xpathFromNode=function(e,t){let n="",o=e;for(;o!==t;){if(!o)throw new Error("Node is not a descendant of root");n=i(o)+"/"+n,o=o.parentNode}return n="/"+n,n=n.replace(/\/$/,""),n},n.nodeFromXPath=function(e,t=document.body){try{return function(e,t){if(null===e.match(/^(\/[A-Za-z0-9-]+(\[[0-9]+\])?)+$/))throw new Error("Expression is not a simple XPath");const n=e.split("/");let i=t;n.shift();for(let r of n){let e,t;const n=r.indexOf("[");if(-1!==n){e=r.slice(0,n);const i=r.slice(n+1,r.indexOf("]"));if(t=parseInt(i)-1,t<0)return null}else e=r,t=0;const s=o(i,e,t);if(!s)return null;i=s}return i}(e,t)}catch(n){return document.evaluate("."+e,t,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue}}},{}],26:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){t.on(o.default.PUBLIC_ANNOTATION_COUNT_CHANGED,(function(t){const n=e.querySelectorAll("[data-hypothesis-annotation-count]");Array.from(n).forEach((function(e){e.textContent=t}))}))};var i,o=(i=e("../shared/bridge-events"))&&i.__esModule?i:{default:i}},{"../shared/bridge-events":71}],27:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=class{constructor(e,t){this.bridge=e,this.cache={},this._on=t.on,this._emit=t.emit,this.bridge.on("deleteAnnotation",((e,t)=>{const n=this._parse(e);delete this.cache[n.$tag],this._emit("annotationDeleted",n),t(null,this._format(n))})),this.bridge.on("loadAnnotations",((e,t)=>{const n=e.map((e=>this._parse(e)));this._emit("annotationsLoaded",n),t(null,n)})),this._on("beforeAnnotationCreated",(e=>{e.$tag||this.bridge.call("beforeCreateAnnotation",this._format(e))}))}sync(e){this.bridge.call("sync",e.map((e=>this._format(e))))}_tag(e,t){return e.$tag||(t=t||window.btoa(Math.random().toString()),Object.defineProperty(e,"$tag",{value:t}),this.cache[t]=e),e}_parse(e){const t=Object.assign(this.cache[e.tag]||{},e.msg);return this._tag(t,e.tag)}_format(e){return this._tag(e),{tag:e.$tag,msg:e}}}},{}],28:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=e("preact"),r=(i=e("./components/Buckets"))&&i.__esModule?i:{default:i},s=e("./util/buckets"),a=e("preact/jsx-runtime");n.default=class{constructor(e,t,n={}){var i;this.options=n,this.element=document.createElement("div"),this.guest=t,e.appendChild(this.element),this.updateFunc=()=>this.update(),window.addEventListener("resize",this.updateFunc),window.addEventListener("scroll",this.updateFunc),null===(i=this.options.scrollables)||void 0===i||i.forEach((e=>{const t=document.querySelector(e);null==t||t.addEventListener("scroll",this.updateFunc)})),this._update()}destroy(){var e;window.removeEventListener("resize",this.updateFunc),window.removeEventListener("scroll",this.updateFunc),null===(e=this.options.scrollables)||void 0===e||e.forEach((e=>{const t=document.querySelector(e);null==t||t.removeEventListener("scroll",this.updateFunc)}))}update(){this._updatePending||(this._updatePending=!0,requestAnimationFrame((()=>{this._update(),this._updatePending=!1})))}_update(){const e=(0,s.anchorBuckets)(this.guest.anchors);(0,o.render)((0,a.jsx)(r.default,{above:e.above,below:e.below,buckets:e.buckets,onSelectAnnotations:(e,t)=>this.guest.selectAnnotations(e,t)}),this.element)}}},{"./components/Buckets":30,"./util/buckets":56,preact:11,"preact/jsx-runtime":13}],29:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var i=l(e("classnames")),o=e("@hypothesis/frontend-shared"),r=l(e("prop-types")),s=e("../../shared/shortcut"),a=e("preact/jsx-runtime");function l(e){return e&&e.__esModule?e:{default:e}}function c({badgeCount:e,icon:t,label:n,onClick:i,shortcut:r}){(0,s.useShortcut)(r,i);const l=r?`${n} (${r})`:n;return(0,a.jsxs)("button",{className:"AdderToolbar__button",onClick:i,"aria-label":l,title:l,children:[t&&(0,a.jsx)(o.SvgIcon,{name:t,className:"AdderToolbar__icon"}),"number"==typeof e&&(0,a.jsx)("span",{className:"AdderToolbar__badge",children:e}),(0,a.jsx)("span",{className:"AdderToolbar__label",children:n})]})}function u({arrowDirection:e,isVisible:t,onCommand:n,annotationCount:r=0}){const s=(e,t)=>{e.preventDefault(),e.stopPropagation(),n(t)},l=t?"a":null,u=t?"h":null,h=t?"s":null;return(0,a.jsxs)("div",{className:(0,i.default)("AdderToolbar",{"AdderToolbar--down":"up"===e,"AdderToolbar--up":"down"===e,"is-active":t}),style:{visibility:t?"visible":"hidden"},children:[(0,a.jsxs)("div",{className:"AdderToolbar__actions",children:[(0,a.jsx)(c,{icon:"annotate",onClick:e=>s(e,"annotate"),label:"Annotate",shortcut:l}),(0,a.jsx)(c,{icon:"highlight",onClick:e=>s(e,"highlight"),label:"Highlight",shortcut:u}),r>0&&(0,a.jsx)("div",{className:"AdderToolbar__separator"}),r>0&&(0,a.jsx)(c,{badgeCount:r,onClick:e=>s(e,"show"),label:"Show",shortcut:h})]}),(0,a.jsx)(o.SvgIcon,{name:"pointer",inline:!0,className:(0,i.default)("AdderToolbar__arrow",{"AdderToolbar__arrow--down":"down"===e,"AdderToolbar__arrow--up":"up"===e})})]})}c.propTypes={badgeCount:r.default.number,icon:r.default.string,label:r.default.string.isRequired,onClick:r.default.func.isRequired,shortcut:r.default.string},u.propTypes={arrowDirection:r.default.oneOf(["up","down"]).isRequired,isVisible:r.default.bool.isRequired,onCommand:r.default.func.isRequired,annotationCount:r.default.number}},{"../../shared/shortcut":75,"@hypothesis/frontend-shared":4,classnames:6,"preact/jsx-runtime":13,"prop-types":15}],30:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=d;var i=c(e("classnames")),o=c(e("prop-types")),r=c(e("scroll-into-view")),s=e("../highlighter"),a=e("../util/buckets"),l=e("preact/jsx-runtime");function c(e){return e&&e.__esModule?e:{default:e}}function u({bucket:e,onSelectAnnotations:t}){const n=e.anchors.map((e=>e.annotation)),i=`Select nearby annotations (${e.anchors.length})`;function o(t){e.anchors.forEach((e=>{(0,s.setHighlightsFocused)(e.highlights||[],t)}))}return(0,l.jsx)("button",{className:"Buckets__button Buckets__button--left",onClick:e=>function(e){e.stopPropagation(),t(n,e.metaKey||e.ctrlKey)}(e),onMouseMove:()=>o(!0),onMouseOut:()=>o(!1),onBlur:()=>o(!1),title:i,"aria-label":i,children:e.anchors.length})}function h({bucket:e,direction:t}){const n=`Go ${t} to next annotations (${e.anchors.length})`;return(0,l.jsx)("button",{className:(0,i.default)("Buckets__button",`Buckets__button--${t}`),onClick:n=>function(n){var i;n.stopPropagation();const o=(0,a.findClosestOffscreenAnchor)(e.anchors,t);null!=o&&null!==(i=o.highlights)&&void 0!==i&&i.length&&(0,r.default)(o.highlights[0])}(n),title:n,"aria-label":n,children:e.anchors.length})}function d({above:e,below:t,buckets:n,onSelectAnnotations:i}){const o=e.anchors.length>0,r=t.anchors.length>0;return(0,l.jsxs)("ul",{className:"Buckets__list",children:[o&&(0,l.jsx)("li",{className:"Buckets__bucket",style:{top:e.position},children:(0,l.jsx)(h,{bucket:e,direction:"up"})}),n.map(((e,t)=>(0,l.jsx)("li",{className:"Buckets__bucket",style:{top:e.position},children:(0,l.jsx)(u,{bucket:e,onSelectAnnotations:i})},t))),r&&(0,l.jsx)("li",{className:"Buckets__bucket",style:{top:t.position},children:(0,l.jsx)(h,{bucket:t,direction:"down"})})]})}u.propTypes={bucket:o.default.object.isRequired,onSelectAnnotations:o.default.func.isRequired},h.propTypes={bucket:o.default.object.isRequired,direction:o.default.string},d.propTypes={above:o.default.object.isRequired,below:o.default.object.isRequired,buckets:o.default.array.isRequired,onSelectAnnotations:o.default.func.isRequired}},{"../highlighter":41,"../util/buckets":56,classnames:6,"preact/jsx-runtime":13,"prop-types":15,"scroll-into-view":17}],31:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=l;var i,o=e("@hypothesis/frontend-shared"),r=(i=e("prop-types"))&&i.__esModule?i:{default:i},s=e("preact/jsx-runtime");function a({buttonRef:e,expanded:t,className:n="Toolbar__button",label:i,icon:r,onClick:a,selected:l=!1}){return(0,s.jsx)("button",{className:n,"aria-label":i,"aria-expanded":t,"aria-pressed":l,onClick:e=>{e.stopPropagation(),a()},ref:e,title:i,children:(0,s.jsx)(o.SvgIcon,{name:r})})}function l({closeSidebar:e,createAnnotation:t,isSidebarOpen:n,newAnnotationType:i,showHighlights:o,toggleHighlights:r,toggleSidebar:l,toggleSidebarRef:c,useMinimalControls:u=!1}){return(0,s.jsxs)("div",{className:"Toolbar",children:[u&&n&&(0,s.jsx)(a,{className:"Toolbar__sidebar-close",label:"Close annotation sidebar",icon:"cancel",onClick:e}),!u&&(0,s.jsx)(a,{className:"Toolbar__sidebar-toggle",buttonRef:c,label:"Annotation sidebar",icon:n?"caret-right":"caret-left",expanded:n,onClick:l}),!u&&(0,s.jsxs)("div",{className:"Toolbar__buttonbar",children:[(0,s.jsx)(a,{label:"Show highlights",icon:o?"show":"hide",selected:o,onClick:r}),(0,s.jsx)(a,{label:"note"===i?"New page note":"New annotation",icon:"note"===i?"note":"annotate",onClick:t})]})]})}a.propTypes={buttonRef:r.default.any,expanded:r.default.bool,className:r.default.string,label:r.default.string.isRequired,icon:r.default.string.isRequired,onClick:r.default.func.isRequired,selected:r.default.bool},l.propTypes={closeSidebar:r.default.func.isRequired,createAnnotation:r.default.func.isRequired,isSidebarOpen:r.default.bool.isRequired,newAnnotationType:r.default.oneOf(["annotation","note"]).isRequired,showHighlights:r.default.bool.isRequired,toggleHighlights:r.default.func.isRequired,toggleSidebar:r.default.func.isRequired,toggleSidebarRef:r.default.any,useMinimalControls:r.default.bool}},{"@hypothesis/frontend-shared":4,"preact/jsx-runtime":13,"prop-types":15}],32:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){if(!e.hasOwnProperty("hypothesisConfig"))return{};if("function"!=typeof e.hypothesisConfig){const e="https://h.readthedocs.io/projects/client/en/latest/publishers/config/#window.hypothesisConfig";return console.warn("hypothesisConfig must be a function, see: "+e),{}}return e.hypothesisConfig()}},{}],33:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=(0,o.default)(e);return{annotations:t.annotations,assetRoot:t.hostPageSetting("assetRoot",{allowInBrowserExt:!0}),branding:t.hostPageSetting("branding"),clientUrl:t.clientUrl,enableExperimentalNewNoteButton:t.hostPageSetting("enableExperimentalNewNoteButton"),experimental:t.hostPageSetting("experimental",{defaultValue:{}}),group:t.group,focus:t.hostPageSetting("focus"),theme:t.hostPageSetting("theme"),usernameUrl:t.hostPageSetting("usernameUrl"),onLayoutChange:t.hostPageSetting("onLayoutChange"),openSidebar:t.hostPageSetting("openSidebar",{allowInBrowserExt:!0,coerce:r.toBoolean}),query:t.query,requestConfigFromFrame:t.hostPageSetting("requestConfigFromFrame"),services:t.hostPageSetting("services"),showHighlights:t.showHighlights,notebookAppUrl:t.notebookAppUrl,sidebarAppUrl:t.sidebarAppUrl,subFrameIdentifier:t.hostPageSetting("subFrameIdentifier",{allowInBrowserExt:!0}),externalContainerSelector:t.hostPageSetting("externalContainerSelector")}};var i,o=(i=e("./settings"))&&i.__esModule?i:{default:i},r=e("../../shared/type-coercions")},{"../../shared/type-coercions":76,"./settings":35}],34:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){return!(e.startsWith("http://")||e.startsWith("https://"))}},{}],35:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e){const t=(0,i.parseJsonConfig)(e.document),n=(0,o.default)(e);function s(t){const n=e.document.querySelector(`link[type="application/annotator+html"][rel="${t}"]`);if(!n)throw new Error(`No application/annotator+html (rel="${t}") link in the document`);if(!n.href)throw new Error(`application/annotator+html (rel="${t}") link has no href`);return n.href}function a(e,i={}){const o=i.allowInBrowserExt||!1,a=void 0!==i.defaultValue,l="function"==typeof i.coerce?i.coerce:e=>e;return!o&&(0,r.default)(s("sidebar"))?a?i.defaultValue:null:n.hasOwnProperty(e)?l(n[e]):t.hasOwnProperty(e)?l(t[e]):a?i.defaultValue:null}return{get annotations(){return t.annotations||function(){const t=e.location.href.match(/#annotations:([A-Za-z0-9_-]+)$/);return t?t[1]:null}()},get clientUrl(){return function(){const t=e.document.querySelector('link[type="application/annotator+javascript"][rel="hypothesis-client"]');if(!t)throw new Error('No application/annotator+javascript (rel="hypothesis-client") link in the document');if(!t.href)throw new Error('application/annotator+javascript (rel="hypothesis-client") link has no href');return t.href}()},get group(){return t.group||function(){const t=e.location.href.match(/#annotations:group:([A-Za-z0-9_-]+)$/);return t?t[1]:null}()},get notebookAppUrl(){return s("notebook")},get showHighlights(){return function(){let e=a("showHighlights");return null===e&&(e="always"),"boolean"==typeof e?e?"always":"never":e}()},get sidebarAppUrl(){return s("sidebar")},get query(){return t.query||function(){const t=e.location.href.match(/#annotations:(query|q):(.+)$/i);if(t)try{return decodeURIComponent(t[2])}catch(n){}return null}()},hostPageSetting:a}};var i=e("../../boot/parse-json-config"),o=s(e("./config-func-settings-from")),r=s(e("./is-browser-extension"));function s(e){return e&&e.__esModule?e:{default:e}}},{"../../boot/parse-json-config":60,"./config-func-settings-from":32,"./is-browser-extension":34}],36:[function(e,t,n){"use strict";function i(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}Object.defineProperty(n,"__esModule",{value:!0}),n.createSidebarConfig=function(e){var t;const n=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?i(Object(n),!0).forEach((function(t){o(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):i(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},e);if((null===(t=n.services)||void 0===t?void 0:t.length)>0){const e=n.services[0];e.onLoginRequest&&(e.onLoginRequestProvided=!0),e.onLogoutRequest&&(e.onLogoutRequestProvided=!0),e.onSignupRequest&&(e.onSignupRequestProvided=!0),e.onProfileRequest&&(e.onProfileRequestProvided=!0),e.onHelpRequest&&(e.onHelpRequestProvided=!0)}return["notebookAppUrl","sidebarAppUrl"].forEach((e=>delete n[e])),n}},{}],37:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("tiny-emitter");function o(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function r(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.default=class{constructor(e,t){this.options=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?o(Object(n),!0).forEach((function(t){r(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):o(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({},t),this.element=e;const n=e;let s=n._hypothesisEventBus;s||(s=new i.TinyEmitter,n._hypothesisEventBus=s),this._eventBus=s,this._subscriptions=[]}destroy(){for(let[e,t]of this._subscriptions)this._eventBus.off(e,t)}publish(e,t=[]){this._eventBus.emit(e,...t)}subscribe(e,t){this._eventBus.on(e,t),this._subscriptions.push([e,t])}unsubscribe(e,t){this._eventBus.off(e,t),this._subscriptions=this._subscriptions.filter((([n,i])=>n!==e||i!==t))}}},{"tiny-emitter":18}],38:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=r(e("../shared/bridge-events")),o=r(e("../shared/warn-once"));function r(e){return e&&e.__esModule?e:{default:e}}let s={};const a=e=>{s=e||{}};var l={init:function(e){e.on(i.default.FEATURE_FLAGS_UPDATED,a)},reset:function(){a({})},flagEnabled:function(e){return e in s?s[e]:((0,o.default)("looked up unknown feature",e),!1)}};n.default=l},{"../shared/bridge-events":71,"../shared/warn-once":78}],39:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.DEBOUNCE_WAIT=void 0;var i,o=(i=e("lodash.debounce"))&&i.__esModule?i:{default:i},r=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=s();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("./util/frame-util"));function s(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return s=function(){return e},e}n.DEBOUNCE_WAIT=40;n.default=class{constructor(e){this._target=e,this._handledFrames=[],this._mutationObserver=new MutationObserver((0,o.default)((()=>{this._discoverFrames()}),40))}observe(e,t){this._onFrameAdded=e,this._onFrameRemoved=t,this._discoverFrames(),this._mutationObserver.observe(this._target,{childList:!0,subtree:!0})}disconnect(){this._mutationObserver.disconnect()}_addFrame(e){r.isAccessible(e)&&r.isDocumentReady(e,(()=>{e.contentWindow.addEventListener("unload",(()=>{this._removeFrame(e)})),this._handledFrames.push(e),this._onFrameAdded(e)}))}_removeFrame(e){this._onFrameRemoved(e),this._handledFrames=this._handledFrames.filter((t=>t!==e))}_discoverFrames(){let e=r.findFrames(this._target);for(let t of e)this._handledFrames.includes(t)||this._addFrame(t);for(let t of((e,t)=>e.filter((e=>!t.includes(e))))(this._handledFrames,e))this._removeFrame(t)}}},{"./util/frame-util":57,"lodash.debounce":9}],40:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=_(e("scroll-into-view")),o=_(e("./delegator")),r=e("./adder"),s=_(e("./plugin/cross-frame")),a=_(e("./plugin/document")),l=_(e("./plugin/pdf")),c=m(e("./anchoring/html")),u=e("./anchoring/text-range"),h=e("./highlighter"),d=m(e("./range-util")),f=e("./selection-observer"),p=e("./util/url");function g(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return g=function(){return e},e}function m(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=g();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}function _(e){return e&&e.__esModule?e:{default:e}}function v(e){return(0,h.getHighlightsContainingNode)(e).map((e=>e._annotation)).filter((e=>void 0!==e))}function y(e){if(!e.range)return null;try{return e.range.toRange()}catch(t){return null}}class b extends o.default{constructor(e,t={},n=c){super(e,t),this.visibleHighlights=!1,this.adderToolbar=document.createElement("hypothesis-adder"),this.adderToolbar.style.display="none",this.element.appendChild(this.adderToolbar),this.adderCtrl=new r.Adder(this.adderToolbar,{onAnnotate:()=>{this.createAnnotation(),document.getSelection().removeAllRanges()},onHighlight:()=>{this.setVisibleHighlights(!0),this.createHighlight(),document.getSelection().removeAllRanges()},onShowAnnotations:e=>{this.selectAnnotations(e)}}),this.selectionObserver=new f.SelectionObserver((e=>{e?this._onSelection(e):this._onClearSelection()})),this.anchors=[],this.anchoring=n,this.documentMeta=new a.default(this.element),"pdf"===t.documentType&&(this.pdfIntegration=new l.default(this.element,this)),this.frameIdentifier=t.subFrameIdentifier||null,this.crossframe=new s.default(this.element,{config:t,on:(e,t)=>this.subscribe(e,t),emit:(e,...t)=>this.publish(e,t)}),this.crossframe.onConnect((()=>this._setupInitialState(t))),this.closeSidebarOnDocumentClick=!0,this._connectAnnotationSync(),this._connectAnnotationUISync(this.crossframe),this._elementEventListeners=[],this._setupElementEvents()}_setupElementEvents(){const e=(e,t)=>{this.element.addEventListener(e,t),this._elementEventListeners.push({event:e,callback:t})},t=e=>{var t;this.closeSidebarOnDocumentClick&&!this.isEventInAnnotator(e)&&(null===(t=this.crossframe)||void 0===t||t.call("closeSidebar"))};e("click",(e=>{const n=v(e.target);if(n.length&&this.visibleHighlights){const t=e.metaKey||e.ctrlKey;this.selectAnnotations(n,t)}else t(e)})),e("touchstart",(e=>{v(e.target).length||t(e)})),e("mouseover",(e=>{const t=v(e.target);t.length&&this.visibleHighlights&&this.focusAnnotations(t)})),e("mouseout",(()=>{this.visibleHighlights&&this.focusAnnotations([])}))}_removeElementEvents(){this._elementEventListeners.forEach((({event:e,callback:t})=>{this.element.removeEventListener(e,t)}))}getDocumentInfo(){let e,t;return this.pdfIntegration?(e=this.pdfIntegration.getMetadata(),t=this.pdfIntegration.uri()):(t=Promise.resolve(this.documentMeta.uri()),e=Promise.resolve(this.documentMeta.metadata)),t=t.catch((()=>decodeURIComponent(window.location.href))),e=e.catch((()=>({title:document.title,link:[{href:decodeURIComponent(window.location.href)}]}))),Promise.all([e,t]).then((([e,t])=>({uri:(0,p.normalizeURI)(t),metadata:e,frameIdentifier:this.frameIdentifier})))}_setupInitialState(e){this.publish("panelReady"),this.setVisibleHighlights("always"===e.showHighlights)}_connectAnnotationSync(){this.subscribe("annotationDeleted",(e=>{this.detach(e)})),this.subscribe("annotationsLoaded",(e=>{e.map((e=>this.anchor(e)))}))}_connectAnnotationUISync(e){e.on("focusAnnotations",((e=[])=>{for(let t of this.anchors)if(t.highlights){const n=e.includes(t.annotation.$tag);(0,h.setHighlightsFocused)(t.highlights,n)}})),e.on("scrollToAnnotation",(e=>{for(let t of this.anchors)if(t.highlights&&t.annotation.$tag===e){const e=y(t);if(!e)continue;const n=new CustomEvent("scrolltorange",{bubbles:!0,cancelable:!0,detail:e});this.element.dispatchEvent(n)&&(0,i.default)(t.highlights[0])}})),e.on("getDocumentInfo",(e=>{this.getDocumentInfo().then((t=>e(null,t))).catch((t=>e(t)))})),e.on("setVisibleHighlights",(e=>{this.setVisibleHighlights(e)}))}destroy(){var e;this._removeElementEvents(),this.selectionObserver.disconnect(),this.adderToolbar.remove(),(0,h.removeAllHighlights)(this.element),this.documentMeta.destroy(),null===(e=this.pdfIntegration)||void 0===e||e.destroy(),super.destroy()}anchor(e){let t;const n=this.element,i=[],o=[];let r=[];e.target||(e.target=[]);const s=t=>t.selector&&t.selector.some((e=>"TextQuoteSelector"===e.type))?this.anchoring.anchor(n,t.selector).then((n=>({annotation:e,target:t,range:u.TextRange.fromRange(n)}))).catch((()=>({annotation:e,target:t}))):Promise.resolve({annotation:e,target:t}),a=e=>{const t=y(e);if(!t)return e;const n=(0,h.highlightRange)(t);return n.forEach((t=>{t._annotation=e.annotation})),e.highlights=n,e};for(t of this.anchors.splice(0,this.anchors.length))t.annotation===e?t.range&&e.target.includes(t.target)?(i.push(t),o.push(t.target)):t.highlights&&(r=r.concat(t.highlights),delete t.highlights,delete t.range):this.anchors.push(t);(0,h.removeHighlights)(r);for(let l of e.target)o.includes(l)||(t=s(l).then(a),i.push(t));return Promise.all(i).then((t=>{let n=!1,i=!1;for(let e of t)if(e.target.selector&&(n=!0,e.range)){i=!0;break}return e.$orphan=n&&!i,this._updateAnchors(this.anchors.concat(t)),this.crossframe.sync([e]),t}))}detach(e){const t=[];let n=[];for(let o of this.anchors){var i;o.annotation===e?n.push(...null!==(i=o.highlights)&&void 0!==i?i:[]):t.push(o)}(0,h.removeHighlights)(n),this._updateAnchors(t)}_updateAnchors(e){this.anchors=e,this.publish("anchorsChanged",[this.anchors])}createAnnotation(e={}){var t;const n=this.element,i=null!==(t=this.selectedRanges)&&void 0!==t?t:[];this.selectedRanges=null;const o=this.getDocumentInfo();o.then((t=>{e.document=t.metadata,e.uri=t.uri}));const r=Promise.all(i.map((e=>this.anchoring.describe(n,e)))),s=Promise.all([o,r]).then((([t,n])=>{const i=t.uri;e.target=n.map((e=>({source:i,selector:e})))}));var a;return s.then((()=>this.publish("beforeAnnotationCreated",[e]))),s.then((()=>this.anchor(e))),e.$highlight||null===(a=this.crossframe)||void 0===a||a.call("openSidebar"),e}createHighlight(){return this.createAnnotation({$highlight:!0})}showAnnotations(e){var t,n;const i=e.map((e=>e.$tag));null===(t=this.crossframe)||void 0===t||t.call("showAnnotations",i),null===(n=this.crossframe)||void 0===n||n.call("openSidebar")}toggleAnnotationSelection(e){var t;const n=e.map((e=>e.$tag));null===(t=this.crossframe)||void 0===t||t.call("toggleAnnotationSelection",n)}focusAnnotations(e){var t;const n=e.map((e=>e.$tag));null===(t=this.crossframe)||void 0===t||t.call("focusAnnotations",n)}_onSelection(e){const t=document.getSelection(),n=d.isSelectionBackwards(t),i=d.selectionFocusRect(t);i?(this.selectedRanges=[e],this.publish("hasSelectionChanged",[!0]),this.adderCtrl.annotationsForSelection=function(){const e=window.getSelection().getRangeAt(0);return d.itemsForRange(e,(e=>e._annotation))}(),this.adderCtrl.show(i,n)):this._onClearSelection()}_onClearSelection(){this.adderCtrl.hide(),this.selectedRanges=[],this.publish("hasSelectionChanged",[!1])}selectAnnotations(e,t=!1){t?this.toggleAnnotationSelection(e):this.showAnnotations(e)}isEventInAnnotator(e){return null!==e.target.closest(".annotator-frame")}setVisibleHighlights(e){(0,h.setHighlightsVisible)(this.element,e),this.visibleHighlights=e,this.publish("highlightsVisibleChanged",[e])}}n.default=b},{"./adder":19,"./anchoring/html":20,"./anchoring/text-range":23,"./delegator":37,"./highlighter":41,"./plugin/cross-frame":47,"./plugin/document":48,"./plugin/pdf":50,"./range-util":51,"./selection-observer":52,"./util/url":59,"scroll-into-view":17}],41:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.highlightRange=function(e,t="hypothesis-highlight"){const n=function(e){if(e.collapsed)return[];let t=e.commonAncestorContainer;if(t.nodeType!==Node.ELEMENT_NODE&&(t=t.parentElement),!t)return[];const n=[],o=t.ownerDocument.createNodeIterator(t,NodeFilter.SHOW_TEXT);let r;for(;r=o.nextNode();){if(!(0,i.isNodeInRange)(e,r))continue;let t=r;t===e.startContainer&&e.startOffset>0?t.splitText(e.startOffset):(t===e.endContainer&&e.endOffset<t.data.length&&t.splitText(e.endOffset),n.push(t))}return n}(e),r=n.length>0&&null!==n[0].parentNode.closest(".annotator-placeholder");let s=[],a=null,l=null;n.forEach((e=>{a&&a.nextSibling===e?l.push(e):(l=[e],s.push(l)),a=e}));const c=/^\s*$/;s=s.filter((e=>e.some((e=>!c.test(e.nodeValue)))));const u=[];return s.forEach((e=>{const n=document.createElement("hypothesis-highlight");if(n.className=t,e[0].parentNode.replaceChild(n,e[0]),e.forEach((e=>n.appendChild(e))),!r){const e=function(e){const t=function(e){const t=e.closest(".page");if(!t)return null;return t.querySelector(".canvasWrapper > canvas")||null}(e);if(!t||!t.parentElement)return null;let n=t.parentElement.querySelector(".hypothesis-highlight-layer");const i=CSS.supports("mix-blend-mode","multiply");if(!n){n=document.createElementNS(o,"svg"),n.setAttribute("class","hypothesis-highlight-layer"),t.parentElement.appendChild(n),t.parentElement.style.position="relative";const e=n.style;e.position="absolute",e.left="0",e.top="0",e.width="100%",e.height="100%",i?e.mixBlendMode="multiply":e.opacity="0.3"}const r=t.getBoundingClientRect(),s=e.getBoundingClientRect(),a=document.createElementNS(o,"rect");return a.setAttribute("x",(s.left-r.left).toString()),a.setAttribute("y",(s.top-r.top).toString()),a.setAttribute("width",s.width.toString()),a.setAttribute("height",s.height.toString()),i?a.setAttribute("class","hypothesis-svg-highlight"):a.setAttribute("class","hypothesis-svg-highlight is-opaque"),n.appendChild(a),a}(n);e&&(n.className+=" is-transparent",n.svgHighlight=e)}u.push(n)})),u},n.removeAllHighlights=function(e){s(Array.from(e.querySelectorAll("hypothesis-highlight")))},n.removeHighlights=s,n.setHighlightsFocused=function(e,t){e.forEach((e=>e.classList.toggle("hypothesis-highlight-focused",t)))},n.setHighlightsVisible=function(e,t){e.classList.toggle("hypothesis-highlights-always-on",t)},n.getHighlightsContainingNode=function(e){let t=e.nodeType===Node.ELEMENT_NODE?e:e.parentElement;const n=[];for(;t;)t.classList.contains("hypothesis-highlight")&&n.push(t),t=t.parentElement;return n},n.getBoundingClientRect=function(e){return e.map((e=>e.getBoundingClientRect())).reduce(((e,t)=>({top:Math.min(e.top,t.top),left:Math.min(e.left,t.left),bottom:Math.max(e.bottom,t.bottom),right:Math.max(e.right,t.right)})))};var i=e("./range-util");const o="http://www.w3.org/2000/svg";function r(e,t){const n=e.parentNode;t.forEach((t=>n.insertBefore(t,e))),e.remove()}function s(e){for(let t of e)t.parentNode&&r(t,Array.from(t.childNodes)),t.svgHighlight&&t.svgHighlight.remove()}},{"./range-util":51}],42:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={annotate:e("../images/icons/annotate.svg"),cancel:e("../images/icons/cancel.svg"),caution:e("../images/icons/caution.svg"),"caret-left":e("../images/icons/caret-left.svg"),"caret-right":e("../images/icons/caret-right.svg"),hide:e("../images/icons/hide.svg"),highlight:e("../images/icons/highlight.svg"),note:e("../images/icons/note.svg"),pointer:e("../images/icons/pointer.svg"),show:e("../images/icons/show.svg")};n.default=i},{"../images/icons/annotate.svg":61,"../images/icons/cancel.svg":62,"../images/icons/caret-left.svg":63,"../images/icons/caret-right.svg":64,"../images/icons/caution.svg":65,"../images/icons/hide.svg":66,"../images/icons/highlight.svg":67,"../images/icons/note.svg":68,"../images/icons/pointer.svg":69,"../images/icons/show.svg":70}],43:[function(e,t,n){"use strict";e("focus-visible");var i=e("@hypothesis/frontend-shared"),o=u(e("./icons")),r=u(e("./config/index")),s=u(e("./guest")),a=u(e("./notebook")),l=u(e("./pdf-sidebar")),c=u(e("./sidebar"));function u(e){return e&&e.__esModule?e:{default:e}}(0,i.registerIcons)(o.default);const h=window,d=document.querySelector('link[type="application/annotator+html"][rel="sidebar"]'),f=(0,r.default)(window);new Promise((e=>{"loading"!==document.readyState&&e(),document.addEventListener("readystatechange",(()=>e()))})).then((function(){const e=void 0!==h.PDFViewerApplication;let t=e?l.default:c.default;f.subFrameIdentifier&&(t=null,h.__hypothesis_frame=!0),f.documentType=e?"pdf":"html";const n=new s.default(document.body,f),i=t?new t(document.body,n,f):null,o=new a.default(document.body,f);d.addEventListener("destroy",(()=>{null==i||i.destroy(),o.destroy(),n.destroy(),document.querySelectorAll("[data-hypothesis-asset]").forEach((e=>e.remove()))}))}))},{"./config/index":33,"./guest":40,"./icons":42,"./notebook":44,"./pdf-sidebar":45,"./sidebar":54,"@hypothesis/frontend-shared":4,"focus-visible":7}],44:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=c(e("./delegator")),o=e("./config/sidebar"),r=e("./util/shadow-root"),s=e("preact"),a=c(e("../sidebar/components/Button")),l=e("preact/jsx-runtime");function c(e){return e&&e.__esModule?e:{default:e}}class u extends i.default{constructor(e,t){super(e,t),this.frame=null,this._groupId=null,this._prevGroupId=null,this._outerContainer=document.createElement("hypothesis-notebook"),this.element.appendChild(this._outerContainer),this.container=null,this.subscribe("openNotebook",(e=>{this._groupId=e,this.open()}))}_update(){const e=this._initContainer(),t=!this.frame||!this._prevGroupId||this._prevGroupId!==this._groupId;var n;this._prevGroupId=this._groupId,t&&(null===(n=this.frame)||void 0===n||n.remove(),this.frame=function(e,t){const n=(0,o.createSidebarConfig)(e);n.group=t;const i="config="+encodeURIComponent(JSON.stringify(n)),r=e.notebookAppUrl+"#"+i,s=document.createElement("iframe");return s.setAttribute("allowfullscreen",""),s.src=r,s.title="Hypothesis annotation notebook",s.className="notebook-inner",s}(this.options,this._groupId),e.appendChild(this.frame))}open(){const e=this._initContainer();this._update(),e.classList.add("is-open"),e.style.display="",this.originalOverflowStyle=this.element.style.overflow,this.element.style.overflow="hidden"}close(){this.container&&(this.container.classList.remove("is-open"),this.container.style.display="none"),this.element.style.overflow=this.originalOverflowStyle}destroy(){this._outerContainer.remove()}_initContainer(){if(this.container)return this.container;const e=(0,r.createShadowRoot)(this._outerContainer);this.container=document.createElement("div"),this.container.style.display="none",this.container.className="notebook-outer",e.appendChild(this.container);const t=e=>{e.stopPropagation(),this.close(),this.publish("closeNotebook")};return(0,s.render)((0,l.jsx)("div",{className:"Notebook__controller-bar",onTouchStart:t,children:(0,l.jsx)(a.default,{icon:"cancel",className:"Notebook__close-button",buttonText:"Close",title:"Close the Notebook",onClick:t})}),this.container),this.container}}n.default=u},{"../sidebar/components/Button":79,"./config/sidebar":36,"./delegator":37,"./util/shadow-root":58,preact:11,"preact/jsx-runtime":13}],45:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=e("./sidebar"))&&i.__esModule?i:{default:i};function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){a(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function a(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}const l={BucketBar:{scrollables:["#viewerContainer"]}};class c extends o.default{constructor(e,t,n={}){var i,o,r;super(e,t,s(s({},l),n)),this._lastSidebarLayoutState={expanded:!1,width:0,height:0},this.window=window,this.pdfViewer=null===(i=this.window.PDFViewerApplication)||void 0===i?void 0:i.pdfViewer,this.pdfContainer=null===(o=this.window.PDFViewerApplication)||void 0===o||null===(r=o.appConfig)||void 0===r?void 0:r.appContainer,this.sideBySideActive=!1,this.subscribe("sidebarLayoutChanged",(e=>this.fitSideBySide(e))),this._registerEvent(window,"resize",(()=>this.fitSideBySide()))}activateSideBySide(e){this.sideBySideActive=!0,this.guest.closeSidebarOnDocumentClick=!1,this.pdfContainer.style.width=e+"px",this.pdfContainer.classList.add("hypothesis-side-by-side")}deactivateSideBySide(){this.sideBySideActive=!1,this.guest.closeSidebarOnDocumentClick=!0,this.pdfContainer.style.width="auto",this.pdfContainer.classList.remove("hypothesis-side-by-side")}fitSideBySide(e){e||(e=this._lastSidebarLayoutState);const t=this.window.innerWidth-e.width;e.expanded&&t>=680?this.activateSideBySide(t):this.deactivateSideBySide();const n=this.pdfViewer.currentScaleValue;"auto"!==n&&"page-fit"!==n&&"page-width"!==n||(this.pdfViewer.currentScaleValue=n),this.pdfViewer.update(),this._lastSidebarLayoutState=e}}n.default=c},{"./sidebar":54}],46:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i={INITIAL:0,RUNNING:1,PAUSED:2,FINISHED:3};n.default=i},{}],47:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=u(e("../annotation-sync")),o=u(e("../../shared/bridge")),r=u(e("../delegator")),s=u(e("../../shared/discovery")),a=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=c();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../util/frame-util")),l=u(e("../frame-observer"));function c(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return c=function(){return e},e}function u(e){return e&&e.__esModule?e:{default:e}}function h(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function d(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?h(Object(n),!0).forEach((function(t){f(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):h(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function f(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}class p extends r.default{constructor(e,t){super(e,t);const{config:n,server:r,on:c,emit:u}=t,h=new s.default(window,{server:r}),f=new o.default,p=new i.default(f,{on:c,emit:u}),g=new l.default(e),m=new Map;h.startDiscovery(((e,t,n)=>f.createChannel(e,t,n))),g.observe((e=>{if(a.hasHypothesis(e))return;const{clientUrl:t}=n;a.isLoaded(e,(()=>{const i=h.generateToken();m.set(e,i);const o=d(d({},n),{},{subFrameIdentifier:i});a.injectHypothesis(e,t,o)}))}),(e=>{f.call("destroyFrame",m.get(e)),m.delete(e)})),this.destroy=()=>{f.destroy(),h.stopDiscovery(),g.disconnect(),super.destroy()},this.sync=e=>p.sync(e),this.on=(e,t)=>f.on(e,t),this.call=(e,...t)=>f.call(e,...t),this.onConnect=e=>f.onConnect(e)}}n.default=p},{"../../shared/bridge":72,"../../shared/discovery":73,"../annotation-sync":27,"../delegator":37,"../frame-observer":39,"../util/frame-util":57}],48:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=e("../delegator"))&&i.__esModule?i:{default:i},r=e("../util/url");function s(){return{title:document.title,link:[],dc:{},eprints:{},facebook:{},highwire:{},prism:{},twitter:{}}}class a extends o.default{constructor(e,t={}){super(e,t),this.metadata=s(),this.baseURI=t.baseURI||document.baseURI,this.document=t.document||document,this.normalizeURI=t.normalizeURI||r.normalizeURI,this.getDocumentMetadata()}uri(){let e=decodeURIComponent(this._getDocumentHref());for(let t of this.metadata.link)"canonical"===t.rel&&(e=t.href);return e}uris(){const e={};for(let t of this.metadata.link)t.href&&(e[t.href]=!0);return Object.keys(e)}getDocumentMetadata(){return this.metadata=s(),this._getHighwire(),this._getDublinCore(),this._getFacebook(),this._getEprints(),this._getPrism(),this._getTwitter(),this._getFavicon(),this._getTitle(),this._getLinks(),this.metadata}_getHighwire(){this.metadata.highwire=this._getMetaTags("citation","name","_")}_getFacebook(){this.metadata.facebook=this._getMetaTags("og","property",":")}_getTwitter(){this.metadata.twitter=this._getMetaTags("twitter","name",":")}_getDublinCore(){this.metadata.dc=this._getMetaTags("dc","name",".")}_getPrism(){this.metadata.prism=this._getMetaTags("prism","name",".")}_getEprints(){this.metadata.eprints=this._getMetaTags("eprints","name",".")}_getMetaTags(e,t,n){const i={};for(let o of Array.from(this.document.querySelectorAll("meta"))){const r=o.getAttribute(t),{content:s}=o;if(r){const t=r.match(RegExp(`^${e}${n}(.+)$`,"i"));if(t){const e=t[1];i[e]?i[e].push(s):i[e]=[s]}}}return i}_getTitle(){this.metadata.highwire.title?this.metadata.title=this.metadata.highwire.title[0]:this.metadata.eprints.title?this.metadata.title=this.metadata.eprints.title[0]:this.metadata.prism.title?this.metadata.title=this.metadata.prism.title[0]:this.metadata.facebook.title?this.metadata.title=this.metadata.facebook.title[0]:this.metadata.twitter.title?this.metadata.title=this.metadata.twitter.title[0]:this.metadata.dc.title?this.metadata.title=this.metadata.dc.title[0]:this.metadata.title=this.document.title}_getLinks(){this.metadata.link=[{href:this._getDocumentHref()}];const e=Array.from(this.document.querySelectorAll("link"));for(let o of e)if(["alternate","canonical","bookmark","shortlink"].includes(o.rel)){if("alternate"===o.rel){if(o.type&&o.type.match(/^application\/(rss|atom)\+xml/))continue;if(o.hreflang)continue}try{const e=this._absoluteUrl(o.href);this.metadata.link.push({href:e,rel:o.rel,type:o.type})}catch(i){}}for(let o of Object.keys(this.metadata.highwire)){const e=this.metadata.highwire[o];if("pdf_url"===o)for(let t of e)try{this.metadata.link.push({href:this._absoluteUrl(t),type:"application/pdf"})}catch(i){}if("doi"===o)for(let t of e)"doi:"!==t.slice(0,4)&&(t=`doi:${t}`),this.metadata.link.push({href:t})}for(let o of Object.keys(this.metadata.dc)){const e=this.metadata.dc[o];if("identifier"===o)for(let t of e)"doi:"===t.slice(0,4)&&this.metadata.link.push({href:t})}const t=this.metadata.dc["relation.ispartof"],n=this.metadata.dc.identifier;if(t&&n){const e=t[t.length-1],i=n[n.length-1],o="urn:x-dc:"+encodeURIComponent(e)+"/"+encodeURIComponent(i);this.metadata.link.push({href:o}),this.metadata.documentFingerprint=o}}_getFavicon(){for(let e of Array.from(this.document.querySelectorAll("link")))if(["shortcut icon","icon"].includes(e.rel))try{this.metadata.favicon=this._absoluteUrl(e.href)}catch(i){}}_absoluteUrl(e){return this.normalizeURI(e,this.baseURI)}_getDocumentHref(){const{href:e}=this.document.location,t=["http:","https:","file:"],n=new URL(e).protocol;return t.includes(n)?e:this.baseURI&&t.includes(new URL(this.baseURI).protocol)?this.baseURI:e}}n.default=a},{"../delegator":37,"../util/url":59}],49:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("../util/url");function o(e){return"urn:x-pdf:"+String(e)}function r(e){const t=(0,i.normalizeURI)(e.url);return 0!==t.indexOf("file://")?t:null}n.default=class{constructor(e){this._loaded=function(e){return e.initializedPromise?e.initializedPromise:e.initialized?Promise.resolve():new Promise((t=>{const n=setInterval((()=>{e.initialized&&(clearTimeout(n),t())}),5)}))}(e).then((()=>e.downloadComplete?e:new Promise((t=>{const n=()=>{e.eventBus?(e.eventBus.off("documentload",n),e.eventBus.off("documentloaded",n)):window.removeEventListener("documentload",n),t(e)};e.eventBus?(e.eventBus.on("documentloaded",n),e.eventBus.on("documentload",n)):window.addEventListener("documentload",n)}))))}getUri(){return this._loaded.then((e=>{let t=r(e);return t||(t=o(e.pdfDocument.fingerprint)),t}))}getMetadata(){return this._loaded.then((e=>{let t=document.title;e.metadata&&e.metadata.has("dc:title")&&"Untitled"!==e.metadata.get("dc:title")?t=e.metadata.get("dc:title"):e.documentInfo&&e.documentInfo.Title&&(t=e.documentInfo.Title);const n=[{href:o(e.pdfDocument.fingerprint)}],i=r(e);return i&&n.push({href:i}),{title:t,link:n,documentFingerprint:e.pdfDocument.fingerprint}}))}}},{"../util/url":59}],50:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i=e("@hypothesis/frontend-shared"),o=d(e("lodash.debounce")),r=e("preact"),s=function(e){if(e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var t=h();if(t&&t.has(e))return t.get(e);var n={},i=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if(Object.prototype.hasOwnProperty.call(e,o)){var r=i?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(n,o,r):n[o]=e[o]}return n.default=e,t&&t.set(e,n),n}(e("../anchoring/pdf")),a=d(e("../delegator")),l=d(e("../pdfjs-rendering-states")),c=d(e("./pdf-metadata")),u=e("preact/jsx-runtime");function h(){if("function"!=typeof WeakMap)return null;var e=new WeakMap;return h=function(){return e},e}function d(e){return e&&e.__esModule?e:{default:e}}function f(){return(0,u.jsxs)(u.Fragment,{children:[(0,u.jsx)("div",{className:"annotator-pdf-warning-banner__type",children:(0,u.jsx)(i.SvgIcon,{name:"caution",className:"annotator-pdf-warning-banner__icon"})}),(0,u.jsxs)("div",{className:"annotator-pdf-warning-banner__message",children:[(0,u.jsx)("strong",{children:"This PDF does not contain selectable text:"})," ",(0,u.jsx)("a",{target:"_blank",rel:"noreferrer",href:"https://web.hypothes.is/help/how-to-ocr-optimize-pdfs/",children:"Learn how to fix this"})," ","in order to annotate with Hypothesis."]})]})}class p extends a.default{constructor(e,t){super(e),this.annotator=t,t.anchoring=s;const n=window;this.pdfViewer=n.PDFViewerApplication.pdfViewer,this.pdfViewer.viewer.classList.add("has-transparent-text-layer"),this.pdfMetadata=new c.default(n.PDFViewerApplication),this.observer=new MutationObserver((0,o.default)((()=>this._update()),100)),this.observer.observe(this.pdfViewer.viewer,{attributes:!0,attributeFilter:["data-loaded"],childList:!0,subtree:!0}),this._warningBanner=null,this._checkForSelectableText(),this._updateAnnotationLayerVisibility=()=>{const e=n.getSelection();this.pdfViewer.viewer.classList.toggle("is-selecting",!e.isCollapsed)},document.addEventListener("selectionchange",this._updateAnnotationLayerVisibility)}destroy(){document.removeEventListener("selectionchange",this._updateAnnotationLayerVisibility),this.pdfViewer.viewer.classList.remove("has-transparent-text-layer"),this.observer.disconnect()}uri(){return this.pdfMetadata.getUri()}getMetadata(){return this.pdfMetadata.getMetadata()}async _checkForSelectableText(){try{await this.uri()}catch(e){return}try{const e=await s.documentHasText();this._showNoSelectableTextWarning(!e)}catch(t){console.warn("Unable to check for text in PDF:",t)}}_showNoSelectableTextWarning(e){var t;if(!e)return null===(t=this._warningBanner)||void 0===t||t.remove(),void(this._warningBanner=null);const n=document.querySelector("#mainContainer"),i=()=>{if(!this._warningBanner)return;const e=this._warningBanner.getBoundingClientRect();n.style.top=e.height+"px",this._warningBanner.style.top=-e.height+"px"};this._warningBanner=document.createElement("div"),this._warningBanner.className="annotator-pdf-warning-banner annotator-pdf-warning-banner--notice",n.appendChild(this._warningBanner),(0,r.render)((0,u.jsx)(f,{}),this._warningBanner),"undefined"!=typeof ResizeObserver&&new ResizeObserver(i).observe(this._warningBanner),i()}_update(){const e=[],t=this.pdfViewer.pagesCount;for(let i=0;i<t;i++){var n;const e=this.pdfViewer.getPageView(i);if(null!==(n=e.textLayer)&&void 0!==n&&n.renderingDone)switch(e.renderingState){case l.default.INITIAL:e.textLayer=null;break;case l.default.FINISHED:{const t=e.div.querySelector(".annotator-placeholder");null==t||t.parentNode.removeChild(t)}}}for(let i of this.annotator.anchors)if(i.highlights){if(e.includes(i.annotation))continue;for(let t=0;t<i.highlights.length;t++){const n=i.highlights[t];if(!document.body.contains(n)){i.highlights.splice(t,1),delete i.range,e.push(i.annotation);break}}}e.map((e=>this.annotator.anchor(e)))}}n.default=p},{"../anchoring/pdf":22,"../delegator":37,"../pdfjs-rendering-states":46,"./pdf-metadata":49,"@hypothesis/frontend-shared":4,"lodash.debounce":9,preact:11,"preact/jsx-runtime":13}],51:[function(e,t,n){"use strict";function i(e){return e.focusNode===e.anchorNode?e.focusOffset<e.anchorOffset:e.getRangeAt(0).startContainer===e.focusNode}function o(e,t){try{var n,i;const o=null!==(n=null===(i=t.nodeValue)||void 0===i?void 0:i.length)&&void 0!==n?n:t.childNodes.length;return e.comparePoint(t,0)<=0&&e.comparePoint(t,o)>=0}catch(o){return!1}}function r(e,t){const n=e.commonAncestorContainer,i=n.ownerDocument.createNodeIterator(n,NodeFilter.SHOW_ALL);let r;for(;r=i.nextNode();)o(e,r)&&t(r)}function s(e){const t=/^\s*$/,n=[];r(e,(function(e){e.nodeType!==Node.TEXT_NODE||e.textContent.match(t)||n.push(e)}));let i=[];return n.forEach((function(t){const n=t.ownerDocument.createRange();if(n.selectNodeContents(t),t===e.startContainer&&n.setStart(t,e.startOffset),t===e.endContainer&&n.setEnd(t,e.endOffset),n.collapsed)return;const o=Array.from(n.getClientRects());n.detach(),i=i.concat(o)})),i}Object.defineProperty(n,"__esModule",{value:!0}),n.isSelectionBackwards=i,n.isNodeInRange=o,n.forEachNodeInRange=r,n.getTextBoundingBoxes=s,n.selectionFocusRect=function(e){if(e.isCollapsed)return null;const t=s(e.getRangeAt(0));return 0===t.length?null:i(e)?t[0]:t[t.length-1]},n.itemsForRange=function(e,t){const n=new Set,i=new Set;return r(e,(e=>{let o=e;for(;o&&!n.has(o);){n.add(o);const e=t(o);e&&i.add(e),o=o.parentNode}})),[...i]}},{}],52:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.SelectionObserver=void 0;n.SelectionObserver=class{constructor(e,t=document){let n=!1;this._pendingCallback=null;const i=(n=10)=>{this._pendingCallback=setTimeout((()=>{e(function(e){const t=e.getSelection();if(!t||0===t.rangeCount)return null;const n=t.getRangeAt(0);return n.collapsed?null:n}(t))}),n)};this._eventHandler=e=>{if("mousedown"===e.type&&(n=!0),"mouseup"===e.type&&(n=!1),n)return;this._cancelPendingCallback();const t="mouseup"===e.type?10:100;i(t)},this._document=t,this._events=["mousedown","mouseup","selectionchange"];for(let o of this._events)t.addEventListener(o,this._eventHandler);i(1)}disconnect(){for(let e of this._events)this._document.removeEventListener(e,this._eventHandler);this._cancelPendingCallback()}_cancelPendingCallback(){this._pendingCallback&&(clearTimeout(this._pendingCallback),this._pendingCallback=null)}}},{}],53:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=function(e,t){const n=e.querySelectorAll("[data-hypothesis-trigger]");function i(e){t(),e.stopPropagation()}Array.from(n).forEach((function(e){e.addEventListener("click",i)}))}},{}],54:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=n.MIN_RESIZE=void 0;var i=f(e("hammerjs")),o=f(e("./annotation-counts")),r=f(e("./sidebar-trigger")),s=e("./config/sidebar"),a=f(e("../shared/bridge-events")),l=f(e("./features")),c=f(e("./delegator")),u=e("./toolbar"),h=e("./util/shadow-root"),d=f(e("./bucket-bar"));function f(e){return e&&e.__esModule?e:{default:e}}n.MIN_RESIZE=280;class p extends c.default{constructor(e,t,n={}){if(super(e,n),this.iframe=function(e){const t=(0,s.createSidebarConfig)(e),n="config="+encodeURIComponent(JSON.stringify(t)),i=e.sidebarAppUrl+"#"+n,o=document.createElement("iframe");return o.setAttribute("allowfullscreen",""),o.src=i,o.title="Hypothesis annotation viewer",o.className="h-sidebar-iframe",o}(n),this.bucketBar=null,n.externalContainerSelector){var i;this.externalFrame=null!==(i=document.querySelector(n.externalContainerSelector))&&void 0!==i?i:e,this.externalFrame.appendChild(this.iframe)}else{if(this.iframeContainer=document.createElement("div"),this.iframeContainer.style.display="none",this.iframeContainer.className="annotator-frame","clean"===n.theme)this.iframeContainer.classList.add("annotator-frame--theme-clean");else{const e=new d.default(this.iframeContainer,t,n.BucketBar);t.subscribe("anchorsChanged",(()=>e.update())),this.bucketBar=e}this.iframeContainer.appendChild(this.iframe),this.hypothesisSidebar=document.createElement("hypothesis-sidebar"),(0,h.createShadowRoot)(this.hypothesisSidebar).appendChild(this.iframeContainer),e.appendChild(this.hypothesisSidebar)}this.guest=t,this.registeredListeners=[],this.subscribe("panelReady",(()=>{this.iframeContainer&&(this.iframeContainer.style.display="")})),this.subscribe("beforeAnnotationCreated",(e=>{e.$highlight||this.iframe.contentWindow.focus()})),(n.openSidebar||n.annotations||n.query||n.group)&&this.subscribe("panelReady",(()=>this.open()));const o=document.createElement("div");this.toolbar=new u.ToolbarController(o,{createAnnotation:()=>t.createAnnotation(),setSidebarOpen:e=>e?this.open():this.close(),setHighlightsVisible:e=>this.setAllVisibleHighlights(e)}),"clean"===n.theme?this.toolbar.useMinimalControls=!0:this.toolbar.useMinimalControls=!1,this.subscribe("highlightsVisibleChanged",(e=>{this.toolbar.highlightsVisible=e})),this.subscribe("hasSelectionChanged",(e=>{this.toolbar.newAnnotationType=e?"annotation":"note"})),this.iframeContainer?(this.iframeContainer.prepend(o),this.toolbarWidth=this.toolbar.getWidth()):this.toolbarWidth=0,this._registerEvent(window,"resize",(()=>this._onResize())),this._gestureState={initial:null,final:null},this._setupGestures(),this.close();const[r]=n.services||[];r&&(this.onLoginRequest=r.onLoginRequest,this.onLogoutRequest=r.onLogoutRequest,this.onSignupRequest=r.onSignupRequest,this.onProfileRequest=r.onProfileRequest,this.onHelpRequest=r.onHelpRequest),this.onLayoutChange=n.onLayoutChange,this._notifyOfLayoutChange(!1),this._setupSidebarEvents()}destroy(){var e,t;null===(e=this.bucketBar)||void 0===e||e.destroy(),this._unregisterEvents(),null===(t=this._hammerManager)||void 0===t||t.destroy(),this.hypothesisSidebar?this.hypothesisSidebar.remove():this.iframe.remove(),super.destroy()}_registerEvent(e,t,n){e.addEventListener(t,n),this.registeredListeners.push({eventTarget:e,eventType:t,listener:n})}_unregisterEvents(){this.registeredListeners.forEach((({eventTarget:e,eventType:t,listener:n})=>{e.removeEventListener(t,n)})),this.registeredListeners=[]}_setupSidebarEvents(){(0,o.default)(document.body,this.guest.crossframe),(0,r.default)(document.body,(()=>this.open())),l.default.init(this.guest.crossframe),this.guest.crossframe.on("openSidebar",(()=>this.open())),this.guest.crossframe.on("closeSidebar",(()=>this.close())),this.guest.crossframe.on("openNotebook",(e=>{this.hide(),this.publish("openNotebook",[e])})),this.subscribe("closeNotebook",(()=>{this.show()})),[[a.default.LOGIN_REQUESTED,this.onLoginRequest],[a.default.LOGOUT_REQUESTED,this.onLogoutRequest],[a.default.SIGNUP_REQUESTED,this.onSignupRequest],[a.default.PROFILE_REQUESTED,this.onProfileRequest],[a.default.HELP_REQUESTED,this.onHelpRequest]].forEach((([e,t])=>{t&&this.guest.crossframe.on(e,(()=>t()))}))}_resetGestureState(){this._gestureState={initial:null,final:null}}_setupGestures(){const e=this.toolbar.sidebarToggleButton;e&&(this._registerEvent(e,"touchmove",(e=>e.preventDefault())),this._hammerManager=new i.default.Manager(e).on("panstart panend panleft panright",(e=>this._onPan(e))),this._hammerManager.add(new i.default.Pan({direction:i.default.DIRECTION_HORIZONTAL})))}_updateLayout(){this.renderFrame||(this.renderFrame=requestAnimationFrame((()=>{if(this.renderFrame=null,this._gestureState.final!==this._gestureState.initial&&this.iframeContainer){const e=this._gestureState.final,t=-e;this.iframeContainer.style.marginLeft=`${e}px`,t>=280&&(this.iframeContainer.style.width=`${t}px`),this._notifyOfLayoutChange()}})))}_notifyOfLayoutChange(e){var t;const n=this.iframeContainer&&this.toolbar.getWidth()||0,i=null!==(t=this.iframeContainer)&&void 0!==t?t:this.externalFrame,o=i.getBoundingClientRect(),r=window.getComputedStyle(i),s=parseInt(r.width),a=parseInt(r.marginLeft);let l=n;"boolean"==typeof e?e&&(l+=s):(a<280?l-=a:l+=s,e=l>n);const c={expanded:e,width:e?l:n,height:o.height};this.onLayoutChange&&this.onLayoutChange(c),this.publish("sidebarLayoutChanged",[c])}_onResize(){!0===this.toolbar.sidebarOpen&&(window.innerWidth<280?this.close():this.open())}_onPan(e){const t=this.iframeContainer;if(t)switch(e.type){case"panstart":this._resetGestureState(),t.classList.add("annotator-no-transition"),t.style.pointerEvents="none",this._gestureState.initial=parseInt(getComputedStyle(t).marginLeft);break;case"panend":t.classList.remove("annotator-no-transition"),t.style.pointerEvents="",null===this._gestureState.final||this._gestureState.final<=-280?this.open():this.close(),this._resetGestureState();break;case"panleft":case"panright":{if("number"!=typeof this._gestureState.initial)return;const t=this._gestureState.initial,n=e.deltaX;this._gestureState.final=Math.min(Math.round(t+n),0),this._updateLayout();break}}}open(){if(this.guest.crossframe.call("sidebarOpened"),this.publish("sidebarOpened"),this.iframeContainer){const e=this.iframeContainer.getBoundingClientRect().width;this.iframeContainer.style.marginLeft=-1*e+"px",this.iframeContainer.classList.remove("annotator-collapsed")}this.toolbar.sidebarOpen=!0,"whenSidebarOpen"===this.options.showHighlights&&this.guest.setVisibleHighlights(!0),this._notifyOfLayoutChange(!0)}close(){this.iframeContainer&&(this.iframeContainer.style.marginLeft="",this.iframeContainer.classList.add("annotator-collapsed")),this.toolbar.sidebarOpen=!1,"whenSidebarOpen"===this.options.showHighlights&&this.guest.setVisibleHighlights(!1),this._notifyOfLayoutChange(!1)}setAllVisibleHighlights(e){this.guest.crossframe.call("setVisibleHighlights",e)}show(){this.iframeContainer&&this.iframeContainer.classList.remove("is-hidden")}hide(){this.iframeContainer&&this.iframeContainer.classList.add("is-hidden")}}n.default=p},{"../shared/bridge-events":71,"./annotation-counts":26,"./bucket-bar":28,"./config/sidebar":36,"./delegator":37,"./features":38,"./sidebar-trigger":53,"./toolbar":55,"./util/shadow-root":58,hammerjs:8}],55:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.ToolbarController=void 0;var i,o=e("preact"),r=(i=e("./components/Toolbar"))&&i.__esModule?i:{default:i},s=e("preact/jsx-runtime");n.ToolbarController=class{constructor(e,t){const{createAnnotation:n,setSidebarOpen:i,setHighlightsVisible:r}=t;this._container=e,this._useMinimalControls=!1,this._newAnnotationType="note",this._highlightsVisible=!1,this._sidebarOpen=!1,this._closeSidebar=()=>i(!1),this._toggleSidebar=()=>i(!this._sidebarOpen),this._toggleHighlights=()=>r(!this._highlightsVisible),this._createAnnotation=()=>{n(),i(!0)},this._sidebarToggleButton=(0,o.createRef)(),this.render()}getWidth(){return this._container.firstChild.getBoundingClientRect().width}set useMinimalControls(e){this._useMinimalControls=e,this.render()}get useMinimalControls(){return this._useMinimalControls}set sidebarOpen(e){this._sidebarOpen=e,this.render()}get sidebarOpen(){return this._sidebarOpen}set newAnnotationType(e){this._newAnnotationType=e,this.render()}get newAnnotationType(){return this._newAnnotationType}set highlightsVisible(e){this._highlightsVisible=e,this.render()}get highlightsVisible(){return this._highlightsVisible}get sidebarToggleButton(){return this._sidebarToggleButton.current}render(){(0,o.render)((0,s.jsx)(r.default,{closeSidebar:this._closeSidebar,createAnnotation:this._createAnnotation,newAnnotationType:this._newAnnotationType,isSidebarOpen:this._sidebarOpen,showHighlights:this._highlightsVisible,toggleHighlights:this._toggleHighlights,toggleSidebar:this._toggleSidebar,toggleSidebarRef:this._sidebarToggleButton,useMinimalControls:this.useMinimalControls}),this._container)}}},{"./components/Toolbar":31,preact:11,"preact/jsx-runtime":13}],56:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.findClosestOffscreenAnchor=function(e,t){let n=null,o=0;for(let s of e){var r;if(null===(r=s.highlights)||void 0===r||!r.length)continue;const e=(0,i.getBoundingClientRect)(s.highlights).top;"up"===t&&e>=137||"down"===t&&e<=window.innerHeight-22||(!n||"up"===t&&e>o||"down"===t&&e<o)&&(n=s,o=e)}return n},n.anchorBuckets=function(e){const t=function(e){const t=[];return e.forEach((e=>{var n;if(null===(n=e.highlights)||void 0===n||!n.length)return;const o=(0,i.getBoundingClientRect)(e.highlights);t.push({top:o.top,bottom:o.bottom,anchor:e})})),t.sort(((e,t)=>e.top<t.top?-1:1)),t}(e),n=new Set,o=new Set,r=[];let s=null;function a(e){const t=e.bottom-e.top,n=e.top+t/2;return{anchors:[e.anchor],top:e.top,bottom:e.bottom,position:n}}return t.forEach((e=>{if(e.top<137)return void n.add(e.anchor);if(e.top>window.innerHeight-22)return void o.add(e.anchor);if(!s)return void(s=a(e));const t=e.top>s.top&&e.bottom<s.bottom;if(e.top-s.bottom>60&&!t)r.push(s),s=a(e);else{const t=e.bottom>s.bottom?e.bottom:s.bottom,n=t-s.top;s.anchors.push(e.anchor),s.bottom=t,s.position=s.top+n/2}})),s&&r.push(s),{above:{anchors:Array.from(n),position:137},below:{anchors:Array.from(o),position:window.innerHeight-22},buckets:r}};var i=e("../highlighter")},{"../highlighter":41}],57:[function(e,t,n){"use strict";function i(e){const t=!e.classList.contains("h-sidebar-iframe"),n=e.hasAttribute("enable-annotation");return t&&n}Object.defineProperty(n,"__esModule",{value:!0}),n.findFrames=function(e){return Array.from(e.getElementsByTagName("iframe")).filter(i)},n.hasHypothesis=function(e){return!0===e.contentWindow.__hypothesis_frame},n.injectHypothesis=function(e,t,n){const i=document.createElement("script");i.className="js-hypothesis-config",i.type="application/json",i.innerText=JSON.stringify(n);const o=t,r=document.createElement("script");r.className="js-hypothesis-embed",r.async=!0,r.src=o,e.contentDocument.body.appendChild(i),e.contentDocument.body.appendChild(r)},n.isAccessible=function(e){try{return!!e.contentDocument}catch(t){return!1}},n.isDocumentReady=function(e,t){"loading"===e.contentDocument.readyState?e.contentDocument.addEventListener("DOMContentLoaded",(function(){t()})):t()},n.isLoaded=function(e,t){"complete"!==e.contentDocument.readyState?e.addEventListener("load",(function(){t()})):t()}},{}],58:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.createShadowRoot=function(e){if(!e.attachShadow)return e;const t=e.attachShadow({mode:"open"});!function(e){var t;const n=null===(t=document.querySelector('link[rel="stylesheet"][href*="/build/styles/annotator.css"]'))||void 0===t?void 0:t.href;if(!n)return;const i=document.createElement("link");i.rel="stylesheet",i.href=n,e.appendChild(i)}(t);const n=window.applyFocusVisiblePolyfill;return n&&n(t),t}},{}],59:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.normalizeURI=function(e,t=document.baseURI){return new URL(e,t).href.toString().replace(/#.*/,"")}},{}],60:[function(e,t,n){"use strict";function i(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n]);return e}Object.defineProperty(n,"__esModule",{value:!0}),n.parseJsonConfig=function(e){for(var t={},n=e.querySelectorAll("script.js-hypothesis-config"),o=0;o<n.length;o++){var r=void 0;try{r=JSON.parse(n[o].textContent||"")}catch(s){console.warn("Could not parse settings from js-hypothesis-config tags",s),r={}}i(t,r)}return t}},{}],61:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16">\n  <path fill="currentColor" fill-rule="nonzero" d="M15 0c.27 0 .505.099.703.297A.961.961 0 0116 1v15l-4-3H1a.974.974 0 01-.703-.29A.953.953 0 010 12V1C0 .719.096.482.29.29A.966.966 0 011 0h14zM7 3l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C4.156 5.229 4 6 4 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188C4.729 8.854 5.082 9 5.5 9c.417 0 .77-.146 1.063-.438C6.854 8.271 7 7.918 7 7.5c0-.417-.146-.77-.438-1.063A1.447 1.447 0 005.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L7 4V3zm5 0l-.469.063c-.312.041-.656.187-1.031.437-.375.25-.719.646-1.031 1.188C9.156 5.229 9 6 9 7l.002.063.006.062a.896.896 0 01.008.11l-.002.074-.006.066a1.447 1.447 0 00.43 1.188c.291.291.645.437 1.062.437.417 0 .77-.146 1.063-.438.291-.291.437-.645.437-1.062 0-.417-.146-.77-.438-1.063A1.447 1.447 0 0010.5 6c-.073 0-.146.005-.219.016-.073.01-.14.026-.203.046.177-1.03.542-1.632 1.094-1.804L12 4V3z"/>\n</svg>\n'},{}],62:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--cancel"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 8l3.536-3.536L8 8 4.464 4.464 8 8zm0 0l-3.536 3.536L8 8l3.536 3.536L8 8z"></path></g></svg>\n'},{}],63:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M10 12L6 8l4-4"></path></g></svg>\n'},{}],64:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16" aria-hidden="true" focusable="false" class="Icon Icon--caret-right"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 4l4 4-4 4"></path></g></svg>\n'},{}],65:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round" class="feather feather-alert-triangle"><path d="M10.29 3.86L1.82 18a2 2 0 0 0 1.71 3h16.94a2 2 0 0 0 1.71-3L13.71 3.86a2 2 0 0 0-3.42 0z"></path><line x1="12" y1="9" x2="12" y2="13"></line><line x1="12" y1="17" x2="12.01" y2="17"></line></svg>'},{}],66:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.73 12.973A9.89 9.89 0 0 1 8 13c-3.866 0-7-2.239-7-5 0-.753.233-1.467.65-2.107m5.62-2.866A9.89 9.89 0 0 1 8 3c3.866 0 7 2.239 7 5 0 .753-.233 1.467-.65 2.107M1 1l14 14L1 1z"></path></g></svg>\n'},{}],67:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M12 15H1h11zm-.5-6v2l-1 1v-2l1-1zm.5-7v6h-2V2h2zm0-1h-2 2zm0 8h-2 2z"></path></g></svg>\n'},{}],68:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M1 15h6l8-6V1H1v14zm6-1V9h7"></path></g></svg>\n'},{}],69:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="15" height="8" viewBox="0 0 15 8" aria-hidden="true" focusable="false"><path d="M0 8 L7 0 L15 8" stroke="currentColor" strokeWidth="2" /></svg>\n'},{}],70:[function(e,t,n){t.exports='<svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 16 16"><g fill-rule="evenodd"><rect fill="none" stroke="none" x="0" y="0" width="16" height="16"></rect><path fill="none" stroke="currentColor" stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8 13c3.866 0 7-2.239 7-5s-3.134-5-7-5-7 2.239-7 5 3.134 5 7 5zm0-4a1 1 0 1 0 0-2 1 1 0 0 0 0 2z"></path></g></svg>\n'},{}],71:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default={FEATURE_FLAGS_UPDATED:"featureFlagsUpdated",HELP_REQUESTED:"helpRequested",LOGIN_REQUESTED:"loginRequested",LOGOUT_REQUESTED:"logoutRequested",PROFILE_REQUESTED:"profileRequested",PUBLIC_ANNOTATION_COUNT_CHANGED:"publicAnnotationCountChanged",SIGNUP_REQUESTED:"signupRequested"}},{}],72:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;var i,o=(i=e("./frame-rpc"))&&i.__esModule?i:{default:i};function r(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.default=class{constructor(){this.links=[],this.channelListeners={},this.onConnectListeners=[]}destroy(){Array.from(this.links).map((e=>e.channel.destroy()))}createChannel(e,t,n){let i=null,a=!1;const l=()=>{a||(a=!0,Array.from(this.onConnectListeners).forEach((t=>t.call(null,i,e))))},c=function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?r(Object(n),!0).forEach((function(t){s(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):r(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}({connect:(e,t)=>{e===n&&(t(),l())}},this.channelListeners);return i=new o.default(window,e,t,c),i.call("connect",n,l),this.links.push({channel:i,window:e}),i}call(e,...t){let n;"function"==typeof t[t.length-1]&&(n=t[t.length-1],t=t.slice(0,-1));const i=e=>t=>{throw e.destroy(),this.links=Array.from(this.links).filter((t=>t.channel!==e)).map((e=>e)),t},o=this.links.map((function(n){return new Promise((function(i,o){const r=setTimeout((()=>i(null)),1e3);try{return n.channel.call(e,...Array.from(t),(function(e,t){return clearTimeout(r),e?o(e):i(t)}))}catch(s){return o(s)}})).catch(i(n.channel))}));let r=Promise.all(o);return n&&(r=r.then((e=>n(null,e))).catch((e=>n(e)))),r}on(e,t){if(this.channelListeners[e])throw new Error(`Listener '${e}' already bound in Bridge`);return this.channelListeners[e]=t,this}off(e){return delete this.channelListeners[e],this}onConnect(e){return this.onConnectListeners.push(e),this}}},{"./frame-rpc":74}],73:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=void 0;n.default=class{constructor(e,t={}){this.target=e,this.server=!1,this.origin="*",this.requestInProgress=!1,this.onDiscovery=null,void 0!==t.server&&(this.server=t.server),void 0!==t.origin&&(this.origin=t.origin),this._onMessage=this._onMessage.bind(this)}startDiscovery(e){if(this.onDiscovery)throw new Error("Discovery is already in progress. Call stopDiscovery() first");this.onDiscovery=e,this.target.addEventListener("message",this._onMessage,!1),this._beacon()}stopDiscovery(){this.onDiscovery=null,this.target.removeEventListener("message",this._onMessage)}_beacon(){let e;e=this.server?"__cross_frame_dhcp_offer":"__cross_frame_dhcp_discovery";const t=[this.target.top];for(;t.length>0;){const n=t.shift();n!==this.target&&n.postMessage(e,this.origin);for(let e=0;e<n.frames.length;e++)t.push(n.frames[e])}}_onMessage(e){const{source:t,data:n}=e;let i=e.origin;("null"===i||i.match("moz-extension:")||"moz-extension:"===window.location.protocol)&&(i="*");const o="string"==typeof n&&n.match(/^__cross_frame_dhcp_(discovery|offer|request|ack)(?::(\d+))?$/);if(!o)return;let[,r,s]=o;const{reply:a,discovered:l,token:c}=this._processMessage(r,s,i);a&&t.postMessage("__cross_frame_dhcp_"+a,i),l&&this.onDiscovery&&this.onDiscovery.call(null,t,i,c)}_processMessage(e,t,n){let i=null,o=!1;if(this.server){if("discovery"===e)i="offer";else if("request"===e)i=`ack:${t=this.generateToken()}`,o=!0;else if("offer"===e||"ack"===e)throw new Error(`A second Discovery server has been detected at ${n}.\n This is unsupported and will cause unexpected behaviour.`)}else"offer"===e?this.requestInProgress||(this.requestInProgress=!0,i="request"):"ack"===e&&(this.requestInProgress=!1,o=!0);return{reply:i,discovered:o,token:t}}generateToken(){return Math.random().toString().replace(/\D/g,"")}}},{}],74:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=i;function i(e,t,n,i){const o=this;if(this.src=e,this.dst=t,"*"===n)this.origin="*";else{const e=new URL(n);this.origin=e.protocol+"//"+e.host}this._sequence=0,this._callbacks={},this._onmessage=function(e){o._destroyed||o.dst===e.source&&("*"!==o.origin&&e.origin!==o.origin||e.data&&"object"==typeof e.data&&"frame-rpc"===e.data.protocol&&Array.isArray(e.data.arguments)&&o._handle(e.data))},this.src.addEventListener("message",this._onmessage),this._methods=("function"==typeof i?i(this):i)||{}}i.prototype.destroy=function(){this._destroyed=!0,this.src.removeEventListener("message",this._onmessage)},i.prototype.call=function(e){const t=[].slice.call(arguments,1);return this.apply(e,t)},i.prototype.apply=function(e,t){if(this._destroyed)return;const n=this._sequence++;"function"==typeof t[t.length-1]&&(this._callbacks[n]=t[t.length-1],t=t.slice(0,-1)),this.dst.postMessage({protocol:"frame-rpc",version:"1.0.0",sequence:n,method:e,arguments:t},this.origin)},i.prototype._handle=function(e){const t=this;if(!t._destroyed)if(e.hasOwnProperty("method")){if(!this._methods.hasOwnProperty(e.method))return;const n=e.arguments.concat((function(){t.dst.postMessage({protocol:"frame-rpc",version:"1.0.0",response:e.sequence,arguments:[].slice.call(arguments)},t.origin)}));this._methods[e.method].apply(this._methods,n)}else if(e.hasOwnProperty("response")){const t=this._callbacks[e.response];delete this._callbacks[e.response],t&&t.apply(null,e.arguments)}}},{}],75:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.matchShortcut=s,n.installShortcut=a,n.useShortcut=function(e,t,{rootElement:n=document.body}={}){(0,o.useEffect)((()=>{if(e)return a(e,t,{rootElement:n})}),[e,t,n])};var i=e("@hypothesis/frontend-shared"),o=e("preact/hooks");const r={alt:1,ctrl:2,meta:4,shift:8};function s(e,t){const n=t.split("+").map((e=>e.toLowerCase()));let o=0,s=null;for(let i of n){const e=r[i];if(e)o|=e;else{if(null!==s)throw new Error("Multiple non-modifier keys specified");s=i}}if(!s)throw new Error(`Invalid shortcut: ${t}`);return((e.ctrlKey?r.ctrl:0)|(e.metaKey?r.meta:0)|(e.altKey?r.alt:0)|(e.shiftKey?r.shift:0))===o&&(0,i.normalizeKeyName)(e.key).toLowerCase()===s}function a(e,t,{rootElement:n=document.body}={}){const i=n=>{s(n,e)&&t(n)};return n.addEventListener("keydown",i),()=>n.removeEventListener("keydown",i)}},{"@hypothesis/frontend-shared":4,"preact/hooks":12}],76:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.toBoolean=function(e){if("string"==typeof e&&"false"===e.trim().toLocaleLowerCase())return!1;const t=Number(e);return isNaN(t)?"string"==typeof e:Boolean(t)},n.toInteger=function(e){return parseInt(e)},n.toObject=function(e){return"object"==typeof e&&null!==e?e:{}},n.toString=function(e){return e&&"function"==typeof e.toString?e.toString():""}},{}],77:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.isTouchDevice=n.isIOS=n.isMacOS=void 0;n.isMacOS=(e=window.navigator.userAgent)=>e.indexOf("Mac OS")>=0;n.isIOS=(e=window.navigator,t="ontouchend"in document)=>["iPad Simulator","iPhone Simulator","iPod Simulator","iPad","iPhone","iPod"].includes(e.platform)||e.userAgent.includes("Mac")&&t;n.isTouchDevice=(e=window)=>e.matchMedia("(pointer: coarse)").matches},{}],78:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=o;let i={};function o(...e){const t=e.join();t in i||(console.warn(...e),i[t]=!0)}o.reset=()=>{i={}}},{}],79:[function(e,t,n){"use strict";Object.defineProperty(n,"__esModule",{value:!0}),n.default=u;var i,o=e("@hypothesis/frontend-shared"),r=(i=e("prop-types"))&&i.__esModule?i:{default:i},s=e("preact/jsx-runtime");function a(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(e);t&&(i=i.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,i)}return n}function l(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?a(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):a(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function c(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u({buttonText:e="",className:t="",disabled:n=!1,icon:i="",iconPosition:r="left",isExpanded:a,isPressed:c,onClick:u=(()=>{}),style:h={},title:d}){d=d||e;const f=t||"Button--"+(e?"labeled":"icon-only"),p={};return e&&d===e||(p.title=d,p["aria-label"]=d),"boolean"==typeof c&&(p["aria-pressed"]=c),"boolean"==typeof a&&(p["aria-expanded"]=a),(0,s.jsxs)("button",l(l({className:f,onClick:u,style:h,disabled:n},p),{},{children:[i&&"left"===r&&(0,s.jsx)(o.SvgIcon,{name:i}),e,i&&"right"===r&&(0,s.jsx)(o.SvgIcon,{name:i})]}))}function h(e,t,n){if("string"!=typeof e.buttonText&&"string"!=typeof e[t])return new Error(`string property '${t}' must be supplied to component '${n}'if string property 'buttonText' omitted`)}u.propTypes={buttonText:r.default.string,className:r.default.string,icon:h,iconPosition:r.default.string,isExpanded:r.default.bool,isPressed:r.default.bool,onClick:r.default.func,disabled:r.default.bool,style:r.default.object,title:h}},{"@hypothesis/frontend-shared":4,"preact/jsx-runtime":13,"prop-types":15}]},{},[43]);
//# sourceMappingURL=annotator.bundle.js.map