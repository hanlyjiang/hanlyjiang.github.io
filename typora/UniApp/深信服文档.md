# 深信服双域SDK接入文档

## **SangforSDK接入文档说明**

更新时间：2019-11-12 



## 产品简介

深信服SangforSDK，基于深信服在数据传输方面强大的安全能力与在移动端安全扎实的技术积累，提供移动端应用**VPN安全接入**和**安全沙箱**能力，
移动App通过集成轻量级SDK，即可实现应用数据透明的，加密的安全传输到客户内网业务系统，帮助用户在任何时间、任何地点，使用移动终端，安全、
快速地接入内网业务系统，满足用户移动办公的需求，且移动App可通过 **文件系统隔离、文件流转（当前只支持Android）、分享&打开&远程调用隔离、**
**剪切板隔离&剪切板限制字符数、屏幕水印、禁止截屏&截屏审计（Android禁止截屏，iOS截屏审计）、后台模糊、网络隔离** 来保障用户数据安全。



## 应用场景

当用户有一个或者多个APP需要在公网上访问公司内网服务器且对应用数据安全有强烈需求的时候，
深信服SangforSDK提供的安全接入与安全沙箱功能将完全满足用户需求。

从应用场景方面来看, 按照用户需要集成的APP多少，可将用户集成SangforSDK分为单应用场景和多应用场景。

### 1、单应用场景：

当用户只有一个APP需要集成SDK时，我们称这种情况为单应用场景。

### 2、多应用场景：

当用户有多个APP需要集成SDK时，我们称这种情况为多应用场景。
并且如果这多个APP中有一个APP为门户应用，其它APP为子应用，那么门户应用被我们称作主应用，其它APP称作子应用，
如果多个APP没有从属关于且相对独立，那么这多个APP就都可以称作主应用。



## 功能介绍

### 1、安全接入功能：

SangforSDK安全接入功能对用户APP提供了安全认证、安全传输、访问授权、日志追溯等多种安全特性。
SDK支持EMM网关服务器上的所有认证方式，包括用户名密码、证书认证、硬件特征码认证、短信认证、
令牌认证等，所有认证方式又可以自由组合形成多因素认证，提高身份安全性，解决身份盗用等安全问题。
当APP完成安全认证后，APP与EMM网关之间自动建立VPN加密隧道，所有内网业务数据全部通过加密隧道安全传输。

### 2、安全沙箱功能：

SangforSDK对用户还提供了安全沙箱功能，协助企业应用快速集成移动安全特性以保护应用数据安全。
这些安全特性包括**文件系统隔离、文件流转（当前只支持Android）、分享&打开&远程调用隔离、屏幕水印、后台模糊、**
**剪切板隔离&剪切板限制字符数、禁止截屏&截屏审计（Android禁止截屏，iOS截屏审计）、网络隔离**。

并且SangforSDK根据客户使用场景，提供两种安全特性生效方式，即**动态策略**和**静态策略**
**动态策略**：应用安全策略在EMM设备上进行配置，当移动应用开启安全沙箱功能后，自动从EMM设备上下载安全策略，且这些安全策略可以在EMM设备上动态调整。
**静态策略**：应用安全策略在集成SDK的时候就写到应用程序代码中，这样设置安全策略的方式就叫静态策略。但是，如果客户自己搭建一个服务器，
并把安全策略放到服务器上供移动应用下载，这样也是可以实现动态调整安全策略的。



## 集成指导

下面我们将结合SDK的Demo工程进行更详细的集成指导。
针对Android和iOS两大移动端平台，SangforSDK提供了不同的示例程序，后面的内容将区分平台进行讲解。
另外，根据用户集成场景，我们把集成分为单应用集成和多应用集成来讲解。

### 1、Android集成指导

- 单应用集成参考 [Android 单应用集成步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#HOST_APPLICATION_DEV)
- 主应用集成SDK + 子应用集成SDK，参考 [Android 主应用+子应用集成步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#HOST_SUB_APPLICATION_DEV)
- 多主应用集成SDK，参考 [Android 多主应用集成步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#MULTI_HOST_APPLICATION_DEV)
- [Android API说明](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_api_list)

### 2、iOS集成指导

- 单应用集成参考 [iOS 单应用集成步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#IOS_HOST_APPLICATION_DEV)
- 主应用集成SDK + 子应用集成SDK，参考 [iOS 主应用+子应用集成步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#IOS_HOST_SUB_APPLICATION_DEV)
- 多主应用集成SDK，参考 [iOS 多主应用集成步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#IOS_MULTI_HOST_APPLICATION_DEV)
- [iOS API说明](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_api_list)



## **Android--单应用集成步骤**

集成原理：
企业应用直接集成SangforSDK.aar开发包，所有进程启动时都需要进行SDK初始化，
UI主进程需要调用SDK接口完成EMM账户身份认证 和 调用SDK接口进行安全沙箱配置。如下图：

![AndroidSingleApp](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/%E6%B7%B1%E4%BF%A1%E6%9C%8DSDK%E9%9B%86%E6%88%90%E6%8C%87%E5%AF%BC%E6%96%87%E6%A1%A3/assets/AndroidSingleApp.PNG)

### 集成SDK大概分为如下步骤： 

- 了解[Android SDK开发包组成](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_sdk_zip)
- [运行SDK Demo工程](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_run)，对SDK接口初步了解
- [导入SangforSDK.aar](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_aar_import)到自己的工程
- [集成SDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_single_app_with_sdk)



### 1、Android SDK开发包组成

开发包中提供SDK包（SangforSDK.aar)、示例工程（SDKDemo.zip)及开发指导文档



### 2、运行SDK Demo工程

深信服提供的Demo工程使用的开发环境是Android Studio 3.5.1。（后续描述中Android Studio统一简称为AS）。
使用AS打开工程后，AS会自动联网下载相关依赖，等依赖下载完成后即可运行Demo工程。
整个Demo工程展示了SDK的初始化、VPN功能需要用到的认证逻辑、以及登录成功后的资源访问及VPN注销，还有安全沙箱功能。



### 3、导入SangforSDK.aar

在AS中怎么给安卓项目导入aar包，可以分为下面几步（具体的可以参考SDKDemo）：

- 1、把aar放到module里的libs目录下。新建安卓项目时，默认的模块名字是app，即放到app/libs/下。 
- 2、在app的build.gradle中加入以下配置。

```
repositories {    
    flatDir {        
        dirs 'libs'   // aar放置目录
      }
}
```

- 3、在app的build.gradle中dependencies里加入aar引用。

```
dependencies {
    implementation(name: 'SangforSDK', ext: 'aar')
}
```



### 4、单应用集成SDK代码指导

SangforSDK对外提供的所有接口都在java类com.sangfor.sdk.SFMobileSecuritySDK中，该类为单列类，接口详情参考[Android接口说明](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_api_list)

##### 首先初始化SDK 

SDK初始化建议放到应用的Application中进行，因为每个app的每个进程都需要调用SDK的初始化接口，所以Application的attachBaseContext函数中进行初始化是首选。
对照Demo中的代码讲解：

```
public class SFApplication extends Application {
    private static final String TAG = "SFApplication";

    @Override
    protected void attachBaseContext(Context base) {
        super.attachBaseContext(base);

        //只使用VPN功能场景
//        SFSDKMode sdkMode = SFSDKMode.MODE_VPN;                 //表明启用VPN安全接入功能,详情参考集成指导文档
//        //只使用安全沙箱功能场景
//        SFSDKMode sdkMode = SFSDKMode.MODE_SANDBOX;             //表明启用安全沙箱功能,详情参考集成指导文档
        //同时使用VPN功能+安全沙箱功能场景
        SFSDKMode sdkMode = SFSDKMode.MODE_VPN_SANDBOX;         //表明同时启用VPN功能+安全沙箱功能,详情参考集成指导文档

        switch (sdkMode) {
            case MODE_VPN: {//只使用VPN功能场景
                int sdkFlags =  SFSDKFlags.FLAGS_HOST_APPLICATION;      //表明是单应用或者是主应用
                sdkFlags |= SFSDKFlags.FLAGS_VPN_MODE_TCP;              //表明使用VPN功能中的TCP模式

                SFMobileSecuritySDK.getInstance().initSDK(base, sdkMode, sdkFlags, null);//初始化SDK
                break;
            }
            case MODE_SANDBOX: {//只使用安全沙箱功能场景
                int sdkFlags =  SFSDKFlags.FLAGS_HOST_APPLICATION;      //表明是单应用或者是主应用
                sdkFlags |= SFSDKFlags.FLAGS_ENABLE_FILE_ISOLATION;     //表明启用安全沙箱功能中的文件隔离功能

                SFMobileSecuritySDK.getInstance().initSDK(base, sdkMode, sdkFlags, null);//初始化SDK
                break;
            }
            case MODE_VPN_SANDBOX: { //同时使用VPN功能+安全沙箱功能场景
                int sdkFlags =  SFSDKFlags.FLAGS_HOST_APPLICATION;      //表明是单应用或者是主应用
                sdkFlags |= SFSDKFlags.FLAGS_VPN_MODE_TCP;              //表明使用VPN功能中的TCP模式
                sdkFlags |= SFSDKFlags.FLAGS_ENABLE_FILE_ISOLATION;     //表明启用安全沙箱功能中的文件隔离功能

                SFMobileSecuritySDK.getInstance().initSDK(base, sdkMode, sdkFlags, null);//初始化SDK
                break;
            }
            default: {
                Toast.makeText(base, "SDK模式错误", Toast.LENGTH_LONG).show();
            }
        }
    }
}
```

此处展示了接口[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#initSDK)的使用，其中两个参数[sdkMode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSDKMode)、[sdkFlags](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSDKFlags)一定要根据APP的业务需求进行理性设置。
如果APP业务只需要VPN功能，则设置SDK模式为**SFSDKMode.MODE_VPN**；
如果只需要安全沙箱功能，则设置SDK模式为**SFSDKMode.MODE_SANDBOX**；
如果同时需要VPN安全接入功能及安全沙箱功能，则设置SDK模式为**SFSDKMode.MODE_VPN_SANDBOX**。



##### 调用SDK接口完成EMM身份认证 

**特别说明：无论是 VPN安全接入 还是 安全沙箱功能，app都需要调用SDK接口完成EMM身份认证才能正常使用。**

比如我们要实现用户名密码+短信认证（**要使用这两种认证方式，APP开发人员需要向客户的EMM设备管理员获取相应的账号，注意：深信服是不提供测试账号的**），整个流程可分为如下步骤：

- [注册认证结果回调](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_implements_SFAuthResultListener)
- [进行用户名密码认证](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_implements_startPasswordAuth)
- [实现重新获取短信验证码逻辑](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_implements_SFRegetSmsListener)
- [进行短信验证码认证](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_implements_startSecondAuth)
- [认证成功](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_implements_onAuthSuccess)
- [免密认证](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#android_demo_implements_TicketAuth)

### 具体代码实现如下：

#### 1、注册认证结果回调

因为EMM身份认证是一个有网络请求的耗时操作，所以结果都是通过异步回调来进行获取的。
认证结果回调[SFAuthResultListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFAuthResultListener)就是SDK提供的认证结果回调，app只需要继承和实现其中的方法，
并调用[setAuthResultListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#setAuthResultListener)接口设置认证结果回调，这样在进行认证的时候就能收到认证结果。
具体参考Demo中的代码：

```
public class LoginActivity extends AppCompatActivity implements SFAuthResultListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        /**
         * 设置认证回调,认证结果在SFAuthResultListener的onAuthSuccess、onAuthFailed、onAuthProgress中返回
         * 如果不设置，将接收不到认证结果
         */
        SFMobileSecuritySDK.getInstance().setAuthResultListener(this);
    }

    /**
     * 认证成功
     *
     * @param message 认证成功信息
     */
    @Override
    public void onAuthSuccess(final SFBaseMessage message) {
        //认证完成，跳转认证成功界面，可以开始访问资源
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                showToast(getString(R.string.auth_success));
                startActivity(new Intent(LoginActivity.this, AuthSuccessActivity.class));
            }
        });
    }

    /**
     * 认证失败
     *
     * @param authType 当前认证类型
     * @param message  认证失败信息
     */
    @Override
    public void onAuthFailed(final SFAuthType authType, final SFBaseMessage message) {
        //认证失败
        runOnUiThread(new Runnable() {
            @Override
            public void run() {

                showErrorMessage(message.mErrStr);
            }
        });
    }

    /**
     * 主认证成功，但需要辅助认证（下一步认证）
     *
     * @param nextAuthType 下一步认证类型
     * @param message      下一步认证信息
     */
    @Override
    public void onAuthProgress(SFAuthType nextAuthType, SFBaseMessage message) {
        //显示下一步认证UI界面
        showAuthDialog(nextAuthType, message);
    }

    ......
}
```

Demo中首先实现了SFAuthResultListener的三个接口onAuthSuccess、onAuthFailed、onAuthProgress，这三个接口分别处理认证的三种情况。
然后在Activity的onCreate方法中设置认证回调。

#### 2、进行用户名密码认证

用户名密码认证，顾名思义，需要用户输入用户名和密码进行认证，所以[startPasswordAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#startPasswordAuth)接口需要传入用户名和密码两个参数。
另外，此处还需要传入EMM服务器地址，这样SDK才知道应该去哪台EMM服务器进行认证。
具体参考Demo中的代码：

```java
public class LoginActivity extends AppCompatActivity implements SFAuthResultListener {

     @Override
    public void onClick(View v) {
        switch (v.getId()) {
            case R.id.svpn_login_button: {
                //开始主认证，用户名密码或者证书认证，在认证回调中返回认证结果
                startPrimaryAuth();
                break;
            }
            default:
                break;
        }
    }

    /**
     * 开始主认证，用户名密码或者证书认证
     */
    private void startPrimaryAuth() {

        //获取当前选取的认证方式
        int currentAuthViewId = mAuthMethodRadioGroup.getCheckedRadioButtonId();
        switch (currentAuthViewId) {
            case R.id.svpn_userAuth_tabheader: {
                mVpnAddress = mVpnAddressEditText.getText().toString();
                mUserName = mUserNameEditView.getText().toString();
                mUserPassword = mUserPasswordEditView.getText().toString();

                if (TextUtils.isEmpty(mVpnAddress)) {
                    showToast("VPN服务器地址不能为空");
                    return;
                }

                if (TextUtils.isEmpty(mUserName)) {
                    showToast("用户名不能为空");
                    return;
                }

                showWaitingDialog(false);
                SFMobileSecuritySDK.getInstance().startPasswordAuth(mVpnAddress, mUserName, mUserPassword);
                break;
            }
        }
    }
    ......
}
```

上面代码中，我们在登录按钮的点击事件中，开始用户名密码主认证，
并且在保证服务器地址不为空， 用户名不为空的情况下，调用SDK提供的startPasswordAuth接口进行用户名密码认证。
认证结果在上面实现的SFAuthResultListener回调接口中返回，因为我们还要进行短信认证，
所以此处代码会回调到onAuthProgress函数中进行下一步认证。
ps：如果此处的用户名密码错误，回调函数会进入到onAuthFailed函数中。
如果EMM账号只配置了用户名密码认证，并且认证成功，回调函数会进入到onAuthSuccess函数中，表示认证成功。

#### 3、实现重新获取短信验证码逻辑

注意，此处是实现的重新获取短信的逻辑，在上面的用户名密码认证成功后，EMM服务器会自动的向用户绑定的手机号码发送短信，只有当短信因为某此原因无法收到的时候才需要重新获取短信。
如果用户已经收到了短信验证码，是不需要再重新获取短信验证码的，可直接进行短信验证码认证。
在SDKDemo的LoginActivity中实现[SFRegetSmsListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFRegetSmsListener)回调接口。
具体参考Demo中的代码：

```
public class LoginActivity extends AppCompatActivity implements SFAuthResultListener, SFRegetSmsListener{
    /**
     * 重新获取短信验证码回调
     * @param success 是否成功获取，true表示成功，false表示失败
     * @param message 包含短信相关信息
     */
    @Override
    public void onRegetSmsCode(final boolean success, final SFSmsMessage message) {
        SFLogN.info(TAG, "onRegetSmsCode result: " + success + ", msg: " + message.mErrStr);

        //更新短信验证码信息
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                final Button btnGetVerficationCode = mSmsCodeDialogView.findViewById(R.id.bt_getVerficationCode);
                if (success) {
                    //更新倒计时
                    smsCountDownTimer(btnGetVerficationCode, message.getCountDown());
                    showToast(getString(R.string.reget_sms_code_success));
                } else {
                    btnGetVerficationCode.setEnabled(true);
                    showToast(getString(R.string.reget_sms_code_failed) + message.mErrStr);
                }
            }
        });
    }

    /**
     * 创建认证对话框中间显示的视图
     * @param sfAuthType 认证类型
     * @param layoutId 要加载的视图的布局ID
     * @param message  认证附加信息
     * @return  认证对话框视图
     */
    private View createDialogView(SFAuthType sfAuthType, int layoutId, final SFBaseMessage message) {
      ......
      switch (sfAuthType) {
          ......
          case AUTH_TYPE_SMS: {
              Button btnGetVerficationCode = dialogView.findViewById(R.id.bt_getVerficationCode);
              btnGetVerficationCode.setOnClickListener(new View.OnClickListener() {
                  @Override
                  public void onClick(View v) {
                      v.setEnabled(false);
                      //调用重新获取短信接口
                      SFMobileSecuritySDK.getInstance().regetSmsCode(LoginActivity.this);
                  }
              });
          }
      }
    }
    ......
}
```

在Demo中，首先实现SFRegetSmsListener的onRegetSmsCode函数，函数中处理重新获取短信的结果。
然后在设置重新获取短信按钮的onClick点击事件，在点击事件中通过SDK接口[regetSmsCode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#regetSmsCode)触发获取短信操作，
并且在onRegetSmsCode回调中通过参数[SFSmsMessage](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSmsMessage)返回 短信认证的手机号码、重新发送短信倒计时时间、上次发送的短信验证码是否在有效期 这此信息。

#### 4、进行短信验证码认证

接下来，我们调用SDK的[doSecondaryAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#doSecondaryAuth)进行短信验证码辅助认证，此处的认证类型参数应该传入[SFAuthType.AUTH_TYPE_SMS](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFAuthType)，认证参数应该传入用户输入的短信验证码。
具体参考Demo中的代码：

```java
public class LoginActivity extends AppCompatActivity implements SFAuthResultListener, SFRegetSmsListener{
        /**
     * 显示下一步认证UI界面
     */
    public void showAuthDialog(final SFAuthType authType, final SFBaseMessage message) {
        runOnUiThread(new Runnable() {
            @Override
            public void run() {
                ......
                final View dialogView = createDialogView(authType, viewLayoutId, message);
                mAuthDialog = new AlertDialog.Builder(LoginActivity.this)
                        .setPositiveButton(R.string.str_commit, new DialogInterface.OnClickListener() {
                            @Override
                            public void onClick(DialogInterface dialog, int which) {
                                closeDialog();
                                //构建辅助认证类型所需参数
                                Map<String, String> authParams = new HashMap<String, String>();
                                String errorMsg = buildAuthParams(authType, dialogView, authParams);
                                //检查参数构建是否成功
                                if (TextUtils.isEmpty(errorMsg)) {
                                    showWaitingDialog(false);
                                    //开始辅助认证
                                    SFMobileSecuritySDK.getInstance().doSecondaryAuth(authType, authParams);
                                } else {
                                    //参数构建失败，进行提示
                                    showErrorMessage(errorMsg);
                                }
                                return;
                            }
                        })
                       
                //显示认证对话框
                mAuthDialog.show();
            }
        });
    }
    ......
}   
```

如果短信验证码错误或者过期，会回调到onAuthFailed中去。
如果还有下一步认证要进行，则会回调到onAuthProgress中去继续下一步认证。（[参考更多认证类型](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFAuthType)）
因为我们只举例说明用户名密码 + 短信认证流程，所以此处认证成功后会直接回调onAuthSuccess，表示认证成功。

#### 5、认证成功

用户名密码及短信认证都成功后，会回调到onAuthSuccess函数中去，至此整个认证流程就结束了。
认证成功后，如果在[initSDK](#initSDK)的时候开启了安全接入功能，APP就可以正常的访问EMM管理员配置的内网服务器。
如果在[initSDK](#initSDK)的时候开启了SDK的安全沙箱功能，认证成功后就会开始生效。
**ps：完整示例参考SDKDemo**



#### 6、免密认证

新版SDK支持免密认证，即用户在使用账号登录成功后，VPN设备会为用户生成免密信息，下一次程序启动后可以优先尝试使用免密信息进行登录，简化用户登录过程。
**注意：若需支持免密认证，需要VPN版本为M7.6.1，并且在VPN控制台进行相应配置。**

具体参考Demo中的代码：

```
 public class LoginActivity extends AppCompatActivity implements SFAuthResultListener {

    @Override
    protected void onCreate(Bundle savedInstanceState) {
        /**
         * 设置认证回调,认证结果在SFAuthResultListener的onAuthSuccess、onAuthFailed、onAuthProgress中返回
         * 如果不设置，将接收不到认证结果
         */
        SFMobileSecuritySDK.getInstance().setAuthResultListener(this);

        /**
         * 优先尝试免密登录
         * 即用户在使用账号登录成功后，VPN设备会为用户生成免密信息，
         * 下一次程序启动后可以使用免密信息进行登录，简化用户登录过程。
         * 注意：此功能需要VPN设备支持且开启才生效。
         */
        //判断当前免密登录是否可用
        if (SFMobileSecuritySDK.getInstance().supportTicketAuth()) {
            showToast("开始免密认证");
            //开始免密认证，认证结果在认证回调中返回
            SFMobileSecuritySDK.getInstance().startTicketAuth();
        }
    }
 }
```

Demo展示了在LoginActivity的onCreate函数中，在设置了认证回调后，通过SDK接口函数[supportTicketAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#supportTicketAuth)来判断当前免密登录是否可用，
如果可用，再通过SDK接口函数[startTicketAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#startTicketAuth)来进行免密登录，认证结果在认证回调中返回。



## 子应用集成SDK详情

子应用集成SDK相比主应用就要简单很多

集成可分为如下步骤：

#### 1、初始化SDK

同样是调用SDK的[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#initSDK)方法进行初始化。
**需要注意的点有：**

- 确保子应用初始化的SDKMode与主应用保持一致，即主应用是什么，子应用就要是什么
- 此处需要把主应用标记SFSDKFlags.FLAGS_HOST_APPLICATION替换为子应用标记SFSDKFlags.FLAGS_SUB_APPLICATION

具体参考子应用Demo中的代码：

```
public class SFApplication extends Application {
    @Override
    protected void attachBaseContext(Context base) {
        super.attachBaseContext(base);

        SFSDKMode sdkMode = SFSDKMode.MODE_VPN_SANDBOX;     //表明同时启用VPN功能+安全沙箱功能
        int sdkFlags = SFSDKFlags.FLAGS_VPN_MODE_TCP;       //表明使用VPN功能中的TCP模式
        sdkFlags |= SFSDKFlags.FLAGS_SUB_APPLICATION;       //表明是子应用
        sdkFlags |=SFSDKFlags.FLAGS_ENABLE_FILE_ISOLATION;  //表明启用安全沙箱功能中的文件隔离功能

        SFMobileSecuritySDK.getInstance().initSDK(base, sdkMode, sdkFlags, null);
    }
}
```

此处，[SFSDKMode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSDKMode)与主应用保持一致，并设置子应用标记[SFSDKFlags.FLAGS_SUB_APPLICATION](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSDKFlags)

#### 2、设置主应用包名

在子应用的AndroidManifest中，通过添加meta-data信息，其中**host_data**为节点名称，**主应用包名**为值。
SDK会自动解析这个meta-data信息来寻找主应用，所以这个一定要设置。

具体参考子应用Demo中的代码：

```
<application
   ......
   <!--value 主应用包名-->
   <meta-data android:name="host_data" android:value="com.sangfor.sdkdemo"/>
   ......
</application>       
```

这里把SDKDemo（其包名就是com.sangfor.sdkdemo）设置为了主应用。

#### 3、检查主应用EMM身份认证状态

通过SFMobileSecuritySDK.getInstance().[getAuthStatus](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#getAuthStatus)可以查询到主应用当前的身份认证状态，
如果当前不是认证成功的状态，需要启动主应用进行身体认证。
如果当前是认证成功的，那么子应用就可以开始使用了。

具体参考子应用Demo中的代码：

```
        //获取主应用EMM身份认证状态
        SFAuthStatus authStatus = SFMobileSecuritySDK.getInstance().getAuthStatus();
        if (authStatus != SFAuthStatus.AuthStatusAuthOk ) {
            Toast.makeText(this, "主应用未认证成功,启动主应用进行EMM身份认证!", Toast.LENGTH_LONG).show();

            //获取主应用包名
            String hostPackage = StoreInfoManager.getInstance().getShareStoragePackagePath();
            if (hostPackage == null) {
                Toast.makeText(this, "host_data未在AndroidManifest中配置!", Toast.LENGTH_LONG).show();
                return;
            }

            //启动主应用进行EMM身份认证
            startAppByPackageName(this,hostPackage);
        } else {
            //主应用认证成功
            Toast.makeText(this, "主应用认证成功,子应用可正常使用了!", Toast.LENGTH_LONG).show();
        }
```

**至此，子应用集成完成！**



## Android主应用+子应用集成SDK步骤

主应用与子应用场景下，最核心的地方就是子应用共享主应用的信息（通过Android系统机制ContentProvider实现），
这些信息包括主应用的EMM身体认证信息、EMM服务器资源配置信息、安全沙箱策略信息等。
这样的好外是，子应用的集成将会非常简单，因为很多信息主应用已经保存了，子应用只需要简单的从主应用获取即可。

![AndroidMultiApps](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/%E6%B7%B1%E4%BF%A1%E6%9C%8DSDK%E9%9B%86%E6%88%90%E6%8C%87%E5%AF%BC%E6%96%87%E6%A1%A3/assets/AndroidMultiApps.PNG)


主应用与子应用集成SDK的时候，主应用的集成与单应用的集成是完全一致的，所以主应用集成请参考[单应用集成SDK步骤。](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#HOST_APPLICATION_DEV)
此种场景下，子应用的集成参考[子应用集成SDK步骤。](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SUB_APPLICATION_DEV)

## Android多主应用集成SDK步骤

当客户要集成的多个APP之间没有主从关系的时候，每个APP都是主应用，那么每个APP的集成都可以参考[单应用集成SDK步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#HOST_APPLICATION_DEV)来集成。 



## **iOS--单应用集成步骤**

\### 集成SDK大概分为如下步骤：
\- 了解[iOS SDK开发包组成](#ios_sdk_zip) - [运行SDK Demo工程](#ios_demo_run)，对SDK接口初步了解 - [导入SangforSDK.framework](#ios_demo_aar_import)到自己的工程 - [集成SDK](#ios_single_app_with_sdk)

### 1、iOS SDK开发包组成

开发包中提供SDK包（SangforSDK.framework)、示例工程（SDKDemo.zip)及开发指导文档



### 2、运行SDK Demo工程

深信服提供的Demo工程使用的开发环境是Xcode 10.2.1。



### 3、导入SangforSDK.framework

在Xcode中怎么给ios项目导入framework包，可以分为下面几步（具体的可以参考main_app）：

- 1、拷贝SangforSDK.framework到项目中

  

- 2、Xcode右键点击"Add Files to xxProject"

  

- 3、关闭bitcode开关 因为SangforSDK.framework不支持bitcode，所以如果宿主项目设置了bitcode，请先把它关掉
  ![IOSCloseBitcode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/%E6%B7%B1%E4%BF%A1%E6%9C%8DSDK%E9%9B%86%E6%88%90%E6%8C%87%E5%AF%BC%E6%96%87%E6%A1%A3/assets/IOSCloseBitcode.png)

  

- 4、导入SangforSDK.framework到target
  在宿主应用的target的"Embedded Binaries"中Add框架SangforSDK.framework
  ![IOSEmbeddedBinaries](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/%E6%B7%B1%E4%BF%A1%E6%9C%8DSDK%E9%9B%86%E6%88%90%E6%8C%87%E5%AF%BC%E6%96%87%E6%A1%A3/assets/IOSEmbeddedBinaries.png)

  

- 5、如果是多应用场景，需要AppGroup进行数据通信
  多应用场景，即一个主应用，多个子应用，所有应用需要开启AppGroup功能且保证groupid一致，
  同时设置groupid包括sfshare后缀，例如group.com.***.sfshare



### 4、单应用集成SDK代码指导

具体实现可参考demo中的main_app工程代码：

SangforSDK对外提供的所有接口都在OC类SFMobileSecuritySDK中，该类为单例类，接口详情参考[iOS接口说明](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_api_list)

##### 首先初始化SDK 

SDK初始化建议越早越好，比如放到main函数或者didFinishLaunchingWithOptions函数中都是可以的。

此处展示了接口[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_initSDK)的使用，其中两个参数[sdkMode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKMode)、[sdkFlags](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKFlags)一定要根据APP的业务需求进行理性设置。

如demo中代码：

```
 /**
     一般场景SDK的模式为SFSDKModeSupporVpnSandbox，即同时支持VPN和沙箱功能。
     需要设置主应用flags，如果需要外部设置沙箱策略需要设置SFSDKFlagsSupportManagePolicy。
     多应用场景，即一个主应用，多个子应用，所有应用需要开启AppGroup功能且保证groupid一致，同时设置groupid包括sfshare后缀，例如group.com.***.sfshare
     */
    [[SFMobileSecuritySDK sharedInstance] initSDK:SFSDKModeSupporVpnSandbox
                                            flags:SFSDKFlagsHostApplication|SFSDKFlagsSupportManagePolicy
                                            extra:nil];
```



##### 调用SDK接口完成EMM身份认证 

**特别说明：无论是 VPN安全接入 还是 安全沙箱功能，app都需要调用SDK接口完成EMM身份认证才能正常使用。**

比如我们要实现用户名密码+短信认证（**要使用这两种认证方式，APP开发人员需要向客户的EMM设备管理员获取相应的账号，注意：深信服是不提供测试账号的**），整个流程可分为如下步骤：

- [注册认证结果回调](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_demo_implements_SFAuthResultDelegate)
- [进行用户名密码认证](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_demo_implements_startPasswordAuth)
- [实现重新获取短信验证码逻辑](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_demo_implements_regetSmsCode)
- [进行短信验证码认证](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_demo_implements_doSecondaryAuth)
- [认证成功](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_demo_implements_onAuthSuccess)



### 具体代码实现如下：

#### 1、注册认证结果回调

因为EMM身份认证是一个有网络请求的耗时操作，所以结果都是通过异步回调来进行获取的。 实现protocol SFAuthResultDelegate(#ios_SFAuthResultDelegate)并调用setAuthResultDelegate(#ios_setAuthResultDelegate)注册

如代码中

```
[[SFMobileSecuritySDK sharedInstance] setAuthResultDelegate:self];
```



#### 2、进行用户名密码认证

用户名密码认证，顾名思义，需要用户输入用户名和密码进行认证，
调用接口[startPasswordAuth](#ios_startPasswordAuth):userName:password:来完成

```
//密码认证
        NSString *username = [(AuthTableViewCell *)[_userNameTableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:0 inSection:0]] cellText];
        NSString *password = [(AuthTableViewCell *)[_userNameTableView cellForRowAtIndexPath:[NSIndexPath indexPathForRow:1 inSection:0]] cellText];

        [[SFMobileSecuritySDK sharedInstance] startPasswordAuth:vpnUrl userName:username password:password];
```

认证结果在上面实现的[SFAuthResultDelegat](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFAuthResultDelegate)回调接口中返回，
因为我们还要进行短信认证，此处代码会回调到onAuthProcess:message:函数中进行下一步认证。
ps：如果此处的用户名密码错误，回调函数会进入到onAuthFailed:函数中。
如果EMM账号只配置了用户名密码认证，并且认证成功，回调函数会进入到onAuthSuccess:函数中，表示认证成功。

#### 3、实现重新获取短信验证码逻辑

注意，此处是实现的重新获取短信的逻辑，在上面的用户名密码认证成功后，
EMM服务器会自动的向用户绑定的手机号码发送短信，只有当短信因为某此原因无法收到的时候才需要重新获取短信。

通过SDK接口[regetSmsCode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_regetSmsCode):触发获取短信操作，在回调block中通过参数SmsMessage返回：
短信认证的手机号码、重新发送短信倒计时时间、上次发送的短信验证码是否在有效期 这此信息。

```
[[SFMobileSecuritySDK sharedInstance] regetSmsCode:^(SmsMessage * _Nullable message, NSError * _Nullable error) {
            ...
        }];
```

#### 4、进行短信验证码认证

接下来，我们调用SDK的[doSecondaryAuth](#ios_doSecondaryAuth):进行短信验证码辅助认证

```
[[SFMobileSecuritySDK sharedInstance] doSecondaryAuth:SFAuthTypeSMS data:@{kAuthKeySMS:code}];
```

如果短信验证码错误或者过期，会回调到onAuthFailed:中去。
如果还有下一步认证要进行，则会回调到onAuthProgress:中去继续下一步认证。（[参考更多认证类型](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFAuthType)）
因为我们只举例说明用户名密码 + 短信认证流程，所以此处认证成功后会直接回调onAuthSuccess，表示认证成功。



#### 5、认证成功

用户名密码及短信认证都成功后，会回调到onAuthSuccess:函数中去，至此整个认证流程就结束了。
认证成功后，如果在[initSDK](#ios_initSDK)的时候开启了安全接入功能，APP就可以正常的访问EMM管理员配置的内网服务器。
如果在[initSDK](#ios_initSDK)的时候开启了SDK的安全沙箱功能，认证成功后就会开始生效。
**ps：完整示例参考SDKDemo**



## 子应用集成SDK详情

子应用集成SDK相比主应用就要简单很多

集成可分为如下步骤：

#### 1、初始化SDK

同样是调用SDK的[initSDK](#ios_initSDK)

具体参考子应用Demo（sub_app）中的代码：

```
 /**
     多应用场景，需要保证Mode与主应用一致，同时flags必须包括SFSDKFlagsSubApplication
     判断当前认证状态是否为在线,如果在线就注册VPN状态和注销代理；否则需要到主应用进行认证。
     子应用不支持进行认证
     */
    [[SFMobileSecuritySDK sharedInstance] initSDK:SFSDKModeSupporVpnSandbox
                                            flags:SFSDKFlagsSubApplication
                                            extra:nil];
```

此处，[SFSDKMode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKMode)与主应用保持一致，并设置子应用标记[SFSDKFlagsSubApplication](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKFlags)

#### 2、设置AppGroup进行数据通信

多应用场景，即一个主应用，多个子应用，所有应用需要开启AppGroup功能且保证groupid一致，
同时设置groupid包括sfshare后缀，例如group.com.***.sfshare

#### 3、检查主应用EMM身份认证状态

通过[SFMobileSecuritySDK sharedInstance] [getAuthStatus](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_getAuthStatus)]

```
       if ([[SFMobileSecuritySDK sharedInstance] getAuthStatus] == SFAuthStatusAuthOk) {
        [self registerSdkDelegate];
    }
```

**至此，子应用集成完成！**



## iOS主应用+子应用集成SDK步骤

主应用与子应用场景下，最核心的地方就是子应用共享主应用的信息（通过iOS AppGroup系统共享目录实现），

这些信息包括主应用的EMM身体认证信息、EMM服务器资源配置信息、安全沙箱策略信息等。
这样的好外是，子应用的集成将会非常简单，因为很多信息主应用已经保存了，子应用只需要简单的从主应用获取即可。

![IOSMultiApps](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/%E6%B7%B1%E4%BF%A1%E6%9C%8DSDK%E9%9B%86%E6%88%90%E6%8C%87%E5%AF%BC%E6%96%87%E6%A1%A3/assets/IOSMultiApps.png)

主应用与子应用集成SDK的时候，主应用的集成与单应用的集成是完全一致的，所以主应用集成请参考[单应用集成SDK步骤。](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#IOS_HOST_APPLICATION_DEV)
此种场景下，子应用的集成参考[子应用集成SDK步骤。](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#IOS_SUB_APPLICATION_DEV)



## iOS多主应用集成SDK步骤

当客户要集成的多个APP之间没有主从关系的时候，每个APP都是主应用，那么每个APP的集成都可以参考[单应用集成SDK步骤](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#IOS_HOST_APPLICATION_DEV)来集成。 



## 更多额外信息

| 授权等级    | 支持的功能模式                     |
| ----------- | ---------------------------------- |
| EMM标准授权 | 支持 VPN功能模式、安全沙箱功能模式 |
| EMM并发授权 | 支持 VPN功能模式                   |



## **iOS--单应用集成步骤**

集成原理： - 了解[iOS SDK开发包组成](#android_sdk_zip)
\- [运行SDK Demo工程](#android_demo_run)，对SDK接口初步了解
\- [导入SangforSDK.framework]到自己的工程
\- [集成SDK](#android_single_app_with_sdk)

## Android 接口说明

### initSDK

| 名称     | void initSDK(int sdkMode, int sdkFlags, Map<String, String> extra); |      |                                                              |      |
| -------- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ | ---- |
| 功能     | 初始化SDK                                                    |      |                                                              |      |
| 前置条件 | 无                                                           |      |                                                              |      |
| 后置条件 | 无                                                           |      |                                                              |      |
| 参数     | 参数名                                                       | 类型 | 方向                                                         | 说明 |
| context  | Context                                                      | IN   | 上下文信息                                                   |      |
| sdkMode  | SFSDKMode                                                    | IN   | SDK模式，参考[SFSDKMode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSDKMode) |      |
| sdkFlags | int                                                          | IN   | SDK配置选项，SFSDKFlags枚举组合，参考[SFSDKFlags](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFSDKFlags) |      |
| extra    | Map<String, String>                                          | IN   | 额外配置,补充属性，json格式； 如在flags带有SDKFlagsDisableFileIsolation时需要设置文件隔离白名单， key为kExtraFileIsolationWhiteList，对应的value为白名单路径列表 |      |
| 说明     | 此接口在所有接口调用前调用，不支持重复调用                   |      |                                                              |      |
| 返回值   | 无                                                           |      |                                                              |      |

### setSDKOptions

| 名称     | void setSDKOptions(String key, String value); |      |                                                              |      |
| -------- | --------------------------------------------- | ---- | ------------------------------------------------------------ | ---- |
| 功能     | 设置高级配置选项                              |      |                                                              |      |
| 前置条件 | 在初始化SDK接口后调用                         |      |                                                              |      |
| 后置条件 | 无                                            |      |                                                              |      |
| 参数     | 参数名                                        | 类型 | 方向                                                         | 说明 |
| key      | String                                        | IN   | 参考[高级配置选项](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SDKOptions) |      |
| value    | String                                        | IN   | 参考[高级配置选项](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SDKOptions) |      |
| 说明     | 无                                            |      |                                                              |      |
| 返回值   | 无                                            |      |                                                              |      |

### setAuthResultListener

| 名称     | void setAuthResultListener(SFAuthResultListener listener);   |      |          |      |
| -------- | ------------------------------------------------------------ | ---- | -------- | ---- |
| 功能     | 注册认证回调                                                 |      |          |      |
| 前置条件 | 在认证接口调用前设置认证回调                                 |      |          |      |
| 后置条件 | 无                                                           |      |          |      |
| 参数     | 参数名                                                       | 类型 | 方向     | 说明 |
| listener | [SFAuthResultListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFAuthResultListener) | IN   | 回调对象 |      |
| 说明     | 无                                                           |      |          |      |
| 返回值   | 无                                                           |      |          |      |

### startPasswordAuth

| 名称     | void startPasswordAuth(URL url,String username, String password); |      |                        |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------------- | ---- |
| 功能     | 异步接口，用户名密码主认证                                   |      |                        |      |
| 前置条件 | 调用前须调用[setAuthResultListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#setAuthResultListener)设置认证回调 |      |                        |      |
| 后置条件 | 无                                                           |      |                        |      |
| 参数     | 参数名                                                       | 类型 | 方向                   | 说明 |
| url      | String                                                       | IN   | VPN服务器的url地址信息 |      |
| username | String                                                       | IN   | 用户名信息             |      |
| password | String                                                       | IN   | 密码信息               |      |
| 说明     | 如参数有误则抛出SFException异常                              |      |                        |      |
| 返回值   | 无                                                           |      |                        |      |

### startCertAuth

| 名称     | void startCertAuth(URL url, String certPath, String password); |      |                        |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------------- | ---- |
| 功能     | 异步接口，证书主认证                                         |      |                        |      |
| 前置条件 | 调用前须调用[setAuthResultListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#setAuthResultListener)设置认证回调 |      |                        |      |
| 后置条件 | 无                                                           |      |                        |      |
| 参数     | 参数名                                                       | 类型 | 方向                   | 说明 |
| url      | String                                                       | IN   | VPN服务器的url地址信息 |      |
| certPath | String                                                       | IN   | 证书路径               |      |
| password | String                                                       | IN   | 证书密码信息           |      |
| 说明     | 如参数有误则抛出SFException异常                              |      |                        |      |
| 返回值   | 无                                                           |      |                        |      |

### startPrimaryAuth

| 名称     | void startPrimaryAuth(URL url, String path, String data);    |      |                            |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------------- | ---- |
| 功能     | 异步接口，通用认证接口，扩展支持万能认证                     |      |                            |      |
| 前置条件 | 调用前须调用[setAuthResultListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#setAuthResultListener)设置认证回调 |      |                            |      |
| 后置条件 | 无                                                           |      |                            |      |
| 参数     | 参数名                                                       | 类型 | 方向                       | 说明 |
| url      | String                                                       | IN   | VPN服务器的url地址信息     |      |
| path     | String                                                       | IN   | 认证路径                   |      |
| data     | String                                                       | IN   | 认证信息，直接透传认证信息 |      |
| 说明     | 如参数有误则抛出SFException异常                              |      |                            |      |
| 返回值   | 无                                                           |      |                            |      |

### doSecondaryAuth

| 名称     | void doSecondaryAuth(SFAuthType authType, Map<String, String> authInfo); |      |                            |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------------- | ---- |
| 功能     | 异步接口，辅助认证方式                                       |      |                            |      |
| 前置条件 | 调用[startPrimaryAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#startPrimaryAuth)后方可调用 |      |                            |      |
| 后置条件 | 无                                                           |      |                            |      |
| 参数     | 参数名                                                       | 类型 | 方向                       | 说明 |
| authType | [SFAuthType](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFAuthType) | IN   | 认证类型                   |      |
| authInfo | Map<String, String>                                          | IN   | 认证信息，直接透传认证信息 |      |
| 说明     | 如参数有误则抛出SFException异常                              |      |                            |      |
| 返回值   | 无                                                           |      |                            |      |

### supportTicketAuth

| 名称     | boolean supportTicketAuth();              |      |      |      |
| -------- | ----------------------------------------- | ---- | ---- | ---- |
| 功能     | 判断当前是否支持免密登录                  |      |      |      |
| 前置条件 | 完成一次认证后有效                        |      |      |      |
| 后置条件 | 无                                        |      |      |      |
| 参数     | 参数名                                    | 类型 | 方向 | 说明 |
| 无       |                                           |      |      |      |
| 说明     | 无                                        |      |      |      |
| 返回值   | true：支持免密认证，false：不支持免密认证 |      |      |      |

### startTicketAuth

| 名称     | boolean startTicketAuth();                                   |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，免密主认证                                         |      |      |      |
| 前置条件 | supportTicketAuth返回true的情况下可以调用，且调用前须调用setAuthResultListener设置认证回调 |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | 无                                                           |      |      |      |
| 返回值   | true：调用接口成功，false：调用接口失败                      |      |      |      |

### cancelAuth

| 名称     | void cancelAuth();                                           |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，取消当前正在进行的认证                             |      |      |      |
| 前置条件 | 调用getAuthStatus获取认证状态，当状态为SFAuthStatus.AuthStatusLogining时有效 |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | 无                                                           |      |      |      |
| 返回值   | 无                                                           |      |      |      |

### logout

| 名称     | void logout();                                               |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，注销接口，向服务器发起注销，结果从[registerLogoutListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#registerLogoutListener)注册的回调中返回 |      |      |      |
| 前置条件 | 在登录成功后调用才有效                                       |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | 无                                                           |      |      |      |
| 返回值   | 无                                                           |      |      |      |

### registerLogoutListener

| 名称     | void registerLogoutListener(SFLogoutListener listener);      |      |                            |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------------- | ---- |
| 功能     | 注册注销回调                                                 |      |                            |      |
| 前置条件 | 在登录成功后调用才有效                                       |      |                            |      |
| 后置条件 | 无                                                           |      |                            |      |
| 参数     | 参数名                                                       | 类型 | 方向                       | 说明 |
| listener | [SFLogoutListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFLogoutListener) | IN   | 需要监听注销结果的回调对象 |      |
| 说明     | 无                                                           |      |                            |      |
| 返回值   | 无                                                           |      |                            |      |

### unregisterLogoutListener

| 名称     | void unregisterLogoutListener(SFLogoutListener listener);    |      |                      |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------- | ---- |
| 功能     | 反注册注销回调                                               |      |                      |      |
| 前置条件 | 无                                                           |      |                      |      |
| 后置条件 | 无                                                           |      |                      |      |
| 参数     | 参数名                                                       | 类型 | 方向                 | 说明 |
| listener | [SFLogoutListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFLogoutListener) | IN   | 需要反注册的回调对象 |      |
| 说明     | 无                                                           |      |                      |      |
| 返回值   | 无                                                           |      |                      |      |

### clearLogoutListeners

| 名称     | void clearLogoutListeners(); |      |      |      |
| -------- | ---------------------------- | ---- | ---- | ---- |
| 功能     | 清除所有注销回调             |      |      |      |
| 前置条件 | 无                           |      |      |      |
| 后置条件 | 无                           |      |      |      |
| 参数     | 参数名                       | 类型 | 方向 | 说明 |
| 无       |                              |      |      |      |
| 说明     | 无                           |      |      |      |
| 返回值   | 无                           |      |      |      |

### getAuthStatus

| 名称     | SFAuthStatus getAuthStatus();                                |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 获取认证状态信息                                             |      |      |      |
| 前置条件 | 无                                                           |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | `认证状态包括： public enum SFAuthStatus {   AuthStatusNone          (0),      //未认证   AuthStatusLogining      (1),      //正在VPN认证   AuthStatusPrimaryAuthOK (2),      //主认证成功   AuthStatusAuthOk        (3),      //认证成功   AuthStatusLogouting     (4),      //正在注销   AuthStatusLogouted      (5);      //已经注销 } ` |      |      |      |
| 返回值   | SFAuthStatus                                                 |      |      |      |

### queryTunnelStatus

| 名称     | SFTunnelStatus queryTunnelStatus();                          |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，获取VPN隧道状态                                    |      |      |      |
| 前置条件 | initSDK时，sdkFlags包含SFSDKFlags.FLAGS_VPN_MODE_L3VPN（即L3VPN模式）时本接口有效， 在SFSDKFlags.FLAGS_VPN_MODE_TCP（即TCP模式）下本接口无效 |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | `VPN隧道状态包括： public enum SFTunnelStatus {    INIT(0),            //VPN初始化    ONLINE(1),          //VPN在线    RECONNECTING(2),    //VPN正在连接    OFFLINE(3),         //VPN离线    EXIT(4),            //VPN退出    EXTIONERROR(100);   //VPN插件出错 } ` |      |      |      |
| 返回值   | SFTunnelStatus                                               |      |      |      |

### registerTunnelStatusListener

| 名称     | void registerTunnelStatusListener(SFTunnelStatusListener listener); |      |                                   |      |
| -------- | ------------------------------------------------------------ | ---- | --------------------------------- | ---- |
| 功能     | 注册VPN隧道状态变化回调                                      |      |                                   |      |
| 前置条件 | initSDK时，sdkFlags包含SFSDKFlags.FLAGS_VPN_MODE_L3VPN（即L3VPN模式）时本接口有效， 在SFSDKFlags.FLAGS_VPN_MODE_TCP（即TCP模式）下本接口无效 |      |                                   |      |
| 后置条件 | 无                                                           |      |                                   |      |
| 参数     | 参数名                                                       | 类型 | 方向                              | 说明 |
| listener | [SFTunnelStatusListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFTunnelStatusListener) | IN   | 需要监听VPN隧道状态变化的回调对象 |      |
| 说明     | 无                                                           |      |                                   |      |
| 返回值   | 无                                                           |      |                                   |      |

### unregisterTunnelStatusListener

| 名称     | void unregisterTunnelStatusListener(SFTunnelStatusListener listener); |      |                      |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------- | ---- |
| 功能     | 反注册VPN隧道状态变化回调                                    |      |                      |      |
| 前置条件 | 无                                                           |      |                      |      |
| 后置条件 | 无                                                           |      |                      |      |
| 参数     | 参数名                                                       | 类型 | 方向                 | 说明 |
| listener | [SFTunnelStatusListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFTunnelStatusListener) | IN   | 需要反注册的回调对象 |      |
| 说明     | 无                                                           |      |                      |      |
| 返回值   | 无                                                           |      |                      |      |

### clearTunnelStatusListeners

| 名称     | void clearTunnelStatusListeners(); |      |      |      |
| -------- | ---------------------------------- | ---- | ---- | ---- |
| 功能     | 清除所有VPN隧道状态变化回调        |      |      |      |
| 前置条件 | 无                                 |      |      |      |
| 后置条件 | 无                                 |      |      |      |
| 参数     | 参数名                             | 类型 | 方向 | 说明 |
| 无       |                                    |      |      |      |
| 说明     | 无                                 |      |      |      |
| 返回值   | 无                                 |      |      |      |

### setWhiteAppList

| 名称     | void setWhiteAppList(String[] appArray);  |      |                    |      |
| -------- | ----------------------------------------- | ---- | ------------------ | ---- |
| 功能     | 设置应用白名单列表                        |      |                    |      |
| 前置条件 | 无                                        |      |                    |      |
| 后置条件 | 无                                        |      |                    |      |
| 参数     | 参数名                                    | 类型 | 方向               | 说明 |
| appArray | String[]                                  | IN   | 白名单应用包名列表 |      |
| 说明     | 可选择调用，不设置白名单所有应用可访问VPN |      |                    |      |
| 返回值   | 无                                        |      |                    |      |

### getWhiteAppList

| 名称     | String[] getWhiteAppList();  |      |      |      |
| -------- | ---------------------------- | ---- | ---- | ---- |
| 功能     | 获取应用白名单列表           |      |      |      |
| 前置条件 | 无                           |      |      |      |
| 后置条件 | 无                           |      |      |      |
| 参数     | 参数名                       | 类型 | 方向 | 说明 |
| 无       |                              |      |      |      |
| 说明     | 无                           |      |      |      |
| 返回值   | 应用白名单列表，没有则返回空 |      |      |      |

### updatePolicy

| 名称       | void updatePolicy(String jsonPolicy);                        |      |              |      |
| ---------- | ------------------------------------------------------------ | ---- | ------------ | ---- |
| 功能       | 外部更新全局安全策略                                         |      |              |      |
| 前置条件   | 在initSDK初始化SDK接口后调用， 且调用[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#initSDK)时，sdkMode带安全沙箱功能模式 且sdkFlags带SFSDKFlags.FLAGS_SUPPORT_MANAGE_POLICY才生效，其他情况抛出异常 |      |              |      |
| 后置条件   | 无                                                           |      |              |      |
| 参数       | 参数名                                                       | 类型 | 方向         | 说明 |
| jsonPolicy | String                                                       | IN   | 全局策略json |      |
| 说明       | `json格式如下：  {    "appId": "com.sangfor.awork",    "screenShot": {        "enable": 1,        "mode": 0,        "settings": {}    },    "screenShotAudit": {        "enable": 1,        "mode": 0,        "settings": {}    },    "waterMark": {        "enable": 1,        "mode": 0,        "settings": {            "waterMarkGradient": "30",            "waterMarkIntervalY": "20",            "waterMarkFontSize": "10",            "waterMarkBorderOpacity": "70",            "waterMarkIntervalX": "20",            "waterMarkContentOpacity": "70",            "watermarkStatus": 0,            "waterMarkContentColor": "AAAAAA",            "waterMarkBorderColor": "AAAAAA",            "waterMarkBorderSize": "0",            "waterMarkExpireMsg": "试用证书不可商用"        }    }, "networkIsolation": {        "enable": 0,        "mode": 0,        "settings": {            "whiteList": ["com.sangfor.vpn.awork", "com.sangfor.easyconnect"],            "addr": {}        }    },    "backgroudBlur": {        "enable": 1,        "mode": 0,        "settings": {}    },    "shareIsolation": {        "enable": 1,        "mode": 14,        "settings": {            "androidWhiteList" :["",""]            "iosWhiteList" : {"urlSchemes":[],"bundleIds":[]}            "whiteList": {                "android": [""],                "ios": {                    "urlScheme": [""],                    "bundleId": [""]                }            }        }    }, "clipboardIsolation": {        "enable": 1,        "mode": 14,        "setting": {            "allowCopySize": 0        }    }  } ` |      |              |      |
| 返回值     | 无                                                           |      |              |      |

### enableDebugLog

| 名称     | void enableDebugLog(boolean isOpen); |      |                     |      |
| -------- | ------------------------------------ | ---- | ------------------- | ---- |
| 功能     | 设置debug日志开关                    |      |                     |      |
| 前置条件 | 无                                   |      |                     |      |
| 后置条件 | 无                                   |      |                     |      |
| 参数     | 参数名                               | 类型 | 方向                | 说明 |
| isOpen   | boolean                              | IN   | true开启, false关闭 |      |
| 说明     | 无                                   |      |                     |      |
| 返回值   | 无                                   |      |                     |      |

### packLog

| 名称     | String packLog(String zipPath);           |      |                                                              |      |
| -------- | ----------------------------------------- | ---- | ------------------------------------------------------------ | ---- |
| 功能     | 打包日志文件到本地                        |      |                                                              |      |
| 前置条件 | 无                                        |      |                                                              |      |
| 后置条件 | 无                                        |      |                                                              |      |
| 参数     | 参数名                                    | 类型 | 方向                                                         | 说明 |
| zipPath  | String                                    | IN   | 打包后的文件全路径（支持指定日志路径或者日志文件名的绝对路径） |      |
| 说明     | 无                                        |      |                                                              |      |
| 返回值   | 成功返回打包后的zip文件路径，失败则返回空 |      |                                                              |      |

### resetPassword

| 名称     | void resetPassword(String oldpwd, String newpwd, SFResetPasswordListener listener); |      |                  |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------- | ---- |
| 功能     | 异步接口，主动调用修改VPN账号密码，通过SFResetPasswordListener回调接收结果 |      |                  |      |
| 前置条件 | 无                                                           |      |                  |      |
| 后置条件 | 无                                                           |      |                  |      |
| 参数     | 参数名                                                       | 类型 | 方向             | 说明 |
| oldpwd   | String                                                       | IN   | 当前密码         |      |
| newpwd   | String                                                       | IN   | 新密码           |      |
| listener | [SFResetPasswordListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFResetPasswordListener) | IN   | 结果回调listener |      |
| 说明     | 无                                                           |      |                  |      |
| 返回值   | 无                                                           |      |                  |      |

### regetSmsCode

| 名称     | void regetSmsCode(SFRegetSmsListener listener);              |      |                  |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------- | ---- |
| 功能     | 异步接口，重新获取短信验证码，通过SFRegetSmsListener回调返回结果 |      |                  |      |
| 前置条件 | 无                                                           |      |                  |      |
| 后置条件 | 无                                                           |      |                  |      |
| 参数     | 参数名                                                       | 类型 | 方向             | 说明 |
| listener | [SFRegetSmsListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFRegetSmsListener) | IN   | 结果回调listener |      |
| 说明     | 无                                                           |      |                  |      |
| 返回值   | 无                                                           |      |                  |      |

### regetRandCode

| 名称     | void regetRandCode(SFRegetRandCodeListener listener);        |      |                  |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------- | ---- |
| 功能     | 异步接口，重新获取图形校验码回调接口，通过SFRegetRandCodeListener回调返回结果 |      |                  |      |
| 前置条件 | 无                                                           |      |                  |      |
| 后置条件 | 无                                                           |      |                  |      |
| 参数     | 参数名                                                       | 类型 | 方向             | 说明 |
| listener | [SFRegetRandCodeListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#SFRegetRandCodeListener) | IN   | 结果回调listener |      |
| 说明     | 无                                                           |      |                  |      |
| 返回值   | 无                                                           |      |                  |      |

### getSdkVersion

| 名称     | String getSdkVersion(); |      |      |      |
| -------- | ----------------------- | ---- | ---- | ---- |
| 功能     | 获取当前SDK版本信息     |      |      |      |
| 前置条件 | 无                      |      |      |      |
| 后置条件 | 无                      |      |      |      |
| 参数     | 参数名                  | 类型 | 方向 | 说明 |
| 无       |                         |      |      |      |
| 说明     | 无                      |      |      |      |
| 返回值   | 当前SDK版本信息         |      |      |      |

### SFAuthResultListener

| 名称 | SFAuthResultListener回调接口                                 |
| ---- | ------------------------------------------------------------ |
| 功能 | 认证结果回调接口                                             |
| 说明 | `/** * 认证结果回调接口 */ public interface SFAuthResultListener {    /**     * 认证成功     *     * @param message  认证成功信息     */    void onAuthSuccess(<a href="#SFBaseMessage">SFBaseMessage</a> message);    </br>    /**     * 认证失败     *     * @param authType 当前认证类型     * @param message  认证失败信息     */    void onAuthFailed(SFAuthType authType, <a href="#SFBaseMessage">SFBaseMessage</a> message);    </br>    /**     * 认证成功，但需要下一步认证     *     * @param nextAuthType  下一步认证类型     * @param message       下一步认证信息     */    void onAuthProgress(SFAuthType nextAuthType, <a href="#SFBaseMessage">SFBaseMessage</a> message); } ` |

### SFTunnelStatusListener

| 名称 | SFTunnelStatusListener回调接口                               |
| ---- | ------------------------------------------------------------ |
| 功能 | VPN隧道状态及流量变化回调                                    |
| 说明 | `/** * VPN隧道状态及流量变化回调 */ public interface SFTunnelStatusListener {    /**     * @brief VPN状态变化回调     * @param current   当前的VPN状态     * @param prior     上一次的VPN状态     */    void onTunnelStatusChanged(int current, int prior);     /**     * @brief VPN网络流量变化回调     * @param upFlow 上行流量值 byte/s     * @param downFlow 下行流量值 byte/s     */    void onTunnelPacketFlowRate(long upFlow, long downFlow); } ` 在[registerTunnelStatusListener](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#registerTunnelStatusListener)中进行回调设置 |

### SFResetPasswordListener

| 名称 | SFResetPasswordListener回调接口                              |
| ---- | ------------------------------------------------------------ |
| 功能 | 修改密码回调接口                                             |
| 说明 | `/** * 修改密码回调接口 */ public interface SFResetPasswordListener {    /**     * 修改密码成功     */    public void onPasswordChangedSuccess();    <br/>    /**     * 修改密码失败     * @param message 包含失败相关信息     */    public void onPasswordChangedFailed(<a href="#SFBaseMessage">SFBaseMessage</a> message); } ` |

### SFRegetSmsListener

| 名称 | SFRegetSmsListener回调接口                                   |
| ---- | ------------------------------------------------------------ |
| 功能 | 重新获取短信结果回调接口                                     |
| 说明 | `/** * 重新获取短信回调接口 */ public interface SFRegetSmsListener {    /**     * 重新获取短信回调     * @param success 是否成功获取，true表示成功，false表示失败     * @param message 包含短信相关信息     */    public void onRegetSmsCode(boolean success, <a href="#SFSmsMessage">SFSmsMessage</a> message); } ` |

### SFRegetRandCodeListener

| 名称 | SFRegetRandCodeListener回调接口                              |
| ---- | ------------------------------------------------------------ |
| 功能 | 重新获取图形校验码回调接口                                   |
| 说明 | `/** * 重新获取图形校验码回调接口 */ public interface SFRegetRandCodeListener {    /**     * @brief 重新获取图形校验码回调     *     * @param success true: 成功, false: 失败     * @param bytes 图片二进制数据，success为true是有效     * @param byteLength 图片二进制数据长度，success为true是有效     */    void onRegetRandCode(boolean success, byte[] bytes, int byteLength); } ` |

### SFLogoutListener

| 名称 | SFLogoutListener回调接口                                     |
| ---- | ------------------------------------------------------------ |
| 功能 | 注销结果回调接口                                             |
| 说明 | `/** * 注销结果回调接口 */ public interface SFLogoutListener {    /**     * 注销结果回调     *     * @param type      注销类型     * @param message   注销信息     */    void onLogout(SFLogoutType type, <a href="#SFBaseMessage">SFBaseMessage</a> message); } ` |

### SFBaseMessage

| 名称 | SFBaseMessage类                                              |
| ---- | ------------------------------------------------------------ |
| 功能 | 包含重新获取短信结果                                         |
| 说明 | `public class SFBaseMessage {    /*错误码*/    public int mErrCode;    /*错误提示字符串*/    public String mErrStr;    /*服务端透传数据*/    public String mServerInfo; } ` |

### SFSmsMessage

| 名称 | SFSmsMessage类                                               |
| ---- | ------------------------------------------------------------ |
| 功能 | 包含重新获取短信结果                                         |
| 说明 | `public class SFSmsMessage extends <a href="#SFBaseMessage">SFBaseMessage</a>{    /**     * 获取短信认证的手机号码     * @return 手机号码     */    public String getPhoneNum() {        return phoneNum;    }     /**     * 获取重新发送短信倒计时时间     * @return 短信倒计时时间     */    public int getCountDown() {        return countDown;    }     /**     * 上次发送的短信验证码是否在有效期     * @return 短信验证码是否在有效期     */    public boolean isStillValid() {        return stillValid;    } } ` |

### SFSDKMode

| 名称 | SFSDKMode枚举                                                |
| ---- | ------------------------------------------------------------ |
| 功能 | SDK模式信息                                                  |
| 详情 | `/** * SDK模式枚举 */ public enum SFSDKMode {    MODE_VPN(1 << 0),                       //SDK启用VPN功能    MODE_SANDBOX(1 << 1),                   //SDK启用安全沙箱功能    MODE_VPN_SANDBOX(1 << 0 | 1 << 1);      //SDK同时启用VPN+沙箱功能 } ` |
| 说明 | SFSDKMode在[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#initSDK)初始化SDK时设置 |

### SFSDKFlags

| 名称 | SFSDKFlags枚举                                               |
| ---- | ------------------------------------------------------------ |
| 功能 | SDK配置选项                                                  |
| 详情 | `/** * SDK配置选项 */ public class SFSDKFlags {    public final static int FLAGS_NONE = (1 << 0);                  //初始化值    public final static int FLAGS_VPN_MODE_TCP = (1 << 1);          //设置VPN为TCP模式    public final static int FLAGS_VPN_MODE_L3VPN = (1 << 2);        //设置VPN为L3VPN模式    public final static int FLAGS_HOST_APPLICATION = (1 << 3);      //设置SDK为主应用模式    public final static int FLAGS_SUB_APPLICATION = (1 << 4);       //设置SDK为子应用模式    public final static int FLAGS_ENABLE_FILE_ISOLATION = (1 << 5); //设置SDK启用文件隔离功能    public final static int FLAGS_SUPPORT_MANAGE_POLICY = (1 << 6); //设置SDK支持外部(第三方)更新策略 } ` |
| 说明 | SFSDKFlags在[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#initSDK)初始化SDK时设置 |

### SDK高级配置选项

| 名称                                | SDKOptions                                                   |                                                              |      |
| ----------------------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---- |
| 功能                                | SDK高级配置选项                                              |                                                              |      |
| 详情                                | key                                                          | value                                                        | 说明 |
| SFConstants.EXTRA_KEY_AUTH_TIMEOUT  | 超时时间，比如"30"                                           | 认证连接超时时间，以秒为单位。 若没有设置则使用默认超时时间30秒 |      |
| SFConstants.EXTRA_KEY_AUTH_LANGUAGE | "en_US"或者"zh_CN"                                           | 设置语言 若没有设置则使用默认值zh_CN                         |      |
| 说明                                | 在[setSDKOptions](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#setSDKOptions)中进行设置 |                                                              |      |

### SFAuthType

| 名称 | SFAuthType                                                   |
| ---- | ------------------------------------------------------------ |
| 功能 | 认证类型枚举                                                 |
| 详情 | `/** * 定义认证类型 */ public enum SFAuthType {    AUTH_TYPE_CERTIFICATE     (0),        //证书认证    AUTH_TYPE_PASSWORD        (1),        //用户名密码认证    AUTH_TYPE_SMS             (2),        //短信认证    AUTH_TYPE_HARDID          (4),        //硬件特征码认证    AUTH_TYPE_RADIUS          (6),        //挑战认证或者Radius认证    AUTH_TYPE_TOKEN           (7),        //令牌认证    AUTH_TYPE_RENEW_PASSWORD  (18),       //强制修改密码认证    AUTH_TYPE_RAND            (22),       //图形校验码认证 } ` |
| 说明 | 这些是EMM对外提供的认证类型，EMM管理员会根据客户业务需要选择性的开启。 要想知道集成时需要支持哪些认证类型，需要咨询客户的EMM管理员。 |

## iOS 接口说明

### initSDK

| 名称     | - (BOOL)initSDK:(SFSDKMode)sdkMode flags:(int)sdkFlags extra:(NSDictionaryMap<NSString *, NSString *> * __nullable)extra; |      |                                                              |      |
| -------- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ | ---- |
| 功能     | 初始化SDK                                                    |      |                                                              |      |
| 前置条件 | 无                                                           |      |                                                              |      |
| 后置条件 | 无                                                           |      |                                                              |      |
| 参数     | 参数名                                                       | 类型 | 方向                                                         | 说明 |
| sdkMode  | SFSDKMode                                                    | IN   | SDK模式，参考[SFSDKMode](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKMode) |      |
| sdkFlags | int                                                          | IN   | SDK配置选项，SFSDKFlags枚举组合，参考[SFSDKFlags](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKFlags) |      |
| extra    | NSDictionaryMap<NSString *, NSString *> *                    | IN   | extra参数对于iOS当前不生效                                   |      |
| 说明     | 多应用场景，即一个主应用，多个子应用，所有应用需要开启AppGroup功能且保证groupid一致， 同时设置groupid包括sfshare后缀，例如group.com.***.sfshare |      |                                                              |      |
| 返回值   | YES:初始化成功, NO:初始化失败                                |      |                                                              |      |

### setSDKOption

| 名称     | - (BOOL)setSDKOption:(NSString * __nonnull)key value:(NSString * __nonnull)value; |      |                                                              |      |
| -------- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ | ---- |
| 功能     | 设置高级配置选项                                             |      |                                                              |      |
| 前置条件 | 配置必须在发起认证前设置才能生效                             |      |                                                              |      |
| 后置条件 | 无                                                           |      |                                                              |      |
| 参数     | 参数名                                                       | 类型 | 方向                                                         | 说明 |
| key      | NSString *                                                   | IN   | 参考[高级配置选项](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SDKOptions) |      |
| value    | NSString *                                                   | IN   | 参考[高级配置选项](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SDKOptions) |      |
| 说明     | 无                                                           |      |                                                              |      |
| 返回值   | YES:设置成功, NO:设置失败                                    |      |                                                              |      |

### setAuthResultDelegate

| 名称     | - (void)setAuthResultDelegate:(id<SFAuthResultDelegate>)delegate; |      |                        |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------------- | ---- |
| 功能     | 注册认证回调                                                 |      |                        |      |
| 前置条件 | 在认证接口调用前设置认证回调                                 |      |                        |      |
| 后置条件 | 无                                                           |      |                        |      |
| 参数     | 参数名                                                       | 类型 | 方向                   | 说明 |
| delegate | id<[SFAuthResultDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFAuthResultDelegate)> | IN   | 回调对象,为nil则反注册 |      |
| 说明     | 无                                                           |      |                        |      |
| 返回值   | 无                                                           |      |                        |      |

### startPasswordAuth

| 名称     | - (BOOL)startPasswordAuth:(NSURL * __nonnull)url userName:(NSString * __nonnull)username password:(NSString * __nonnull)password; |      |                        |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------------- | ---- |
| 功能     | 异步接口，用户名密码主认证                                   |      |                        |      |
| 前置条件 | 调用前须调用[setAuthResultDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_setAuthResultDelegate)设置认证回调 |      |                        |      |
| 后置条件 | 无                                                           |      |                        |      |
| 参数     | 参数名                                                       | 类型 | 方向                   | 说明 |
| url      | NSURL                                                        | IN   | VPN服务器的url地址信息 |      |
| username | NSString *                                                   | IN   | 用户名信息             |      |
| password | NSString *                                                   | IN   | 密码信息               |      |
| 说明     | 主应用调用，子应用调用会导致断言                             |      |                        |      |
| 返回值   | YES:接口调用成功, NO:接口调用失败，注意，认证结果在认证回调中返回 |      |                        |      |

### startCertAuth

| 名称     | - (BOOL)startCertAuth:(NSURL * __nonnull)url certPath:(NSString * __nonnull)path password:(NSString * __nonnull)password; |      |                        |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------------- | ---- |
| 功能     | 异步接口，证书主认证                                         |      |                        |      |
| 前置条件 | 调用前须调用[setAuthResultDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_setAuthResultDelegate)设置认证回调 |      |                        |      |
| 后置条件 | 无                                                           |      |                        |      |
| 参数     | 参数名                                                       | 类型 | 方向                   | 说明 |
| url      | NSURL                                                        | IN   | VPN服务器的url地址信息 |      |
| path     | NSString *                                                   | IN   | 证书路径               |      |
| password | NSString *                                                   | IN   | 证书密码               |      |
| 说明     | 主应用调用，子应用调用会导致断言                             |      |                        |      |
| 返回值   | YES:接口调用成功, NO:接口调用失败，注意，认证结果在认证回调中返回 |      |                        |      |

### startPrimaryAuth

| 名称     | - (BOOL)startPrimaryAuth:(NSURL * __nonnull)url path:(NSString * __nonnull)path data:(NSString * __nullable)data; |      |                            |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------------- | ---- |
| 功能     | 异步接口，通用认证接口，扩展支持万能认证                     |      |                            |      |
| 前置条件 | 调用前须调用[setAuthResultDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_setAuthResultDelegate)设置认证回调 |      |                            |      |
| 后置条件 | 无                                                           |      |                            |      |
| 参数     | 参数名                                                       | 类型 | 方向                       | 说明 |
| url      | NSURL                                                        | IN   | VPN服务器的url地址信息     |      |
| path     | NSString *                                                   | IN   | 认证路径                   |      |
| data     | NSString *                                                   | IN   | 认证信息，直接透传认证信息 |      |
| 说明     | 无                                                           |      |                            |      |
| 返回值   | YES:接口调用成功, NO:接口调用失败，注意，认证结果在认证回调中返回 |      |                            |      |

### doSecondaryAuth

| 名称     | - (BOOL)doSecondaryAuth:(SFAuthType)type data:(NSDictionary *__nullable)data; |      |                  |      |
| -------- | ------------------------------------------------------------ | ---- | ---------------- | ---- |
| 功能     | 异步接口，辅助认证方式                                       |      |                  |      |
| 前置条件 | 调用[startPrimaryAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_startPrimaryAuth)后方可调用 |      |                  |      |
| 后置条件 | 无                                                           |      |                  |      |
| 参数     | 参数名                                                       | 类型 | 方向             | 说明 |
| type     | [SFAuthType](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFAuthType) | IN   | 认证类型         |      |
| data     | NSDictionary *                                               | IN   | 辅助认证数据对象 |      |
| 说明     | 图形校验码认证：type用SFAuthTypeRand, data用kAuthKeyRandCode为key短信验证码认证：type用SFAuthTypeSMS, data用kAuthKeySMS为key动态令牌认证：type用SFAuthTypeToken, data用kAuthKeyToken为keyRadius认证：type用SFAuthTypeRadius, data用kAuthKeyRadiusCode为key更新密码认证：type用SFAuthTypeRenewPassword, data用kAuthKeyRenewNewPassword为key， 如果有旧密码带上kAuthKeyRenewOldPassword用户透传数据在data中用kAuthKeyUserContentData为key |      |                  |      |
| 返回值   | YES:接口调用成功, NO:接口调用失败，注意，认证结果在认证回调中返回 |      |                  |      |

### supportTicketAuth

| 名称     | - (BOOL)supportTicketAuth;                    |      |      |      |
| -------- | --------------------------------------------- | ---- | ---- | ---- |
| 功能     | 判断当前是否支持免密登录                      |      |      |      |
| 前置条件 | 无                                            |      |      |      |
| 后置条件 | 无                                            |      |      |      |
| 参数     | 参数名                                        | 类型 | 方向 | 说明 |
| 无       |                                               |      |      |      |
| 说明     | 需要EMM服务器开启免密认证功能才能进行免密认证 |      |      |      |
| 返回值   | YES:支持免密认证, NO:不支持免密认证           |      |      |      |

### startTicketAuth

| 名称     | - (void)startTicketAuth;                                     |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，免密主认证                                         |      |      |      |
| 前置条件 | [supportTicketAuth](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_supportTicketAuth)返回YES的情况下可以调用，且调用前须调用[setAuthResultDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_setAuthResultDelegate)设置认证回调 |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | 认证结果在认证回调中返回                                     |      |      |      |
| 返回值   | 无                                                           |      |      |      |

### cancelAuth

| 名称     | - (void)cancelAuth;                                          |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，取消当前正在进行的认证                             |      |      |      |
| 前置条件 | 调用[getAuthStatus](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_getAuthStatus)获取认证状态，当状态为SFAuthStatusLogining时有效 |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | 无                                                           |      |      |      |
| 返回值   | 无                                                           |      |      |      |

### logout

| 名称     | - (void)logout;                                              |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，注销接口，向服务器发起注销，结果从[registerLogoutDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_registerLogoutDelegate)注册的回调中返回 |      |      |      |
| 前置条件 | 在登录成功后调用才有效                                       |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | 无                                                           |      |      |      |
| 返回值   | 无                                                           |      |      |      |

### registerLogoutDelegate

| 名称     | - (void)registerLogoutDelegate:(id<SFLogoutDelegate>)delegate; |      |                            |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------------- | ---- |
| 功能     | 注册注销回调                                                 |      |                            |      |
| 前置条件 | 在登录成功后调用才有效                                       |      |                            |      |
| 后置条件 | 无                                                           |      |                            |      |
| 参数     | 参数名                                                       | 类型 | 方向                       | 说明 |
| delegate | id<[SFLogoutDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFLogoutDelegate)> | IN   | 需要监听注销结果的回调对象 |      |
| 说明     | 反注册注销回调请查看[unRegisterLogoutDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_unRegisterLogoutDelegate) |      |                            |      |
| 返回值   | 无                                                           |      |                            |      |

### unRegisterLogoutDelegate

| 名称     | - (void)unRegisterLogoutDelegate:(id<SFLogoutDelegate>)delegate; |      |                      |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------- | ---- |
| 功能     | 反注册注销回调                                               |      |                      |      |
| 前置条件 | 无                                                           |      |                      |      |
| 后置条件 | 无                                                           |      |                      |      |
| 参数     | 参数名                                                       | 类型 | 方向                 | 说明 |
| delegate | id<[SFLogoutDelegate>](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFLogoutDelegate) | IN   | 需要反注册的回调对象 |      |
| 说明     | 无                                                           |      |                      |      |
| 返回值   | 无                                                           |      |                      |      |

### clearLogoutDelegate

| 名称     | - (void)clearLogoutDelegate; |      |      |      |
| -------- | ---------------------------- | ---- | ---- | ---- |
| 功能     | 清除所有注销回调             |      |      |      |
| 前置条件 | 无                           |      |      |      |
| 后置条件 | 无                           |      |      |      |
| 参数     | 参数名                       | 类型 | 方向 | 说明 |
| 无       |                              |      |      |      |
| 说明     | 无                           |      |      |      |
| 返回值   | 无                           |      |      |      |

### getAuthStatus

| 名称     | - (SFAuthStatus)getAuthStatus;                               |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 获取认证状态信息                                             |      |      |      |
| 前置条件 | 无                                                           |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| 无       |                                                              |      |      |      |
| 说明     | `认证状态包括： /// 认证状态 typedef NS_ENUM(NSInteger, SFAuthStatus) {   SFAuthStatusNone         = 0,      //未认证   SFAuthStatusLogining     = 1,      //正在认证   SFAuthStatusPrimaryAuthOK= 2,      //主认证成功   SFAuthStatusAuthOk       = 3,      //认证成功   SFAuthStatusLogouting    = 4,      //正在注销   SFAuthStatusLogouted     = 5,      //已经注销 } ; ` |      |      |      |
| 返回值   | SFAuthStatus                                                 |      |      |      |

### queryTunnelStatus

| 名称     | - (void)queryTunnelStatus:(SFTunnelStatusBlock)comp;         |      |      |      |
| -------- | ------------------------------------------------------------ | ---- | ---- | ---- |
| 功能     | 异步接口，获取VPN隧道状态                                    |      |      |      |
| 前置条件 | initSDK时，[SFSDKFlags](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKFlags)包含SFSDKFlagsVpnModeL3VPN（即L3VPN模式）时本接口有效， 包含SFSDKFlagsVpnModeTcp（即TCP模式）下本接口无效 |      |      |      |
| 后置条件 | 无                                                           |      |      |      |
| 参数     | 参数名                                                       | 类型 | 方向 | 说明 |
| comp     | SFTunnelStatusBlock                                          | IN   |      |      |
| 说明     | `/*! @brief 获取VPN隧道状态的block *  @param status VPN隧道状态 */ typedef void (^ SFTunnelStatusBlock)(SFTunnelStatus status);  /// VPN隧道状态 typedef NS_ENUM(NSInteger, SFTunnelStatus) {    SFTunnelStatusInit             = 0,        //VPN隧道初始化    SFTunnelStatusOnline           = 1,        //VPN隧道在线    SFTunnelStatusReconnecting     = 2,        //VPN隧道正在连接    SFTunnelStatusOffline          = 3,        //VPN隧道离线    SFTunnelStatusExit             = 4,        //VPN隧道退出    SFTunnelStatusExtionError      = 100,      //VPN隧道插件出错 } ; ` |      |      |      |
| 返回值   | SFTunnelStatus                                               |      |      |      |

### registerTunnelStatusDelegate

| 名称     | - (void)registerTunnelStatusDelegate:(id<SFTunnelStatusDelegate>)delegate; |      |                                   |      |
| -------- | ------------------------------------------------------------ | ---- | --------------------------------- | ---- |
| 功能     | 注册VPN隧道状态变化回调                                      |      |                                   |      |
| 前置条件 | initSDK时，[SFSDKFlags](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFSDKFlags)包含SFSDKFlagsVpnModeL3VPN（即L3VPN模式）时本接口有效， 包含SFSDKFlagsVpnModeTcp（即TCP模式）下本接口无效 |      |                                   |      |
| 后置条件 | 无                                                           |      |                                   |      |
| 参数     | 参数名                                                       | 类型 | 方向                              | 说明 |
| delegate | id<[SFTunnelStatusDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFTunnelStatusDelegate)> | IN   | 需要监听VPN隧道状态变化的回调对象 |      |
| 说明     | 无                                                           |      |                                   |      |
| 返回值   | 无                                                           |      |                                   |      |

### unregisterTunnelStatusDelegate

| 名称     | - (void)unregisterTunnelStatusDelegate:(id<SFTunnelStatusDelegate>)delegate; |      |                      |      |
| -------- | ------------------------------------------------------------ | ---- | -------------------- | ---- |
| 功能     | 反注册VPN隧道状态变化回调                                    |      |                      |      |
| 前置条件 | 无                                                           |      |                      |      |
| 后置条件 | 无                                                           |      |                      |      |
| 参数     | 参数名                                                       | 类型 | 方向                 | 说明 |
| delegate | id<[SFTunnelStatusDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_SFTunnelStatusDelegate)> | IN   | 需要反注册的回调对象 |      |
| 说明     | 无                                                           |      |                      |      |
| 返回值   | 无                                                           |      |                      |      |

### clearTunnelStatusDelegate

| 名称     | - (void)clearTunnelStatusDelegate; |      |      |      |
| -------- | ---------------------------------- | ---- | ---- | ---- |
| 功能     | 清除所有VPN隧道状态变化回调        |      |      |      |
| 前置条件 | 无                                 |      |      |      |
| 后置条件 | 无                                 |      |      |      |
| 参数     | 参数名                             | 类型 | 方向 | 说明 |
| 无       |                                    |      |      |      |
| 说明     | 无                                 |      |      |      |
| 返回值   | 无                                 |      |      |      |

### setWhiteAppList

| 名称      | - (void)setWhiteAppList:(NSArray <NSString *> * __nonnull)bundleIds; |      |                                              |      |
| --------- | ------------------------------------------------------------ | ---- | -------------------------------------------- | ---- |
| 功能      | 设置应用白名单列表                                           |      |                                              |      |
| 前置条件  | 无                                                           |      |                                              |      |
| 后置条件  | 无                                                           |      |                                              |      |
| 参数      | 参数名                                                       | 类型 | 方向                                         | 说明 |
| bundleIds | NSArray <NSString *> *                                       | IN   | 白名单列表数组，设置为空则表示所有应用可访问 |      |
| 说明      | 无/td>                                                       |      |                                              |      |
| 返回值    | 无                                                           |      |                                              |      |

### getWhiteAppList

| 名称     | - (NSArray <NSString *> * __nullable)getWhiteApplist; |      |      |      |
| -------- | ----------------------------------------------------- | ---- | ---- | ---- |
| 功能     | 获取应用白名单列表                                    |      |      |      |
| 前置条件 | 无                                                    |      |      |      |
| 后置条件 | 无                                                    |      |      |      |
| 参数     | 参数名                                                | 类型 | 方向 | 说明 |
| 无       |                                                       |      |      |      |
| 说明     | 无                                                    |      |      |      |
| 返回值   | 应用白名单列表，没有则返回空                          |      |      |      |

### updatePolicy

| 名称       | - (void)updatePolicy:(NSString * __nonnull)jsonPolicy;       |      |              |      |
| ---------- | ------------------------------------------------------------ | ---- | ------------ | ---- |
| 功能       | 外部更新全局安全策略                                         |      |              |      |
| 前置条件   | 在initSDK初始化SDK接口后调用， 且调用[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_initSDK)时，sdkMode带安全沙箱功能模式 且SDK初始化flags为SDKFlagsSupportManagePolicy模式，外部更新策略才生效 |      |              |      |
| 后置条件   | 无                                                           |      |              |      |
| 参数       | 参数名                                                       | 类型 | 方向         | 说明 |
| jsonPolicy | NSString *                                                   | IN   | 全局策略信息 |      |
| 说明       | `json格式如下：  {    "appId": "com.sangfor.awork",    "screenShot": {        "enable": 1,        "mode": 0,        "settings": {}    },    "screenShotAudit": {        "enable": 1,        "mode": 0,        "settings": {}    },    "waterMark": {        "enable": 1,        "mode": 0,        "settings": {            "waterMarkGradient": "30",            "waterMarkIntervalY": "20",            "waterMarkFontSize": "10",            "waterMarkBorderOpacity": "70",            "waterMarkIntervalX": "20",            "waterMarkContentOpacity": "70",            "watermarkStatus": 0,            "waterMarkContentColor": "AAAAAA",            "waterMarkBorderColor": "AAAAAA",            "waterMarkBorderSize": "0",            "waterMarkExpireMsg": "试用证书不可商用"        }    }, "networkIsolation": {        "enable": 0,        "mode": 0,        "settings": {            "whiteList": ["com.sangfor.vpn.awork", "com.sangfor.easyconnect"],            "addr": {}        }    },    "backgroudBlur": {        "enable": 1,        "mode": 0,        "settings": {}    },    "shareIsolation": {        "enable": 1,        "mode": 14,        "settings": {            "androidWhiteList" :["",""]            "iosWhiteList" : {"urlSchemes":[],"bundleIds":[]}            "whiteList": {                "android": [""],                "ios": {                    "urlScheme": [""],                    "bundleId": [""]                }            }        }    }, "clipboardIsolation": {        "enable": 1,        "mode": 14,        "setting": {            "allowCopySize": 0        }    }  }   ` |      |              |      |
| 返回值     | 无                                                           |      |              |      |

### enableDebugLog

| 名称     | + (void)enableDebugLog:(BOOL)enable; |      |                 |      |
| -------- | ------------------------------------ | ---- | --------------- | ---- |
| 功能     | 设置debug日志开关                    |      |                 |      |
| 前置条件 | 无                                   |      |                 |      |
| 后置条件 | 无                                   |      |                 |      |
| 参数     | 参数名                               | 类型 | 方向            | 说明 |
| enable   | BOOL                                 | IN   | YES开启, NO关闭 |      |
| 说明     | 无                                   |      |                 |      |
| 返回值   | 无                                   |      |                 |      |

### packLog

| 名称     | + (NSString*)packLog:(NSString*)zipPath;                     |      |                                                              |      |
| -------- | ------------------------------------------------------------ | ---- | ------------------------------------------------------------ | ---- |
| 功能     | 打包日志文件到本地                                           |      |                                                              |      |
| 前置条件 | 无                                                           |      |                                                              |      |
| 后置条件 | 无                                                           |      |                                                              |      |
| 参数     | 参数名                                                       | 类型 | 方向                                                         | 说明 |
| zipPath  | NSString *                                                   | IN   | 打包后的文件全路径，传入目录名（非.zip结尾），或者指定文件名(dir + xx.zip)， 目录不存在会帮着创建，原始文件存在会先删除 |      |
| 说明     | ` 需要传入完整路径  1. 输入：/var/mobile/Containers/Data/Application/1D488E35-1706-4C58-A357-4893E051A9C6/Library/Caches/log  2. 输出：/var/mobile/Containers/Data/Application/1D488E35-1706-4C58-A357-4893E051A9C6/Library/Caches/log/xxx.zip  3. 输入：/var/mobile/Containers/Data/Application/1D488E35-1706-4C58-A357-4893E051A9C6/Library/Caches/log.zip  4. 输出：/var/mobile/Containers/Data/Application/1D488E35-1706-4C58-A357-4893E051A9C6/Library/Caches/log.zip ` |      |                                                              |      |
| 返回值   | 打包后的路径，返回空表示打包失败                             |      |                                                              |      |

### resetPassword

| 名称     | - (void)resetPassword:(NSString * __nonnull)oldpwd newPassword:(NSString * __nonnull)newpwd handler:(SFResetPasswordBlock)comp; |      |          |      |
| -------- | ------------------------------------------------------------ | ---- | -------- | ---- |
| 功能     | 异步接口，主动调用修改VPN账号密码, 通过ChangePasswordDelegate回调 |      |          |      |
| 前置条件 | 无                                                           |      |          |      |
| 后置条件 | 无                                                           |      |          |      |
| 参数     | 参数名                                                       | 类型 | 方向     | 说明 |
| oldpwd   | NSString *                                                   | IN   | 当前密码 |      |
| newpwd   | NSString *                                                   | IN   | 新密码   |      |
| comp     | SFResetPasswordBlock                                         | IN   | 结果回调 |      |
| 说明     | `/*! @brief 重置密码的block * 如果为nil则修改成功;否则修改密码错误,读取NSError的domain * @param error 重置密码错误 */ typedef void (^ SFResetPasswordBlock)(NSError *__nullable error); ` |      |          |      |
| 返回值   | 无                                                           |      |          |      |

### regetSmsCode

| 名称     | - (void)regetSmsCode:(SFRegetSmsCodeBlock)comp;              |      |          |      |
| -------- | ------------------------------------------------------------ | ---- | -------- | ---- |
| 功能     | 异步接口，重新获取短信验证码                                 |      |          |      |
| 前置条件 | 无                                                           |      |          |      |
| 后置条件 | 无                                                           |      |          |      |
| 参数     | 参数名                                                       | 类型 | 方向     | 说明 |
| comp     | SFRegetSmsCodeBlock                                          | IN   | 结果回调 |      |
| 说明     | `/*! @brief 重新获取短信校验码的block * 如果为nil则获取短信验证码成功；否则获取短信验证码失败 * @param message 短信验证码信息 * @param error 重新获取短信校验码错误 */ typedef void (^ SFRegetSmsCodeBlock)(SmsMessage *__nullable message, NSError *__nullable error); ` |      |          |      |
| 返回值   | 无                                                           |      |          |      |

### regetRandCode

| 名称     | - (void)regetRandCode:(SFRegetRandCodeBlock)comp;            |      |          |      |
| -------- | ------------------------------------------------------------ | ---- | -------- | ---- |
| 功能     | 异步接口，重新获取图形校验码，阻塞请求，返回图片信息，用于更新图形校验码 |      |          |      |
| 前置条件 | 无                                                           |      |          |      |
| 后置条件 | 无                                                           |      |          |      |
| 参数     | 参数名                                                       | 类型 | 方向     | 说明 |
| comp     | SFRegetRandCodeBlock                                         | IN   | 结果回调 |      |
| 说明     | `/*! @brief 重新获取图形校验码的block * * @param randcode 短信验证码信息 * @param error 重新获取图形校验码错误 */ typedef void (^ SFRegetRandCodeBlock)(NSData *__nullable randcode, NSError *__nullable error); ` |      |          |      |
| 返回值   | 无                                                           |      |          |      |

### SFAuthResultDelegate

| 名称 | SFAuthResultDelegate回调接口                                 |
| ---- | ------------------------------------------------------------ |
| 功能 | 认证结果回调接口                                             |
| 说明 | `/*! @protocol AuthResultDelegate 认证回调接口，用于接收认证结果事件 */ @protocol SFAuthResultDelegate <NSObject> /*! * @brief 认证成功回调 * @param msg 认证成功服务端返回的信息 */ - (void)onAuthSuccess:(BaseMessage *)msg; /*! * @brief 认证过程回调 * nextAuthType为AuthTypeSMS、AuthTypeRadius、AuthTypeRenewPassword * 这三个类型的中的一个时，msg才不为空，具体的类参考上面对信息类的定义 * @param nextAuthType 下个认证类型 * @param msg 认证需要的信息类 */ - (void)onAuthProcess:(SFAuthType)nextAuthType message:(BaseMessage *)msg; /*! * @brief 认证失败回调 * @param msg 错误信息，主要读取类中的errCode和errStr */ - (void)onAuthFailed:(BaseMessage *)msg; @end `在[setAuthResultDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_setAuthResultDelegate)中进行回调设置 |

### SFTunnelStatusDelegate

| 名称 | SFTunnelStatusDelegate回调接口                               |
| ---- | ------------------------------------------------------------ |
| 功能 | VPN隧道状态及流量变化回调                                    |
| 说明 | `/*! @protocol SFTunnelStatusDelegate VPN隧道状态回调接口，用于接收VPN隧道变化事件 */ @protocol SFTunnelStatusDelegate <NSObject> /*! @brief VPN隧道状态变化回调 * @param current 当前的VPN隧道状态 * @param prior 上一次的VPN隧道状态 */ - (void)onTunnelStatusChanged:(SFTunnelStatus)current prior:(SFTunnelStatus)prior; /*! @brief VPN隧道网络流量变化回调 * @param upFlow 上行流量值 * @param downFlow 下行流量值 */ - (void)onTunnelFlowRate:(double)upFlow downFlow:(double)downFlow; @end ` 在[registerTunnelStatusDelegate](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_registerTunnelStatusDelegate)中进行回调设置 |

### SFLogoutDelegate

| 名称 | SFLogoutDelegate回调接口                                     |
| ---- | ------------------------------------------------------------ |
| 功能 | 注销结果回调接口                                             |
| 说明 | `/*! @protocol SFLogoutDelegate VPN注销 */ @protocol SFLogoutDelegate <NSObject> /** * 注销回调 * @param type 注销原因类型 * @param msg 注销信息 */ -(void)f:(SFLogoutType)type message:(BaseMessage *)msg; @end ` |

### SFSDKMode

| 名称 | SFSDKMode枚举                                                |
| ---- | ------------------------------------------------------------ |
| 功能 | SDK模式信息                                                  |
| 详情 | `/// SDK模式 typedef NS_ENUM(NSInteger, SFSDKMode) {    SFSDKModeSupportVpn               = 1<<0,                                           //SDK启用VPN功能    SFSDKModeSupportSandbox           = 1<<1,                                           //SDK启用安全沙箱功能    SFSDKModeSupporVpnSandbox         = SFSDKModeSupportVpn|SFSDKModeSupportSandbox,    //SDK启动VPN和安全沙箱功能 } ; ` |
| 说明 | SFSDKMode在[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_initSDK)初始化SDK时设置 |

### SFSDKFlags

| 名称 | SFSDKFlags枚举                                               |
| ---- | ------------------------------------------------------------ |
| 功能 | SDK配置选项                                                  |
| 详情 | `/// SDK配置选项 typedef NS_ENUM(NSInteger, SFSDKFlags) {    SFSDKFlagsNone                       = 1<<0,         //初始化值    SFSDKFlagsVpnModeTcp                 = 1<<1,         //设置VPN为TCP模式    SFSDKFlagsVpnModeL3VPN               = 1<<2,         //设置VPN为L3VPN模式    SFSDKFlagsHostApplication            = 1<<3,         //设置SDK为主应用模式    SFSDKFlagsSubApplication             = 1<<4,         //设置SDK为子应用模式    SFSDKFlagsEnableFileIsolation        = 1<<5,         //设置SDK启用文件隔离功能    SFSDKFlagsSupportManagePolicy        = 1<<6,         //设置SDK支持外部(第三方)更新策略 } ; ` |
| 说明 | SFSDKFlags在[initSDK](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_initSDK)初始化SDK时设置 |

### SDK高级配置选项

| 名称                 | SDKOptions                                                   |                                                              |      |
| -------------------- | ------------------------------------------------------------ | ------------------------------------------------------------ | ---- |
| 功能                 | SDK高级配置选项                                              |                                                              |      |
| 详情                 | key                                                          | value                                                        | 说明 |
| kOptionsAuthTimeOut  | 超时时间，比如"30"                                           | 认证连接超时时间，以秒为单位。 若没有设置则使用默认超时时间30秒 |      |
| kOptionsAuthLanguage | "en_US"或者"zh_CN"                                           | 设置语言 若没有设置则使用默认值zh_CN                         |      |
| 说明                 | 在[setSDKOption](http://localhost:63343/-kyd7gh27dws5wf78vzq4gsmyp1pjw0oouod7x/UniPlugin-Hello-AS/doc/深信服SDK集成指导文档/深信服SDK集成指导文档.html#ios_setSDKOption)中进行设置 |                                                              |      |

### SFAuthType

| 名称 | SFAuthType                                                   |
| ---- | ------------------------------------------------------------ |
| 功能 | 认证类型枚举                                                 |
| 详情 | ` /// 定义支持的认证类型 typedef NS_ENUM(NSInteger, SFAuthType) { SFAuthTypeCertificate       = 0,         //证书认证 SFAuthTypePassword          = 1,         //用户名密码认证 SFAuthTypeSMS               = 2,         //短信认证 SFAuthTypeHardId            = 4,         //硬件特征码认证, 内部认证 SFAuthTypeRadius            = 6,         //挑战认证或者Radius认证 SFAuthTypeToken             = 7,         //令牌认证 SFAuthTypeRenewPassword     = 18,        //强制修改密码认证 SFAuthTypeRand              = 22,        //图形校验码认证 } ; ` |
| 说明 | 这些是EMM对外提供的认证类型，EMM管理员会根据客户业务需要选择性的开启。 要想知道集成时需要支持哪些认证类型，需要咨询客户的EMM管理员。 |